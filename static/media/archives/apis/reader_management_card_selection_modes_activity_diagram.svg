<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1021px" preserveAspectRatio="none" style="width:601px;height:1021px;background:#FFFFFF;" version="1.1" viewBox="0 0 601 1021" width="601px" zoomAndPan="magnify"><defs/><g><ellipse cx="307.75" cy="20" fill="#000000" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="136.7539" style="stroke:#000000;stroke-width:1.0;" width="223" x="196.25" y="40"/><path d="M343.25,40 L343.25,49.4883 L333.25,59.4883 L196.25,59.4883 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="199.25" y="54.5352">Reader initialization</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="81" x="267.25" y="76.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="61" x="277.25" y="98.0898">get reader</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="203" x="206.25" y="130.6211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="183" x="216.25" y="152.2227">prepare card selection scenario</text><polygon fill="#FEFECE" points="251.25,196.7539,364.25,196.7539,376.25,208.7539,364.25,220.7539,251.25,220.7539,239.25,208.7539,251.25,196.7539" style="stroke:#D4AC0D;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="251.25" y="212.9111">card selection mode?</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="71" x="168.25" y="206.4336">synchronous</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77" x="376.25" y="206.4336">asynchronous</text><polygon fill="#FEFECE" points="116.5,230.7539,220.5,230.7539,232.5,242.7539,220.5,254.7539,116.5,254.7539,104.5,242.7539,116.5,230.7539" style="stroke:#D4AC0D;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="116.5" y="246.9111">test card presence?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="41" x="63.5" y="240.4336">present</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="232.5" y="240.4336">absent</text><rect fill="#98FB98" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="167" x="11" y="264.7539"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="48" x="21" y="286.3555">process</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="73" y="286.3555">explicit selection</text><rect fill="#FFC0CB" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="49" x="218" y="264.7539"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="29" x="228" y="286.3555">error</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="177" x="358.5" y="230.7539"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="157" x="368.5" y="252.3555">schedule selection scenario</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="160" x="367" y="299.8867"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140" x="377" y="321.4883">start reader observation</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="133" x="380.5" y="354.0195"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="113" x="390.5" y="375.6211">start card detection</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="116" x="389" y="408.1523"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="96" x="399" y="429.7539">wait for a card...</text><rect fill="#000000" height="6" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="293" x="297" y="452.2852"/><rect fill="none" height="245.3643" style="stroke:#000000;stroke-width:1.0;" width="267" x="311" y="468.7383"/><path d="M573,468.7383 L573,478.2266 L563,488.2266 L311,488.2266 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="252" x="314" y="483.2734">Reader observation background task</text><polygon fill="#FEFECE" points="386.5,505.2266,507.5,505.2266,519.5,517.2266,507.5,529.2266,386.5,529.2266,374.5,517.2266,386.5,505.2266" style="stroke:#D4AC0D;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="451" y="539.8613">absent</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="121" x="386.5" y="521.3838">card presence polling?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="41" x="333.5" y="514.9063">present</text><rect fill="#98FB98" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="237" x="328.5" y="599.7041"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="48" x="338.5" y="621.3057">process</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="165" x="390.5" y="621.3057">scheduled selection scenario</text><rect fill="#FEFECE" height="48.2656" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="196" x="349" y="653.8369"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="176" x="359" y="675.4385">notifies reader observer about</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="141" x="359" y="689.5713">card inserted &amp; selected</text><rect fill="#000000" height="6" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1.0;" width="293" x="297" y="724.1025"/><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="181" x="356.5" y="750.1025"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="161" x="366.5" y="771.7041">receive selection notification</text><rect fill="#98FB98" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="144" x="375" y="804.2354"/><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="34" x="385" y="825.8369">parse</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="86" x="423" y="825.8369">selection result</text><polygon fill="#FEFECE" points="307.75,844.3682,319.75,856.3682,307.75,868.3682,295.75,856.3682,307.75,844.3682" style="stroke:#D4AC0D;stroke-width:1.5;"/><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="120" x="247.75" y="888.3682"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="100" x="257.75" y="909.9697">get selected card</text><rect fill="#FEFECE" height="34.1328" rx="12.5" ry="12.5" style="stroke:#D4AC0D;stroke-width:1.5;" width="218" x="198.75" y="976.7314"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="198" x="208.75" y="998.333">send APDU commands to the card</text><line style="stroke:#A80036;stroke-width:1.5;" x1="307.75" x2="307.75" y1="110.6211" y2="130.6211"/><polygon fill="#A80036" points="303.75,120.6211,307.75,130.6211,311.75,120.6211,307.75,124.6211" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="307.75" x2="307.75" y1="30" y2="76.4883"/><polygon fill="#A80036" points="303.75,66.4883,307.75,76.4883,311.75,66.4883,307.75,70.4883" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="104.5" x2="94.5" y1="242.7539" y2="242.7539"/><line style="stroke:#A80036;stroke-width:1.5;" x1="94.5" x2="94.5" y1="242.7539" y2="264.7539"/><polygon fill="#A80036" points="90.5,254.7539,94.5,264.7539,98.5,254.7539,94.5,258.7539" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="232.5" x2="242.5" y1="242.7539" y2="242.7539"/><line style="stroke:#A80036;stroke-width:1.5;" x1="242.5" x2="242.5" y1="242.7539" y2="264.7539"/><polygon fill="#A80036" points="238.5,254.7539,242.5,264.7539,246.5,254.7539,242.5,258.7539" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="94.5" x2="94.5" y1="298.8867" y2="856.3682"/><line style="stroke:#A80036;stroke-width:1.5;" x1="94.5" x2="295.75" y1="856.3682" y2="856.3682"/><polygon fill="#A80036" points="285.75,852.3682,295.75,856.3682,285.75,860.3682,289.75,856.3682" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="264.8867" y2="299.8867"/><polygon fill="#A80036" points="443,289.8867,447,299.8867,451,289.8867,447,293.8867" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="334.0195" y2="354.0195"/><polygon fill="#A80036" points="443,344.0195,447,354.0195,451,344.0195,447,348.0195" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="388.1523" y2="408.1523"/><polygon fill="#A80036" points="443,398.1523,447,408.1523,451,398.1523,447,402.1523" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="529.2266" y2="567.7041"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="531.5" y1="567.7041" y2="567.7041"/><polygon fill="#A80036" points="527.5,557.7041,531.5,547.7041,535.5,557.7041,531.5,553.7041" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="531.5" x2="531.5" y1="517.2266" y2="567.7041"/><line style="stroke:#A80036;stroke-width:1.5;" x1="531.5" x2="519.5" y1="517.2266" y2="517.2266"/><polygon fill="#A80036" points="529.5,513.2266,519.5,517.2266,529.5,521.2266,525.5,517.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="374.5" x2="362.5" y1="517.2266" y2="517.2266"/><polygon fill="#A80036" points="358.5,543.7041,362.5,553.7041,366.5,543.7041,362.5,547.7041" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="362.5" x2="362.5" y1="517.2266" y2="579.7041"/><line style="stroke:#A80036;stroke-width:1.5;" x1="362.5" x2="447" y1="579.7041" y2="579.7041"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="579.7041" y2="599.7041"/><polygon fill="#A80036" points="443,589.7041,447,599.7041,451,589.7041,447,593.7041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="633.8369" y2="653.8369"/><polygon fill="#A80036" points="443,643.8369,447,653.8369,451,643.8369,447,647.8369" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#D4AC0D;stroke-width:1.5;" x1="447" x2="447" y1="458.2852" y2="505.2266"/><polygon fill="#D4AC0D" points="443,495.2266,447,505.2266,451,495.2266,447,499.2266" style="stroke:#D4AC0D;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="730.1025" y2="750.1025"/><polygon fill="#A80036" points="443,740.1025,447,750.1025,451,740.1025,447,744.1025" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="784.2354" y2="804.2354"/><polygon fill="#A80036" points="443,794.2354,447,804.2354,451,794.2354,447,798.2354" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="239.25" x2="168.5" y1="208.7539" y2="208.7539"/><line style="stroke:#A80036;stroke-width:1.5;" x1="168.5" x2="168.5" y1="208.7539" y2="230.7539"/><polygon fill="#A80036" points="164.5,220.7539,168.5,230.7539,172.5,220.7539,168.5,224.7539" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="376.25" x2="447" y1="208.7539" y2="208.7539"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="208.7539" y2="230.7539"/><polygon fill="#A80036" points="443,220.7539,447,230.7539,451,220.7539,447,224.7539" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="447" y1="838.3682" y2="856.3682"/><line style="stroke:#A80036;stroke-width:1.5;" x1="447" x2="319.75" y1="856.3682" y2="856.3682"/><polygon fill="#A80036" points="329.75,852.3682,319.75,856.3682,329.75,860.3682,325.75,856.3682" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="307.75" x2="307.75" y1="164.7539" y2="196.7539"/><polygon fill="#A80036" points="303.75,186.7539,307.75,196.7539,311.75,186.7539,307.75,190.7539" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="307.75" x2="307.75" y1="868.3682" y2="888.3682"/><polygon fill="#A80036" points="303.75,878.3682,307.75,888.3682,311.75,878.3682,307.75,882.3682" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.5;stroke-dasharray:7.0,7.0;" x1="307.75" x2="307.75" y1="922.501" y2="976.7314"/><polygon fill="#008000" points="303.75,966.7314,307.75,976.7314,311.75,966.7314,307.75,970.7314" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="165" x="311.75" y="943.9561">Then specific operations could</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="317.75" y="956.9111">be processed with the card...</text><!--MD5=[ef7e8805ab24fc990d43931cb7cdcf4f]
@startuml
skin rose

'skinparam ClassBorderColor #F1C40F
skinparam ClassBorderColor #D4AC0D
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
skinparam shadowing false

skinparam StateBorderColor #D4AC0D
skinparam ActivityBorderColor #D4AC0D

' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #EAFAF1
skinparam ClassBorderColor<<green>> #2ECC71
hide <<green>> stereotype

' Orange
skinparam ClassBackgroundColor<<orange>> #FDF2E9
skinparam ClassBorderColor<<orange>> #E67E22
hide <<orange>> stereotype

' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

start
partition "Reader initialization" {
''	:register plugin;
	:get reader;
	:prepare card selection scenario;
}

if (card selection mode?) then (**synchronous**)


    if (test card presence?) then (present)
'    !pragma useVerticalIf on
        #palegreen:**process** explicit selection;
    else (absent)
        #pink:error;
        kill
    endif


else (**asynchronous**)
    :schedule selection scenario;
    :start reader observation;
    :start card detection;
    :wait for a card...;
	detach
	fork
		partition "Reader observation background task" {
'		    :card presence polling:\n\tis card absent?;
		    while(card presence polling?) is (absent)
            endwhile (present)

            #palegreen:**process** scheduled selection scenario;
            :notifies reader observer about\ncard inserted & selected;
		}
	end fork
	detach
	:receive selection notification;
	#palegreen:**parse** selection result;
endif
	:get selected card;
-[#green,dashed]-> Then specific operations could
  be processed with the card...;
	:send APDU commands to the card;
@enduml

@startuml
skin rose

skinparam ClassBorderColor #D4AC0D
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
skinparam shadowing false

skinparam StateBorderColor #D4AC0D
skinparam ActivityBorderColor #D4AC0D

skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #EAFAF1
skinparam ClassBorderColor<<green>> #2ECC71
hide <<green>> stereotype

skinparam ClassBackgroundColor<<orange>> #FDF2E9
skinparam ClassBorderColor<<orange>> #E67E22
hide <<orange>> stereotype

skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

start
partition "Reader initialization" {
	:get reader;
	:prepare card selection scenario;
}

if (card selection mode?) then (**synchronous**)


    if (test card presence?) then (present)
        #palegreen:**process** explicit selection;
    else (absent)
        #pink:error;
        kill
    endif


else (**asynchronous**)
    :schedule selection scenario;
    :start reader observation;
    :start card detection;
    :wait for a card...;
	detach
	fork
		partition "Reader observation background task" {
		    while(card presence polling?) is (absent)
            endwhile (present)

            #palegreen:**process** scheduled selection scenario;
            :notifies reader observer about\ncard inserted & selected;
		}
	end fork
	detach
	:receive selection notification;
	#palegreen:**parse** selection result;
endif
	:get selected card;
-[#green,dashed]-> Then specific operations could
  be processed with the card...;
	:send APDU commands to the card;
@enduml

PlantUML version 1.2022.4(Sat Apr 09 17:29:17 RET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>