<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3237px" preserveAspectRatio="none" style="width:1342px;height:3237px;background:#FFFFFF;" version="1.1" viewBox="0 0 1342 3237" width="1342px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="3051.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="319.5313"/><rect fill="#FFC0CB" height="864.6035" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="364.8223"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1295.2988"/><rect fill="#FFC0CB" height="598.5293" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1340.5898"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2022.2832"/><rect fill="#FFC0CB" height="1031.4766" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2104.8652"/><rect fill="#ADD8E6" height="286.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="790.1875"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="2498.6484"/><rect fill="#ADD8E6" height="2699.3555" style="stroke:#181818;stroke-width:1.0;" width="10" x="877" y="93.6211"/><rect fill="#90EE90" height="293.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="430.6953"/><rect fill="#90EE90" height="466.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="1406.4629"/><rect fill="#90EE90" height="217.7461" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2215.0293"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2890.1406"/><rect fill="#90EE90" height="3051.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="1264.5" y="93.6211"/><rect fill="none" height="241.6191" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="805.1875"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="397.5" x="911.5" y="2230.0293"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="2513.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="3154.3418"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="386" x2="386" y1="83.6211" y2="3154.3418"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624" x2="624" y1="83.6211" y2="3154.3418"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="881.5" x2="881.5" y1="83.6211" y2="3154.3418"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="970.5" x2="970.5" y1="83.6211" y2="3154.3418"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1269" x2="1269" y1="83.6211" y2="3154.3418"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="3168.4492">Ticketing Application</text><ellipse cx="73" cy="3180.4629" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,3188.4629 L73,3215.4629 M60,3196.4629 L86,3196.4629 M73,3215.4629 L60,3230.4629 M73,3215.4629 L86,3230.4629 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="3153.3418"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="3175.4492">Calypso API</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="574" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="581" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="600.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="574" y="3153.3418"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="581" y="3175.4492">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="600.5" y="3194.0703">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="852.5" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="862.5" y="80.1074">Card</text><path d="M861.5,18.3789 L861.5,42.3789 M861.5,30.3789 L878.5,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="890.5" cy="30.3789" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="852.5" y="3168.4492">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="862.5" y="3187.0703">Card</text><path d="M861.5,3194.584 L861.5,3218.584 M861.5,3206.584 L878.5,3206.584 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="890.5" cy="3206.584" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="921.5" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="928.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="947" y="72.1074">Reader</text><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="921.5" y="3153.3418"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="928.5" y="3175.4492">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="947" y="3194.0703">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1240" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1251" y="80.1074">SAM</text><path d="M1249,18.3789 L1249,42.3789 M1249,30.3789 L1266,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1278" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1240" y="3168.4492">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1251" y="3187.0703">SAM</text><path d="M1249,3194.584 L1249,3218.584 M1249,3206.584 L1266,3206.584 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1278" cy="3206.584" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="3051.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="319.5313"/><rect fill="#FFC0CB" height="864.6035" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="364.8223"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1295.2988"/><rect fill="#FFC0CB" height="598.5293" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1340.5898"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2022.2832"/><rect fill="#FFC0CB" height="1031.4766" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2104.8652"/><rect fill="#ADD8E6" height="286.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="790.1875"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="2498.6484"/><rect fill="#ADD8E6" height="2699.3555" style="stroke:#181818;stroke-width:1.0;" width="10" x="877" y="93.6211"/><rect fill="#90EE90" height="293.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="430.6953"/><rect fill="#90EE90" height="466.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="1406.4629"/><rect fill="#90EE90" height="217.7461" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2215.0293"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2890.1406"/><rect fill="#90EE90" height="3051.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="1264.5" y="93.6211"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="151.4941" y2="151.4941"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="151.4941" y2="164.4941"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="164.4941" y2="164.4941"/><polygon fill="#181818" points="89,160.4941,79,164.4941,89,168.4941,85,164.4941" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="111.6494">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="111.6494">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="128.9404">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="146.2314">- Calypso SAM resource</text><path d="M180,177.4941 L180,204.4941 L591,204.4941 L591,187.4941 L581,177.4941 L180,177.4941 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M581,177.4941 L581,187.4941 L591,187.4941 L581,177.4941 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="390" x="186" y="196.5225">Checks a signature of previously read data when selecting the card.</text><polygon fill="#181818" points="369,315.5313,379,319.5313,369,323.5313,373,319.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="319.5313" y2="319.5313"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="227.8135">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="227.8135">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="117" y="245.1045">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="262.3955">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="117" y="279.6865">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="125" y="279.6865">verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="164" y="279.6865">environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59" x="266" y="279.6865">signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="296.9775">- read contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="117" y="314.2686">- reader counter #1</text><polygon fill="#181818" points="89,329.5313,79,333.5313,89,337.5313,85,333.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="333.5313" y2="333.5313"/><polygon fill="#181818" points="369,360.8223,379,364.8223,369,368.8223,373,364.8223" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="364.8223" y2="364.8223"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="359.5596">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="359.5596">commands (keep channel open)</text><polygon fill="#00FF00" points="953.5,426.6953,963.5,430.6953,953.5,434.6953,957.5,430.6953" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="430.6953" y2="430.6953"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="390.8506">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="408.1416">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="425.4326">- APDU list</text><path d="M704,443.6953 L704,470.6953 L1237,470.6953 L1237,453.6953 L1227,443.6953 L704,443.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1227,443.6953 L1227,453.6953 L1237,453.6953 L1227,443.6953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="512" x="710" y="462.7236">A specific signature key diversification could be required before the signature processing.</text><polygon fill="#181818" points="1252.5,495.2773,1262.5,499.2773,1252.5,503.2773,1256.5,499.2773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="499.2773" y2="499.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="982.5" y="494.0146">verify signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="1084.5" y="494.0146">(environment data signature)</text><polygon fill="#181818" points="986.5,526.5684,976.5,530.5684,986.5,534.5684,982.5,530.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="530.5684" y2="530.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="992.5" y="525.3057">signature status</text><path d="M606,543.5684 L606,570.5684 L1335,570.5684 L1335,553.5684 L1325,543.5684 L606,543.5684 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1325,543.5684 L1325,553.5684 L1335,553.5684 L1325,543.5684 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="708" x="612" y="562.5967">A session key diversification is operated, if the diversifier is different than for the previous data secure processing operation.</text><polygon fill="#181818" points="1252.5,595.1504,1262.5,599.1504,1252.5,603.1504,1256.5,599.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="599.1504" y2="599.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="982.5" y="593.8877">select diversifier (card serial)</text><polygon fill="#181818" points="986.5,609.1504,976.5,613.1504,986.5,617.1504,982.5,613.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="613.1504" y2="613.1504"/><polygon fill="#181818" points="1252.5,640.4414,1262.5,644.4414,1252.5,648.4414,1256.5,644.4414" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="644.4414" y2="644.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="982.5" y="639.1787">get challenge</text><polygon fill="#181818" points="986.5,671.7324,976.5,675.7324,986.5,679.7324,982.5,675.7324" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="675.7324" y2="675.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="992.5" y="670.4697">[SAM challenge]</text><polygon fill="#00FF00" points="402,720.3145,392,724.3145,402,728.3145,398,724.3145" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="724.3145" y2="724.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="408" y="701.7607">[environment data signature,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="719.0518">SAM challenge]</text><polygon fill="#0000FF" points="607,786.1875,617,790.1875,607,794.1875,611,790.1875" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="790.1875" y2="790.1875"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="750.3428">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="767.6338">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="784.9248">- APDU list</text><path d="M564,805.1875 L844,805.1875 L844,814.4785 L834,824.4785 L564,824.4785 L564,805.1875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="241.6191" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="805.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="820.2158">Card APDU commands inside session</text><polygon fill="#181818" points="865,878.3516,875,882.3516,865,886.3516,869,882.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="882.3516" y2="882.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="636" y="842.5068">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="668" y="859.7979">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="668" y="877.0889">SFI environment to read)</text><polygon fill="#181818" points="640,909.6426,630,913.6426,640,917.6426,636,913.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="913.6426" y2="913.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="646" y="908.3799">[card challenge &amp; environment data]</text><polygon fill="#181818" points="865,940.9336,875,944.9336,865,948.9336,869,944.9336" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="944.9336" y2="944.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="636" y="939.6709">read record (contract #1)</text><polygon fill="#181818" points="640,972.2246,630,976.2246,640,980.2246,636,976.2246" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="976.2246" y2="976.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="646" y="970.9619">[contract #1 data]</text><polygon fill="#181818" points="865,1003.5156,875,1007.5156,865,1011.5156,869,1007.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="1007.5156" y2="1007.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="636" y="1002.2529">read record (counter #1)</text><polygon fill="#181818" points="640,1034.8066,630,1038.8066,640,1042.8066,636,1038.8066" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="1038.8066" y2="1038.8066"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="646" y="1033.5439">[counter #1 data]</text><polygon fill="#0000FF" points="402,1073.0977,392,1077.0977,402,1081.0977,398,1077.0977" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="1077.0977" y2="1077.0977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="1071.835">[card challenge]</text><polygon fill="#181818" points="89,1225.4258,79,1229.4258,89,1233.4258,85,1229.4258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1229.4258" y2="1229.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1103.126">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="1120.417">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="127" y="1137.708">- environment data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="1154.999">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="1172.29">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="1189.5811">- counter #1 data]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="95" y="1206.8721">[Data secure processing:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="127" y="1224.1631">- environment data signature status]</text><polygon fill="#181818" points="369,1291.2988,379,1295.2988,369,1299.2988,373,1295.2988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1295.2988" y2="1295.2988"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1255.4541">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="139" y="1255.4541">secured card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="117" y="1272.7451">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="125" y="1272.7451">verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="164" y="1272.7451">contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59" x="262" y="1272.7451">signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="117" y="1290.0361">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="55" x="125" y="1290.0361">compute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="184" y="1290.0361">event data</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59" x="247" y="1290.0361">signature</text><polygon fill="#181818" points="89,1305.2988,79,1309.2988,89,1313.2988,85,1309.2988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1309.2988" y2="1309.2988"/><polygon fill="#181818" points="369,1336.5898,379,1340.5898,369,1344.5898,373,1340.5898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1340.5898" y2="1340.5898"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1335.3271">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1335.3271">commands (keep channel open)</text><polygon fill="#00FF00" points="953.5,1402.4629,963.5,1406.4629,953.5,1410.4629,957.5,1406.4629" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="1406.4629" y2="1406.4629"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="1366.6182">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1383.9092">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1401.2002">- APDU list</text><path d="M723,1419.4629 L723,1446.4629 L1217,1446.4629 L1217,1429.4629 L1207,1419.4629 L723,1419.4629 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1207,1419.4629 L1207,1429.4629 L1217,1429.4629 L1207,1419.4629 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="473" x="729" y="1438.4912">When data secure processing requested, processes all pending SAM commands.</text><polygon fill="#181818" points="1252.5,1471.0449,1262.5,1475.0449,1252.5,1479.0449,1256.5,1475.0449" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="1475.0449" y2="1475.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="982.5" y="1469.7822">digest init (opening data)</text><polygon fill="#181818" points="986.5,1485.0449,976.5,1489.0449,986.5,1493.0449,982.5,1489.0449" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="1489.0449" y2="1489.0449"/><polygon fill="#181818" points="1252.5,1516.3359,1262.5,1520.3359,1252.5,1524.3359,1256.5,1520.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="1520.3359" y2="1520.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="982.5" y="1515.0732">digest update (read environment)</text><polygon fill="#181818" points="986.5,1530.3359,976.5,1534.3359,986.5,1538.3359,982.5,1534.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="1534.3359" y2="1534.3359"/><polygon fill="#181818" points="1252.5,1561.627,1262.5,1565.627,1252.5,1569.627,1256.5,1565.627" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="1565.627" y2="1565.627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="982.5" y="1560.3643">digest update (read contract)</text><polygon fill="#181818" points="986.5,1575.627,976.5,1579.627,986.5,1583.627,982.5,1579.627" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="1579.627" y2="1579.627"/><polygon fill="#181818" points="1252.5,1606.918,1262.5,1610.918,1252.5,1614.918,1256.5,1610.918" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="1610.918" y2="1610.918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="982.5" y="1605.6553">digest update (read counter)</text><polygon fill="#181818" points="986.5,1620.918,976.5,1624.918,986.5,1628.918,982.5,1624.918" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="1624.918" y2="1624.918"/><path d="M638,1637.918 L638,1664.918 L1302,1664.918 L1302,1647.918 L1292,1637.918 L638,1637.918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1292,1637.918 L1292,1647.918 L1302,1647.918 L1292,1637.918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="643" x="644" y="1656.9463">If necessary, a specific contract signature key diversification could be operated before the signature processing.</text><polygon fill="#181818" points="1252.5,1689.5,1262.5,1693.5,1252.5,1697.5,1256.5,1693.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="1693.5" y2="1693.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="982.5" y="1688.2373">verify signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="1084.5" y="1688.2373">(contract #1 data signature)</text><polygon fill="#181818" points="986.5,1720.791,976.5,1724.791,986.5,1728.791,982.5,1724.791" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="1724.791" y2="1724.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="992.5" y="1719.5283">signature status</text><path d="M647,1737.791 L647,1764.791 L1294,1764.791 L1294,1747.791 L1284,1737.791 L647,1737.791 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1284,1737.791 L1284,1747.791 L1294,1747.791 L1284,1737.791 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="626" x="653" y="1756.8193">If necessary, a specific event signature key diversification could be operated before the signature processing.</text><polygon fill="#181818" points="1252.5,1789.373,1262.5,1793.373,1252.5,1797.373,1256.5,1793.373" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="1793.373" y2="1793.373"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="118" x="982.5" y="1788.1104">compute signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="1104.5" y="1788.1104">(event data)</text><polygon fill="#181818" points="986.5,1820.6641,976.5,1824.6641,986.5,1828.6641,982.5,1824.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="1824.6641" y2="1824.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="992.5" y="1819.4014">event data signature</text><polygon fill="#00FF00" points="402,1869.2461,392,1873.2461,402,1877.2461,398,1873.2461" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="1873.2461" y2="1873.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="408" y="1850.6924">[contract #1 data signature status,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="408" y="1867.9834">event data signature]</text><polygon fill="#181818" points="89,1935.1191,79,1939.1191,89,1943.1191,85,1939.1191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1939.1191" y2="1939.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="95" y="1899.2744">[Data secure processing:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="127" y="1916.5654">- contract #1 data signature status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="127" y="1933.8564">- event data signature]</text><polygon fill="#181818" points="369,2018.2832,379,2022.2832,369,2026.2832,373,2022.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2022.2832" y2="2022.2832"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1965.1475">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="1965.1475">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="117" y="1982.4385">- decrease counter #1 (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="117" y="1999.7295">- append event record (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="117" y="2017.0205">- close secure session (not ratified)</text><polygon fill="#181818" points="89,2032.2832,79,2036.2832,89,2040.2832,85,2036.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2036.2832" y2="2036.2832"/><path d="M155,2049.2832 L155,2076.2832 L616,2076.2832 L616,2059.2832 L606,2049.2832 L155,2049.2832 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M606,2049.2832 L606,2059.2832 L616,2059.2832 L606,2049.2832 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440" x="161" y="2068.3115">At the session closure, any data secure processing should be unnecessary.</text><polygon fill="#181818" points="369,2100.8652,379,2104.8652,369,2108.8652,373,2104.8652" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2104.8652" y2="2104.8652"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2099.6025">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2099.6025">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="2136.1563" y2="2136.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="2136.1563" y2="2149.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="2149.1563" y2="2149.1563"/><polygon fill="#181818" points="402,2145.1563,392,2149.1563,402,2153.1563,398,2149.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="398" y="2130.8936">anticipates the future card responses</text><polygon fill="#00FF00" points="953.5,2211.0293,963.5,2215.0293,953.5,2219.0293,957.5,2215.0293" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="2215.0293" y2="2215.0293"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2175.1846">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2192.4756">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2209.7666">- APDU list</text><path d="M911.5,2230.0293 L1168.5,2230.0293 L1168.5,2239.3203 L1158.5,2249.3203 L911.5,2249.3203 L911.5,2230.0293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="397.5" x="911.5" y="2230.0293"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="926.5" y="2245.0576">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1001.5" y="2245.0576">Card APDU responses</text><polygon fill="#181818" points="1252.5,2268.6113,1262.5,2272.6113,1252.5,2276.6113,1256.5,2272.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="2272.6113" y2="2272.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="982.5" y="2267.3486">digest update (decrease counter)</text><polygon fill="#181818" points="986.5,2282.6113,976.5,2286.6113,986.5,2290.6113,982.5,2286.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="2286.6113" y2="2286.6113"/><polygon fill="#181818" points="1252.5,2313.9023,1262.5,2317.9023,1252.5,2321.9023,1256.5,2317.9023" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="2317.9023" y2="2317.9023"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="982.5" y="2312.6396">digest update (append event record)</text><polygon fill="#181818" points="986.5,2327.9023,976.5,2331.9023,986.5,2335.9023,982.5,2331.9023" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="2331.9023" y2="2331.9023"/><polygon fill="#181818" points="1252.5,2366.1934,1262.5,2370.1934,1252.5,2374.1934,1256.5,2370.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="2370.1934" y2="2370.1934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="982.5" y="2364.9307">digest close</text><polygon fill="#181818" points="986.5,2397.4844,976.5,2401.4844,986.5,2405.4844,982.5,2401.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="2401.4844" y2="2401.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="992.5" y="2396.2217">[SAM certificate]</text><polygon fill="#00FF00" points="402,2428.7754,392,2432.7754,402,2436.7754,398,2432.7754" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="2432.7754" y2="2432.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="408" y="2427.5127">[SAM certificate]</text><polygon fill="#0000FF" points="607,2494.6484,617,2498.6484,607,2502.6484,611,2498.6484" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="2498.6484" y2="2498.6484"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2458.8037">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2476.0947">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2493.3857">- APDU list</text><path d="M564,2513.6484 L844,2513.6484 L844,2522.9395 L834,2532.9395 L564,2532.9395 L564,2513.6484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="2513.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="2528.6768">Card APDU commands inside session</text><polygon fill="#181818" points="865,2552.2305,875,2556.2305,865,2560.2305,869,2556.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2556.2305" y2="2556.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="636" y="2550.9678">update record (event, data)</text><polygon fill="#181818" points="640,2566.2305,630,2570.2305,640,2574.2305,636,2570.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2570.2305" y2="2570.2305"/><polygon fill="#181818" points="865,2597.5215,875,2601.5215,865,2605.5215,869,2601.5215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2601.5215" y2="2601.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="636" y="2596.2588">decrease counter (counter #1, value)</text><polygon fill="#181818" points="640,2628.8125,630,2632.8125,640,2636.8125,636,2632.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2632.8125" y2="2632.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="646" y="2627.5498">[new counter value]</text><polygon fill="#181818" points="865,2667.1035,875,2671.1035,865,2675.1035,869,2671.1035" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2671.1035" y2="2671.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="636" y="2665.8408">close secure session (SAM certificate)</text><polygon fill="#181818" points="640,2698.3945,630,2702.3945,640,2706.3945,636,2702.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2702.3945" y2="2702.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="646" y="2697.1318">[card certificate]</text><polygon fill="#181818" points="865,2729.6855,875,2733.6855,865,2737.6855,869,2733.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2733.6855" y2="2733.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="636" y="2728.4229">ratification command</text><polygon fill="#181818" points="640,2743.6855,630,2747.6855,640,2751.6855,636,2747.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2747.6855" y2="2747.6855"/><polygon fill="#181818" points="865,2774.9766,875,2778.9766,865,2782.9766,869,2778.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2778.9766" y2="2778.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="636" y="2773.7139">close card channel</text><polygon fill="#181818" points="640,2788.9766,630,2792.9766,640,2796.9766,636,2792.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="881" y1="2792.9766" y2="2792.9766"/><polygon fill="#0000FF" points="402,2820.2676,392,2824.2676,402,2828.2676,398,2824.2676" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="2824.2676" y2="2824.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="408" y="2819.0049">[card certificate]</text><polygon fill="#00FF00" points="953.5,2886.1406,963.5,2890.1406,953.5,2894.1406,957.5,2890.1406" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="2890.1406" y2="2890.1406"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2850.2959">SAM #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2867.5869">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2884.8779">- APDU list</text><polygon fill="#181818" points="1252.5,2917.4316,1262.5,2921.4316,1252.5,2925.4316,1256.5,2921.4316" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1258.5" y1="2921.4316" y2="2921.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="982.5" y="2916.1689">digest authenticate (card certificate)</text><polygon fill="#181818" points="986.5,2948.7227,976.5,2952.7227,986.5,2956.7227,982.5,2952.7227" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1263.5" y1="2952.7227" y2="2952.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="992.5" y="2947.46">[authentication status]</text><polygon fill="#00FF00" points="402,2980.0137,392,2984.0137,402,2988.0137,398,2984.0137" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="2984.0137" y2="2984.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="408" y="2978.751">[authentification status]</text><polygon fill="#181818" points="89,3132.3418,79,3136.3418,89,3140.3418,85,3136.3418" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3136.3418" y2="3136.3418"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3010.042">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3027.333">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3044.624">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="3061.915">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3079.2061">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="127" y="3096.4971">- counter #1 data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="127" y="3113.7881">- event #1 (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="3131.0791">authentification status</text><!--SRC=[tLXBR-Cs4BxhLn09q3f2tERXRJP16i2MvIA7eelTBNf8Sc0asYQYKAf4U-5_tncAf4IzdAHfKJI782lEp3Sp_ER1_RvuuYAZENqcGKABOfRcCSk3D4bpShWu3IOd2sz8P3wP1YVpcaWXMSvIkSlOr16SNiw3-Q9JyDOHd4sc5-67Ji70jJYVdyxEEWL3Hp2SNPwxq6iQfz-uM94bJGhcrOw-I2hPS8JJIF8jbxikAUzxyfd5hOpHw6cLfniHA-dhwvp5DpUGttau3uE1_5h9y68Id0VUciUCc8zLk83wQPDd2TiBd2anXJq9WyN587Ob_36SJAPp0s-_Enuy9flz-2YaufajFYncW-X6z7no-N4-CzZwguFyIywOs0kzGYc5FLrC5wU3s5RsB0o2YrC3RZxNq07-jvoArVxGKoLMNllYBBmSTA0I3d-w2C_EZ0Vsk-i2P63taWJiolZ380ptnQz4puBpyCD9BVnT0vf64jX_y9L7JqnYGKspBE4HbJmL1uGMX6OPELobIUm1bkGHpwYGv22WoIuhKZBzTAl48ffnSfXnyTGj5z0ylXUV6GKVjK8Ub_yaXmbVhUKCwVU8uT9yHmuAbh18Cb3oVLJsVQjML-W4-pBzrS4gwBC3LVAj6mjqDHHeEVAOAxw5xbBBYVtKzCiUjArasVW6VbqHt-UYaE0v1q7V9yPzPKi2KGgqaeghUt4ln-vnpefqaqVCFGBdxOddYHJmqos4ZRVZ4VW9rYnwWaib1Ly9AZSv22n9bhCjJpT5iWDj6fEOIag-hPaWPMQG5t9T1lc3nqHCqBGE1MrVaUjb2ZSG8Vj-nkxc-s0KBWVYkluHpsxwmaepXHEXBmKh2ZWXetauk_rAQ1J11vAmBKkEIcdb7nDRdgVYcG7aaYSw2RuFeVBb3Z9P5r31-BuDsFThbYBmB0TtoE5fzHKJ1joGo9VJ-XK3nJN7yU-nkaOlPex4tgoa65CjA-dpCnLnGKPFZ6KaMbCXMAAoSjIDNOBV7PwSB1Od9mytbjqkNjdh5A4X301i-78lr5qySsaOzUU65R9Cm_JJ_7UIy48wHEueeefZzbmHRKgAZ4LyoQCQrPxOZiGSX0iyK3q6Cvt4v94fV0wEmT_B58IHS9MgpXimiKv0Ypd6B5nP2f3QRPDHYmtsz0WjZCVr55QGK9foKtX38MgwTiN52xp3738N7nE-LE5O6R05vp5VBg4JWrSIRfr0r4hALAFsjQoCAdvj5Z26Cb4MheCuKjTSG89eqWgyPM35998nIPYQZSqqtI6jxFb3JTqIqnJ1NN_-Z-z5mqwjcYhVAiQZwOURQdQub5UxHJakOFJP6dijqxj7auUpE5E3h5IobGjT7EUhPeFYHcLYhBozwcvpofsOFO9dmA5ZzCZ9H_bbSUiqD9cgBdLaWSPZ9oDtoggrGRvhjSE77XzLIynP19i4-5QrnW6eIkWrbarp7J9iPBHTe3hom1fswA1eveRzu3Pce-VLMZVeE3ELFzCLqrC9BXJcigrczA4yQ95vjCbYh78ze6n6a5CrlMQcp5Stp7jnD- -i-giUz6QxUdZrF6fCwH8vxflMjI7RZAXhoFe-L4csKUiDJF7ESVp_cB1d_zI4xPq_V-22rZCZD1JE7lsLmTQN90I2Zb50jHcTcA4v4lCLs84M1q6CC6MeZA3x9uXMBSk3Z9gRsziC6DAzLLkLMrkvDyctIo8OvWyU2iUuDvkjnhB_XUkDMGRUVxrfrU7xh3UzaPTr_A-6hPj8Owsp_QGZpbgpiKhUu9RIdqQTAXZ6NLO7TnOpPmQR-bvatVltWPVDyNNzNhiGimWAf63rWJJQKjXxz5W3etX1fGzcaAlSwnYIj62j_GRka-2k2ljdVFJwFj_nW9tAaa8Q0M5nZoHKxFfwOR4sPDm8o-XNF6DxnqaPivadTAawIt-G6WBV-_WV5X8wCeQotAYRDg_wB1KGt9j6qFcRDzwUoLDklEsSL274LLwgnRYA0cziJrzkCk_8A3dz-GM6EXZQRGitoHvRwaRx7ZiirmiXLDrW9sb9lz-Zvlo_zQZHkJVzGEN-MBVapis-nqwh_TJU2CUax4EzJmN1lbaz9Tf-B6YOxYRLkAuZh_zDLR_KZaSEbVK9g1BPDjRhbtc_O3VfK6iyPvpuB8l6xcEeXuIjvz3h-ipadVjCJp7I3RH7x3Igl9i1TSpykve6Ne5v4GqMgz5PDhLUCDN__kln7TwCpGTesG1nVfllyAhiYR8vSly2]--></g></svg>