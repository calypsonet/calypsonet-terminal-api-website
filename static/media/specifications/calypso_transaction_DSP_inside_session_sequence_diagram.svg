<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3017px" preserveAspectRatio="none" style="width:1448px;height:3017px;background:#FFFFFF;" version="1.1" viewBox="0 0 1448 3017" width="1448px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="2835.8496" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.0166" y="91.4883"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="297.5938"/><rect fill="#FFC0CB" height="720.627" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="340.9043"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1121.4629"/><rect fill="#FFC0CB" height="639.5215" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1164.7734"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1879.5371"/><rect fill="#FFC0CB" height="960.1797" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1958.1582"/><rect fill="#ADD8E6" height="267.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="657.9414"/><rect fill="#ADD8E6" height="307.7949" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="2326.1953"/><rect fill="#ADD8E6" height="2513.1914" style="stroke:#181818;stroke-width:1.0;" width="10" x="940.4639" y="91.4883"/><rect fill="#90EE90" height="197.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="400.8359"/><rect fill="#90EE90" height="519.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="1224.7051"/><rect fill="#90EE90" height="205.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2060.4004"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2693.9219"/><rect fill="#90EE90" height="2835.8496" style="stroke:#181818;stroke-width:1.0;" width="10" x="1359.1655" y="91.4883"/><rect fill="none" height="223.7949" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="672.9414"/><rect fill="none" height="103.9316" style="stroke:#000000;stroke-width:1.5;" width="428.7017" x="976.3647" y="2075.4004"/><rect fill="none" height="119.2422" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="2341.1953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="80" x2="80" y1="81.4883" y2="2936.3379"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="407.1899" x2="407.1899" y1="81.4883" y2="2936.3379"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="675.8447" x2="675.8447" y1="81.4883" y2="2936.3379"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="944.563" x2="944.563" y1="81.4883" y2="2936.3379"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1036.3647" x2="1036.3647" y1="81.4883" y2="2936.3379"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1363.2646" x2="1363.2646" y1="81.4883" y2="2936.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="78.5352">Ticketing Application</text><ellipse cx="80.0166" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,21.5 L80.0166,48.5 M67.0166,29.5 L93.0166,29.5 M80.0166,48.5 L67.0166,63.5 M80.0166,48.5 L93.0166,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="2948.873">Ticketing Application</text><ellipse cx="80.0166" cy="2960.3262" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,2968.3262 L80.0166,2995.3262 M67.0166,2976.3262 L93.0166,2976.3262 M80.0166,2995.3262 L67.0166,3010.3262 M80.0166,2995.3262 L93.0166,3010.3262 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="372.1899" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="381.4355" y="54.0469">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="379.1899" y="70.5352">Card API</text><rect fill="#FFC0CB" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="372.1899" y="2935.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="381.4355" y="2955.873">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="379.1899" y="2972.3613">Card API</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.7148" x="624.8447" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.7148" x="631.8447" y="54.0469">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="653.3403" y="70.5352">Reader</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.7148" x="624.8447" y="2935.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.7148" x="631.8447" y="2955.873">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="653.3403" y="2972.3613">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="914.563" y="62.0469">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="925.5415" y="78.5352">Card</text><path d="M924.9639,20.5117 L924.9639,44.5117 M924.9639,32.5117 L941.9639,32.5117 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="953.9639" cy="32.5117" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="914.563" y="2948.873">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="925.5415" y="2965.3613">Card</text><path d="M924.9639,2972.3145 L924.9639,2996.3145 M924.9639,2984.3145 L941.9639,2984.3145 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="953.9639" cy="2984.3145" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="986.3647" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="993.3647" y="54.0469">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="1013.5103" y="70.5352">Reader</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="986.3647" y="2935.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="993.3647" y="2955.873">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="1013.5103" y="2972.3613">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="1333.2646" y="62.0469">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1345.6582" y="78.5352">SAM</text><path d="M1343.6655,20.5117 L1343.6655,44.5117 M1343.6655,32.5117 L1360.6655,32.5117 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1372.6655" cy="32.5117" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="1333.2646" y="2948.873">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1345.6582" y="2965.3613">SAM</text><path d="M1343.6655,2972.3145 L1343.6655,2996.3145 M1343.6655,2984.3145 L1360.6655,2984.3145 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1372.6655" cy="2984.3145" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="2835.8496" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.0166" y="91.4883"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="297.5938"/><rect fill="#FFC0CB" height="720.627" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="340.9043"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1121.4629"/><rect fill="#FFC0CB" height="639.5215" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1164.7734"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1879.5371"/><rect fill="#FFC0CB" height="960.1797" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1958.1582"/><rect fill="#ADD8E6" height="267.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="657.9414"/><rect fill="#ADD8E6" height="307.7949" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="2326.1953"/><rect fill="#ADD8E6" height="2513.1914" style="stroke:#181818;stroke-width:1.0;" width="10" x="940.4639" y="91.4883"/><rect fill="#90EE90" height="197.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="400.8359"/><rect fill="#90EE90" height="519.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="1224.7051"/><rect fill="#90EE90" height="205.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2060.4004"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2693.9219"/><rect fill="#90EE90" height="2835.8496" style="stroke:#181818;stroke-width:1.0;" width="10" x="1359.1655" y="91.4883"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="143.4199" y2="143.4199"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="143.4199" y2="156.4199"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="156.4199" y2="156.4199"/><polygon fill="#181818" points="96.0166,152.4199,86.0166,156.4199,96.0166,160.4199,92.0166,156.4199" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71.5889" x="92.0166" y="108.0566">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.7642" x="167.7188" y="108.0566">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1821" x="124.9229" y="123.3672">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.0107" x="124.9229" y="138.6777">- Calypso SAM resource</text><path d="M184,169.4199 L184,194.4199 L631,194.4199 L631,179.4199 L621,169.4199 L184,169.4199 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M621,169.4199 L621,179.4199 L631,179.4199 L621,169.4199 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.626" x="190" y="186.9883">Checks a signature of previously read data when selecting the card.</text><polygon fill="#181818" points="391.0991,293.5938,401.0991,297.5938,391.0991,301.5938,395.0991,297.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="297.5938" y2="297.5938"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="216.2988">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="216.2988">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.1763" x="124.9229" y="231.6094">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8022" x="124.9229" y="246.9199">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="124.9229" y="262.2305">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.4351" x="136.5581" y="262.2305">verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.9951" x="179.1064" y="262.2305">environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.667" x="294.2148" y="262.2305">signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.8193" x="124.9229" y="277.541">- read contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.9917" x="124.9229" y="292.8516">- reader counter #1</text><polygon fill="#181818" points="96.0166,307.5938,86.0166,311.5938,96.0166,315.5938,92.0166,311.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="311.5938" y2="311.5938"/><polygon fill="#181818" points="391.0991,336.9043,401.0991,340.9043,391.0991,344.9043,395.0991,340.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="340.9043" y2="340.9043"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="336.1621">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.5542" x="148.1934" y="336.1621">commands (keep channel open)</text><polygon fill="#00FF00" points="1019.8721,396.8359,1029.8721,400.8359,1019.8721,404.8359,1023.8721,400.8359" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="400.8359" y2="400.8359"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="365.4727">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="380.7832">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="396.0938">- APDU list</text><path d="M742,413.8359 L742,438.8359 L1330,438.8359 L1330,423.8359 L1320,413.8359 L742,413.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1320,413.8359 L1320,423.8359 L1330,423.8359 L1320,413.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="567.6392" x="748" y="431.4043">A specific signature key diversification could be required before the signature processing.</text><polygon fill="#181818" points="1347.1655,461.457,1357.1655,465.457,1347.1655,469.457,1351.1655,465.457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="465.457" y2="465.457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.3867" x="1048.8721" y="460.7148">verify signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.7935" x="1159.3721" y="460.7148">(environment data signature)</text><polygon fill="#181818" points="1052.8721,490.7676,1042.8721,494.7676,1052.8721,498.7676,1048.8721,494.7676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="494.7676" y2="494.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.5688" x="1058.8721" y="490.0254">signature status</text><polygon fill="#181818" points="1347.1655,520.0781,1357.1655,524.0781,1347.1655,528.0781,1351.1655,524.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="524.0781" y2="524.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4048" x="1048.8721" y="519.3359">get challenge</text><polygon fill="#181818" points="1052.8721,549.3887,1042.8721,553.3887,1052.8721,557.3887,1048.8721,553.3887" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="553.3887" y2="553.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="1058.8721" y="548.6465">[SAM challenge]</text><polygon fill="#00FF00" points="424.0991,594.0098,414.0991,598.0098,424.0991,602.0098,420.0991,598.0098" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="598.0098" y2="598.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.6792" x="430.0991" y="577.957">[environment data signature,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.5894" x="430.0991" y="593.2676">SAM challenge]</text><polygon fill="#0000FF" points="659.7021,653.9414,669.7021,657.9414,659.7021,661.9414,663.7021,657.9414" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.0991" x2="665.7021" y1="657.9414" y2="657.9414"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.0991" y="622.5781">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="637.8887">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="653.1992">- APDU list</text><path d="M614.8447,672.9414 L909.7266,672.9414 L909.7266,680.252 L899.7266,690.252 L614.8447,690.252 L614.8447,672.9414 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="223.7949" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="672.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="629.8447" y="686.5098">Card APDU commands inside session</text><polygon fill="#181818" points="928.4639,738.1836,938.4639,742.1836,928.4639,746.1836,932.4639,742.1836" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="742.1836" y2="742.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.6772" x="688.7021" y="706.8203">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4751" x="721.6084" y="722.1309">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.5337" x="721.6084" y="737.4414">SFI environment to read)</text><polygon fill="#181818" points="692.7021,767.4941,682.7021,771.4941,692.7021,775.4941,688.7021,771.4941" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="771.4941" y2="771.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.2744" x="698.7021" y="766.752">[card challenge &amp; environment data]</text><polygon fill="#181818" points="928.4639,796.8047,938.4639,800.8047,928.4639,804.8047,932.4639,800.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="800.8047" y2="800.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.46" x="688.7021" y="796.0625">read record (contract #1)</text><polygon fill="#181818" points="692.7021,826.1152,682.7021,830.1152,692.7021,834.1152,688.7021,830.1152" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="830.1152" y2="830.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.1187" x="698.7021" y="825.373">[contract #1 data]</text><polygon fill="#181818" points="928.4639,855.4258,938.4639,859.4258,928.4639,863.4258,932.4639,859.4258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="859.4258" y2="859.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.0703" x="688.7021" y="854.6836">read record (counter #1)</text><polygon fill="#181818" points="692.7021,884.7363,682.7021,888.7363,692.7021,892.7363,688.7021,888.7363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="888.7363" y2="888.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.729" x="698.7021" y="883.9941">[counter #1 data]</text><polygon fill="#0000FF" points="424.0991,921.0469,414.0991,925.0469,424.0991,929.0469,420.0991,925.0469" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="675.7021" y1="925.0469" y2="925.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9883" x="430.0991" y="920.3047">[card challenge]</text><polygon fill="#181818" points="96.0166,1057.5313,86.0166,1061.5313,96.0166,1065.5313,92.0166,1061.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="1061.5313" y2="1061.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="949.6152">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="964.9258">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.0972" x="134.9229" y="980.2363">- environment data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="995.5469">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.2988" x="134.9229" y="1010.8574">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.1367" x="134.9229" y="1026.168">- counter #1 data]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2573" x="102.0166" y="1041.4785">[Data secure processing:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.54" x="134.9229" y="1056.7891">- environment data signature status]</text><polygon fill="#181818" points="391.0991,1117.4629,401.0991,1121.4629,391.0991,1125.4629,395.0991,1121.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="1121.4629" y2="1121.4629"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="1086.0996">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.5864" x="148.0537" y="1086.0996">secured card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="124.9229" y="1101.4102">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.4351" x="136.5581" y="1101.4102">verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.6636" x="179.1064" y="1101.4102">contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.667" x="286.8833" y="1101.4102">signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="124.9229" y="1116.7207">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.8652" x="136.5581" y="1116.7207">compute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.6602" x="198.5366" y="1116.7207">event data</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.667" x="268.3101" y="1116.7207">signature</text><polygon fill="#181818" points="96.0166,1131.4629,86.0166,1135.4629,96.0166,1139.4629,92.0166,1135.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="1135.4629" y2="1135.4629"/><polygon fill="#181818" points="391.0991,1160.7734,401.0991,1164.7734,391.0991,1168.7734,395.0991,1164.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="1164.7734" y2="1164.7734"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="1160.0313">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.5542" x="148.1934" y="1160.0313">commands (keep channel open)</text><polygon fill="#00FF00" points="1019.8721,1220.7051,1029.8721,1224.7051,1019.8721,1228.7051,1023.8721,1224.7051" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="1224.7051" y2="1224.7051"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="1189.3418">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="1204.6523">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="1219.9629">- APDU list</text><path d="M773,1237.7051 L773,1262.7051 L1298,1262.7051 L1298,1247.7051 L1288,1237.7051 L773,1237.7051 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1288,1237.7051 L1288,1247.7051 L1298,1247.7051 L1288,1237.7051 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="504.8037" x="779" y="1255.2734">When data secure processing requested, processes all pending SAM commands.</text><path d="M631,1273.0156 L631,1298.0156 L1441,1298.0156 L1441,1283.0156 L1431,1273.0156 L631,1273.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1431,1273.0156 L1431,1283.0156 L1441,1283.0156 L1431,1273.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="789.1533" x="637" y="1290.584">A session key diversification is operated, if the diversifier is different than for the previous data secure processing operation.</text><polygon fill="#181818" points="1347.1655,1320.6367,1357.1655,1324.6367,1347.1655,1328.6367,1351.1655,1324.6367" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1324.6367" y2="1324.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.124" x="1048.8721" y="1319.8945">select diversifier (card serial)</text><polygon fill="#181818" points="1052.8721,1334.6367,1042.8721,1338.6367,1052.8721,1342.6367,1048.8721,1338.6367" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1338.6367" y2="1338.6367"/><polygon fill="#181818" points="1347.1655,1363.9473,1357.1655,1367.9473,1347.1655,1371.9473,1351.1655,1367.9473" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1367.9473" y2="1367.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="1048.8721" y="1363.2051">digest init (opening data)</text><polygon fill="#181818" points="1052.8721,1377.9473,1042.8721,1381.9473,1052.8721,1385.9473,1048.8721,1381.9473" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1381.9473" y2="1381.9473"/><polygon fill="#181818" points="1347.1655,1407.2578,1357.1655,1411.2578,1347.1655,1415.2578,1351.1655,1411.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1411.2578" y2="1411.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.6914" x="1048.8721" y="1406.5156">digest update (read environment)</text><polygon fill="#181818" points="1052.8721,1421.2578,1042.8721,1425.2578,1052.8721,1429.2578,1048.8721,1425.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1425.2578" y2="1425.2578"/><polygon fill="#181818" points="1347.1655,1450.5684,1357.1655,1454.5684,1347.1655,1458.5684,1351.1655,1454.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1454.5684" y2="1454.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.8062" x="1048.8721" y="1449.8262">digest update (read contract)</text><polygon fill="#181818" points="1052.8721,1464.5684,1042.8721,1468.5684,1052.8721,1472.5684,1048.8721,1468.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1468.5684" y2="1468.5684"/><polygon fill="#181818" points="1347.1655,1493.8789,1357.1655,1497.8789,1347.1655,1501.8789,1351.1655,1497.8789" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1497.8789" y2="1497.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.4165" x="1048.8721" y="1493.1367">digest update (read counter)</text><polygon fill="#181818" points="1052.8721,1507.8789,1042.8721,1511.8789,1052.8721,1515.8789,1048.8721,1511.8789" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1511.8789" y2="1511.8789"/><path d="M672,1524.8789 L672,1549.8789 L1400,1549.8789 L1400,1534.8789 L1390,1524.8789 L672,1524.8789 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1390,1524.8789 L1390,1534.8789 L1400,1534.8789 L1390,1524.8789 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="707.0591" x="678" y="1542.4473">If necessary, a specific contract signature key diversification could be operated before the signature processing.</text><polygon fill="#181818" points="1347.1655,1572.5,1357.1655,1576.5,1347.1655,1580.5,1351.1655,1576.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1576.5" y2="1576.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.3867" x="1048.8721" y="1571.7578">verify signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.4619" x="1159.3721" y="1571.7578">(contract #1 data signature)</text><polygon fill="#181818" points="1052.8721,1601.8105,1042.8721,1605.8105,1052.8721,1609.8105,1048.8721,1605.8105" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1605.8105" y2="1605.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.5688" x="1058.8721" y="1601.0684">signature status</text><path d="M681,1618.8105 L681,1643.8105 L1391,1643.8105 L1391,1628.8105 L1381,1618.8105 L681,1618.8105 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1381,1618.8105 L1381,1628.8105 L1391,1628.8105 L1381,1618.8105 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="689.6094" x="687" y="1636.3789">If necessary, a specific event signature key diversification could be operated before the signature processing.</text><polygon fill="#181818" points="1347.1655,1666.4316,1357.1655,1670.4316,1347.1655,1674.4316,1351.1655,1670.4316" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="1670.4316" y2="1670.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125.8169" x="1048.8721" y="1665.6895">compute signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.1152" x="1178.8022" y="1665.6895">(event data)</text><polygon fill="#181818" points="1052.8721,1695.7422,1042.8721,1699.7422,1052.8721,1703.7422,1048.8721,1699.7422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="1699.7422" y2="1699.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.0034" x="1058.8721" y="1695">event data signature</text><polygon fill="#00FF00" points="424.0991,1740.3633,414.0991,1744.3633,424.0991,1748.3633,420.0991,1744.3633" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="1744.3633" y2="1744.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.6865" x="430.0991" y="1724.3105">[contract #1 data signature status,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.231" x="430.0991" y="1739.6211">event data signature]</text><polygon fill="#181818" points="96.0166,1800.2949,86.0166,1804.2949,96.0166,1808.2949,92.0166,1804.2949" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="1804.2949" y2="1804.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2573" x="102.0166" y="1768.9316">[Data secure processing:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.981" x="134.9229" y="1784.2422">- contract #1 data signature status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.8662" x="134.9229" y="1799.5527">- event data signature]</text><polygon fill="#181818" points="391.0991,1875.5371,401.0991,1879.5371,391.0991,1883.5371,395.0991,1879.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="1879.5371" y2="1879.5371"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="1828.8633">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="143.9404" y="1828.8633">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.7451" x="124.9229" y="1844.1738">- decrease counter #1 (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.7207" x="124.9229" y="1859.4844">- append event record (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.9043" x="124.9229" y="1874.7949">- close secure session (not ratified)</text><polygon fill="#181818" points="96.0166,1889.5371,86.0166,1893.5371,96.0166,1897.5371,92.0166,1893.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="1893.5371" y2="1893.5371"/><path d="M162,1906.5371 L162,1931.5371 L654,1931.5371 L654,1916.5371 L644,1906.5371 L162,1906.5371 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M644,1906.5371 L644,1916.5371 L654,1916.5371 L644,1906.5371 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="471.1357" x="168" y="1924.1055">At the session closure, any data secure processing should be unnecessary.</text><polygon fill="#181818" points="391.0991,1954.1582,401.0991,1958.1582,391.0991,1962.1582,395.0991,1958.1582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="1958.1582" y2="1958.1582"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="1953.416">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.4653" x="148.1934" y="1953.416">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="413.0991" x2="455.0991" y1="1987.4688" y2="1987.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="455.0991" x2="455.0991" y1="1987.4688" y2="2000.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="414.0991" x2="455.0991" y1="2000.4688" y2="2000.4688"/><polygon fill="#181818" points="424.0991,1996.4688,414.0991,2000.4688,424.0991,2004.4688,420.0991,2000.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.603" x="420.0991" y="1982.7266">anticipates the future card responses</text><polygon fill="#00FF00" points="1019.8721,2056.4004,1029.8721,2060.4004,1019.8721,2064.4004,1023.8721,2060.4004" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="2060.4004" y2="2060.4004"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="2025.0371">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="2040.3477">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="2055.6582">- APDU list</text><path d="M976.3647,2075.4004 L1246.3003,2075.4004 L1246.3003,2082.7109 L1236.3003,2092.7109 L976.3647,2092.7109 L976.3647,2075.4004 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="103.9316" style="stroke:#000000;stroke-width:1.5;" width="428.7017" x="976.3647" y="2075.4004"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="74.5786" x="991.3647" y="2088.9688">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.0723" x="1070.228" y="2088.9688">Card APDU responses</text><polygon fill="#181818" points="1347.1655,2110.0215,1357.1655,2114.0215,1347.1655,2118.0215,1351.1655,2114.0215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="2114.0215" y2="2114.0215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.1875" x="1048.8721" y="2109.2793">digest update (decrease counter)</text><polygon fill="#181818" points="1052.8721,2124.0215,1042.8721,2128.0215,1052.8721,2132.0215,1048.8721,2128.0215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="2128.0215" y2="2128.0215"/><polygon fill="#181818" points="1347.1655,2153.332,1357.1655,2157.332,1347.1655,2161.332,1351.1655,2157.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="2157.332" y2="2157.332"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.29" x="1048.8721" y="2152.5898">digest update (append event record)</text><polygon fill="#181818" points="1052.8721,2167.332,1042.8721,2171.332,1052.8721,2175.332,1048.8721,2171.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="2171.332" y2="2171.332"/><polygon fill="#181818" points="1347.1655,2203.6426,1357.1655,2207.6426,1347.1655,2211.6426,1351.1655,2207.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="2207.6426" y2="2207.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1626" x="1048.8721" y="2202.9004">digest close</text><polygon fill="#181818" points="1052.8721,2232.9531,1042.8721,2236.9531,1052.8721,2240.9531,1048.8721,2236.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="2236.9531" y2="2236.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="1058.8721" y="2232.2109">[SAM certificate]</text><polygon fill="#00FF00" points="424.0991,2262.2637,414.0991,2266.2637,424.0991,2270.2637,420.0991,2266.2637" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="2266.2637" y2="2266.2637"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="430.0991" y="2261.5215">[SAM certificate]</text><polygon fill="#0000FF" points="659.7021,2322.1953,669.7021,2326.1953,659.7021,2330.1953,663.7021,2326.1953" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.0991" x2="665.7021" y1="2326.1953" y2="2326.1953"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.0991" y="2290.832">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="2306.1426">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="2321.4531">- APDU list</text><path d="M614.8447,2341.1953 L909.7266,2341.1953 L909.7266,2348.5059 L899.7266,2358.5059 L614.8447,2358.5059 L614.8447,2341.1953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.2422" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="2341.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="629.8447" y="2354.7637">Card APDU commands inside session</text><polygon fill="#181818" points="928.4639,2375.8164,938.4639,2379.8164,928.4639,2383.8164,932.4639,2379.8164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2379.8164" y2="2379.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.8789" x="688.7021" y="2375.0742">update record (event, data)</text><polygon fill="#181818" points="692.7021,2389.8164,682.7021,2393.8164,692.7021,2397.8164,688.7021,2393.8164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2393.8164" y2="2393.8164"/><polygon fill="#181818" points="928.4639,2419.127,938.4639,2423.127,928.4639,2427.127,932.4639,2423.127" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2423.127" y2="2423.127"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.5405" x="688.7021" y="2418.3848">decrease counter (counter #1, value)</text><polygon fill="#181818" points="692.7021,2448.4375,682.7021,2452.4375,692.7021,2456.4375,688.7021,2452.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2452.4375" y2="2452.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.189" x="698.7021" y="2447.6953">[new counter value]</text><polygon fill="#181818" points="928.4639,2484.748,938.4639,2488.748,928.4639,2492.748,932.4639,2488.748" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2488.748" y2="2488.748"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.7617" x="688.7021" y="2484.0059">close secure session (SAM certificate)</text><polygon fill="#181818" points="692.7021,2514.0586,682.7021,2518.0586,692.7021,2522.0586,688.7021,2518.0586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2518.0586" y2="2518.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="698.7021" y="2513.3164">[card certificate]</text><polygon fill="#181818" points="928.4639,2543.3691,938.4639,2547.3691,928.4639,2551.3691,932.4639,2547.3691" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2547.3691" y2="2547.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.6274" x="688.7021" y="2542.627">ratification command</text><polygon fill="#181818" points="692.7021,2557.3691,682.7021,2561.3691,692.7021,2565.3691,688.7021,2561.3691" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2561.3691" y2="2561.3691"/><polygon fill="#181818" points="928.4639,2586.6797,938.4639,2590.6797,928.4639,2594.6797,932.4639,2590.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2590.6797" y2="2590.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.8794" x="688.7021" y="2585.9375">close card channel</text><polygon fill="#181818" points="692.7021,2600.6797,682.7021,2604.6797,692.7021,2608.6797,688.7021,2604.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="944.4639" y1="2604.6797" y2="2604.6797"/><polygon fill="#0000FF" points="424.0991,2629.9902,414.0991,2633.9902,424.0991,2637.9902,420.0991,2633.9902" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="675.7021" y1="2633.9902" y2="2633.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="430.0991" y="2629.248">[card certificate]</text><polygon fill="#00FF00" points="1019.8721,2689.9219,1029.8721,2693.9219,1019.8721,2697.9219,1023.8721,2693.9219" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="2693.9219" y2="2693.9219"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="2658.5586">SAM #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="2673.8691">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="2689.1797">- APDU list</text><polygon fill="#181818" points="1347.1655,2719.2324,1357.1655,2723.2324,1347.1655,2727.2324,1351.1655,2723.2324" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1353.1655" y1="2723.2324" y2="2723.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.2842" x="1048.8721" y="2718.4902">digest authenticate (card certificate)</text><polygon fill="#181818" points="1052.8721,2748.543,1042.8721,2752.543,1052.8721,2756.543,1048.8721,2752.543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1358.1655" y1="2752.543" y2="2752.543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4131" x="1058.8721" y="2747.8008">[authentication status]</text><polygon fill="#00FF00" points="424.0991,2777.8535,414.0991,2781.8535,424.0991,2785.8535,420.0991,2781.8535" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="2781.8535" y2="2781.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9507" x="430.0991" y="2777.1113">[authentification status]</text><polygon fill="#181818" points="96.0166,2914.3379,86.0166,2918.3379,96.0166,2922.3379,92.0166,2918.3379" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="2918.3379" y2="2918.3379"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="2806.4219">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="2821.7324">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="2837.043">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="2852.3535">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.2988" x="134.9229" y="2867.6641">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.376" x="134.9229" y="2882.9746">- counter #1 data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.0273" x="134.9229" y="2898.2852">- event #1 (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4956" x="102.0166" y="2913.5957">authentification status</text><!--SRC=[tLXDR-Cs4BtxLn09qCP2t3gEjza4QG1RbeiSYYvsj-WXpe6HQ9kmJAaIxON_VMSeaHBrvJXDYw9xsCsAC_DcXezlo7oVRhY8QKAtn0rfcawZ96296uLHGixdL-vuEEzrcSp64tSuAvcaaYKiaeUOJIp3oUtCdSqR3Hyjm-buSkDzQ3HqxOYpsTLqr6ZeMORUzFRQXbxJ8Fh6nOeiQPYoNcdfYwIITLSuyINVStbeikfzJpwpeDOnwczMIRGJWRA-lqzOyF00_PrvCy_jwA-nz6x6xhNRM_E04VsnA1TGF-sIE6H7WMDbfh37dZk_wSGkZ3zwu_5afk7DTok3bt1t71-DL3tJ-OVvj1DTcrwFRp_EfXex_seX_v8m9ev2hz1AOK_ca_bL9xQn7NckUtEbmVNd4Zh0_vPGiJfUUgJCicsVZxpRpWGAO- -d6syqqXcOxtOAq873QnfmoEhtNCyxLhyo7RdNteTXgVn31Phw4jX_zfNx6oRnG4tYEEG-bJmIPuIcXCOnELz5OT03BCbz7bCXoPbBmqESHWlXqYGWaq-FojYdCIVdCHURHck2nWlncL78D7T8Wko_v3pagxMS8WbVi6YQ7CXPoaBcImPEZeFEZcFSoWwDO5yclrfOATrQK1dhch70DuS2ByiUEyRte36bpfXFrRpCGZrA70yUuAyxuZXSf18ovs3eE4Idhs99e4kAKI9njn0BER2N4vP6kyHdzX8aRrPwFH41VhI7id5tUWJ-k6lcRs1hISfNWifT0WPB4YTipwDT6Xx0cmOae9AIRsicIDOPP8TSPqN-q6CY81WwBmLZtv7xPGGxu2C7VqQDSnm82fi3TTt_Y6iFRML5iSBnCPUKfIcia8kPDttyIgZlmmSIiZqB-vcroe-9FKyYiMK0kUHXtWJ7WLBvyW2TB1keOXp75EmufKW-P9P0EkJyglYA3GDkIEJBLNcBWU8vn_7dWTh6Ni0iYwDTYR2cKbUYxPQA82KN6yPYug-f42nKNUatOsVWJ-V3uNm-73u_67RRU9dYAK936G1OoMKXr5vikTIC-dF7KfcrOV9fzZi9UIej8ZSSee9ZPbqHRKBIcFbyoVqIrJRiG08EnYakAAN1JeS1UM4AdqDYyFCo0cCaNE6QzmsOM2QWmHnW5-uC1KXfjyb5ZGrcjOyH1eDo2mj8E9fobzP1LapYDeKXKxEZ6k096sxMdqlkPiiqFPxQCxjSY4gS4i-ALXTSmD3F3uMgscHGipSJKXWDXdsdSg1Pj7iugsAIpmDmCfm6VSFvanzhHOmYn41bUzSi02gTWBr0Pi2QIyp8waVsPVve7NKPgVFRDq23WTMH9nNLn23VrOJYkIL79HO9ys7IGcw5Q7H05KQdHDQoqnLOs-HnuJWW3qnWYmwAPdRPpxPaQRzUITJ0nvesV4jNBDThs52OMERyOWxPGetC5xiO_cL1Bjsc8yYfab-rK_ghNUP2FCtK2Sc8KkZ1NGjwzI0_dwpKbVcL8GTjSwmqVgeLDOqVnu5J4k_Ku8VvrZYe_X-pP_HFpPxMuVC7Nbs2HhPeA1PSwgyCxaDXIA3e00sKpEIDASsQZa6NQrRJTECfTZEX2eylrL0pDX0BrWE-NCAj7EKB-azWzYahVIThgoCB2nXTyp2xlbc8cRAcG5KQriPVBK30Lz0iq77OgGla1K9ZHgzspJI0N5GlRcyBe4_MMxsLfjITMtVtSKa4mvR3E-4IhytwKcEE-2jlDve5xt-xgOdDQRURaolFnEfVBJjNoigjpeXcGvqbHJLElSwhM7iRyrR1ZQCfQkV5J0_Jpibr53aVSCV0imbmsb3BKmYO3mSaPUMfUx6dSBdBPpS4nGtASj2t5TNxl8OmIbdj4WVxIL2aG7Y2_kd3hE7zEf4PXN84XCNBCg7Yq2QKwLgJSISCeqzunRREpAncFJJfKYbBUv4v13xtyVSL4iOEbhBSgPtMZ_eu4b3Sc-RizPklzItZDRlMrtjIb10KVIbk_qKLk6D7TBdAlBvsilJv5O4Q6DeS2w_BBR7KZhQzw5YItthXr7KgIStw_Lvkr_-jbrlUUwq7glUNkIGtFbzQujJaf_GGkYIP3hM-XmJxPloKQVr5bCCqYrHbk_gzzeTZULCRNd9KbYUWQcGzM6jU-f66QjBWLdcpMVKP5Wti5ryB2MjlljDqPlpEEjDo6EaEv16LHXtlQa4DC_-fv85Re9zzdOTL-oohNg-Owd__YVmE3-FgApiJG9pV-ZiydLkgh8xSlm00]--></g></svg>