<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="7327px" preserveAspectRatio="none" style="width:1868px;height:7327px;background:#FFFFFF;" version="1.1" viewBox="0 0 1868 7327" width="1868px" zoomAndPan="magnify"><defs/><g><g><title>Ticketing Application</title><rect fill="#FFD700" height="7145.5547" style="stroke:#181818;stroke-width:1;" width="10" x="75.0166" y="91.4883"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="320.9727"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="197.1738" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="364.2832"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="995.7363"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="149.2422" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="1039.0469"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="360.0371" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="1396.4629"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="1785.8105"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="715.3203"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="937.1152"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="59.9316" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="1844.4316"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2173.4688"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="450.8398" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2216.7793"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2769.8613"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="285.0371" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2813.1719"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3367.9355"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="300.3477" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3411.2461"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3798.5254"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="315.6582" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3841.8359"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4244.4258"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="330.9688" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4287.7363"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4736.2578"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="1937.8027" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4779.5684"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="6873.3164"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="179.8633" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="1456.3945"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="221.6094" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="2355.457"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="2873.1035"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="3471.1777"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="3901.7676"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="4347.668"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="762.1309" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="5548.3398"/></g><g><title>..Card..</title><rect fill="#ADD8E6" height="5584.7852" style="stroke:#181818;stroke-width:1;" width="10" x="1137.5542" y="1485.7051"/></g><g><title>Calypso SAM</title><rect fill="#90EE90" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="1412.5239" y="262.3516"/></g><g><title>Calypso SAM</title><rect fill="#90EE90" height="44.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1412.5239" y="590.7676"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="72.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="424.2148"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="775.252"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="555.9766" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="4932.4316"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="6462.334"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="6933.248"/></g><g><title>..SAM..</title><rect fill="#90EE90" height="6783.5176" style="stroke:#181818;stroke-width:1;" width="10" x="1812.4053" y="453.5254"/></g><rect fill="none" height="162.9883" style="stroke:#000000;stroke-width:1.5;" width="543.0542" x="634" y="2370.457"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="2888.1035"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="3486.1777"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="3916.7676"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="4362.668"/><rect fill="none" height="109.7461" style="stroke:#000000;stroke-width:1.5;" width="383.874" x="1468.0313" y="5291.7305"/><rect fill="none" height="247.1055" style="stroke:#000000;stroke-width:1.5;" width="440.9497" x="786.4727" y="5563.3398"/><g><title>Ticketing Application</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="76.0166" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="80" x2="80" y1="81.4883" y2="7246.043"/></g><g><title>Reader API</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="404.7148" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="408.4229" x2="408.4229" y1="81.4883" y2="7246.043"/></g><g><title>Calypso</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="601.3037" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="604.3945" x2="604.3945" y1="81.4883" y2="7246.043"/></g><g><title>Calypso Card Reader</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="869.9067" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="873.4727" x2="873.4727" y1="81.4883" y2="7246.043"/></g><g><title>..Card..</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="1138.5542" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1142.0542" x2="1142.0542" y1="81.4883" y2="7246.043"/></g><g><title>Calypso SAM</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="1413.5239" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1417.0166" x2="1417.0166" y1="81.4883" y2="7246.043"/></g><g><title>Calypso SAM Reader</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="1550.1152" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1554.0313" x2="1554.0313" y1="81.4883" y2="7246.043"/></g><g><title>..SAM..</title><rect fill="#000000" fill-opacity="0.00000" height="7164.5547" width="8" x="1813.4053" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1816.9053" x2="1816.9053" y1="81.4883" y2="7246.043"/></g><g class="participant participant-head" data-participant="app"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="78.5352">Ticketing Application</text><ellipse cx="80.0166" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,21.5 L80.0166,48.5 M67.0166,29.5 L93.0166,29.5 M80.0166,48.5 L67.0166,63.5 M80.0166,48.5 L93.0166,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="app"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="7258.5781">Ticketing Application</text><ellipse cx="80.0166" cy="7270.0313" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,7278.0313 L80.0166,7305.0313 M67.0166,7286.0313 L93.0166,7286.0313 M80.0166,7305.0313 L67.0166,7320.0313 M80.0166,7305.0313 L93.0166,7320.0313" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="rapi"><rect fill="#FFC0CB" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86.584" x="365.4229" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.584" x="372.4229" y="70.5352">Reader API</text></g><g class="participant participant-tail" data-participant="rapi"><rect fill="#FFC0CB" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86.584" x="365.4229" y="7245.043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.584" x="372.4229" y="7265.5781">Reader API</text></g><g class="participant participant-head" data-participant="capi"><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="569.3945" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="578.6401" y="54.0469">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="576.3945" y="70.5352">Card API</text></g><g class="participant participant-tail" data-participant="capi"><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="569.3945" y="7245.043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="578.6401" y="7265.5781">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="576.3945" y="7282.0664">Card API</text></g><g class="participant participant-head" data-participant="cardReader"><rect fill="#ADD8E6" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154.8682" x="796.4727" y="17.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.8682" x="803.4727" y="37.5586">Calypso Card Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="871.6919" y="54.0469">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="60.4434" x="811.0024" y="70.5352">dynamic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.9355" x="875.8755" y="70.5352">presence</text></g><g class="participant participant-tail" data-participant="cardReader"><rect fill="#ADD8E6" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154.8682" x="796.4727" y="7245.043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.8682" x="803.4727" y="7265.5781">Calypso Card Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="871.6919" y="7282.0664">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="60.4434" x="811.0024" y="7298.5547">dynamic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.9355" x="875.8755" y="7298.5547">presence</text></g><g class="participant participant-head" data-participant="card"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="1122.6318" y="78.5352">Card</text><path d="M1122.0542,37 L1122.0542,61 M1122.0542,49 L1139.0542,49" fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1151.0542" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="card"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="1122.6318" y="7258.5781">Card</text><path d="M1122.0542,7265.5313 L1122.0542,7289.5313 M1122.0542,7277.5313 L1139.0542,7277.5313" fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1151.0542" cy="7277.5313" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="sapi"><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="1367.0166" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="1374.0166" y="54.0469">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.4307" x="1406.8086" y="70.5352">API</text></g><g class="participant participant-tail" data-participant="sapi"><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="1367.0166" y="7245.043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="1374.0166" y="7265.5781">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.4307" x="1406.8086" y="7282.0664">API</text></g><g class="participant participant-head" data-participant="samReader"><rect fill="#90EE90" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.168" x="1478.0313" y="17.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.168" x="1485.0313" y="37.5586">Calypso SAM Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1551.9004" y="54.0469">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="39.498" x="1501.6836" y="70.5352">static</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.9355" x="1545.6113" y="70.5352">presence</text></g><g class="participant participant-tail" data-participant="samReader"><rect fill="#90EE90" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="152.168" x="1478.0313" y="7245.043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.168" x="1485.0313" y="7265.5781">Calypso SAM Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4.4297" x="1551.9004" y="7282.0664">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="39.498" x="1501.6836" y="7298.5547">static</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.9355" x="1545.6113" y="7298.5547">presence</text></g><g class="participant participant-head" data-participant="sam"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1798.8979" y="78.5352">SAM</text><path d="M1796.9053,37 L1796.9053,61 M1796.9053,49 L1813.9053,49" fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1825.9053" cy="49" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="sam"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1798.8979" y="7258.5781">SAM</text><path d="M1796.9053,7265.5313 L1796.9053,7289.5313 M1796.9053,7277.5313 L1813.9053,7277.5313" fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1825.9053" cy="7277.5313" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/></g><g><title>Ticketing Application</title><rect fill="#FFD700" height="7145.5547" style="stroke:#181818;stroke-width:1;" width="10" x="75.0166" y="91.4883"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="320.9727"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="197.1738" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="364.2832"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="995.7363"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="149.2422" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="1039.0469"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="360.0371" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="1396.4629"/></g><g><title>Reader API</title><rect fill="#FFC0CB" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="403.7148" y="1785.8105"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="715.3203"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="937.1152"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="59.9316" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="1844.4316"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2173.4688"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="450.8398" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2216.7793"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2769.8613"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="285.0371" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="2813.1719"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3367.9355"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="300.3477" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3411.2461"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3798.5254"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="315.6582" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="3841.8359"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4244.4258"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="330.9688" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4287.7363"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4736.2578"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="1937.8027" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="4779.5684"/></g><g><title>Calypso</title><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1;" width="10" x="600.3037" y="6873.3164"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="179.8633" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="1456.3945"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="221.6094" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="2355.457"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="2873.1035"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="3471.1777"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="3901.7676"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="4347.668"/></g><g><title>Calypso Card Reader</title><rect fill="#ADD8E6" height="762.1309" style="stroke:#181818;stroke-width:1;" width="10" x="868.9067" y="5548.3398"/></g><g><title>..Card..</title><rect fill="#ADD8E6" height="5584.7852" style="stroke:#181818;stroke-width:1;" width="10" x="1137.5542" y="1485.7051"/></g><g><title>Calypso SAM</title><rect fill="#90EE90" height="14" style="stroke:#181818;stroke-width:1;" width="10" x="1412.5239" y="262.3516"/></g><g><title>Calypso SAM</title><rect fill="#90EE90" height="44.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1412.5239" y="590.7676"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="72.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="424.2148"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="775.252"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="555.9766" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="4932.4316"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="6462.334"/></g><g><title>Calypso SAM Reader</title><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1549.1152" y="6933.248"/></g><g><title>..SAM..</title><rect fill="#90EE90" height="6783.5176" style="stroke:#181818;stroke-width:1;" width="10" x="1812.4053" y="453.5254"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1861.9053" x="0" y="112.1436"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="112.1436" y2="112.1436"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="115.1436" y2="115.1436"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="314.8091" x="773.5481" y="101.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296.5244" x="779.5481" y="118.0566">Access Control embedded Terminal settings</text><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="156.1094" y2="156.1094"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="156.1094" y2="169.1094"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="169.1094" y2="169.1094"/><polygon fill="#181818" points="96.0166,165.1094,86.0166,169.1094,96.0166,173.1094,92.0166,169.1094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2363" x="92.0166" y="151.3672">set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6104" x="116.3662" y="151.3672">Calypso SAM lib</text></g><polygon fill="#FFA500" points="1504,182.1094,1603,182.1094,1613,201.1094,1603,220.1094,1504,220.1094,1494,201.1094,1504,182.1094" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="1506" y="198.6777">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90.9365" x="1506" y="213.9883">Card Inserted</text><g class="message" data-participant-1="app" data-participant-2="sapi"><polygon fill="#181818" points="1400.5239,258.3516,1410.5239,262.3516,1400.5239,266.3516,1404.5239,262.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="1406.5239" y1="262.3516" y2="262.3516"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="242.2988">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7681" x="148.0537" y="242.2988">card selection:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.5103" x="124.9229" y="257.6094">- filter by Power-On data</text></g><g class="message" data-participant-1="sapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,272.3516,86.0166,276.3516,96.0166,280.3516,92.0166,276.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="1416.5239" y1="276.3516" y2="276.3516"/></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,316.9727,401.7148,320.9727,391.7148,324.9727,395.7148,320.9727" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="320.9727" y2="320.9727"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="300.9199">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.7192" x="148.0537" y="300.9199">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.9683" x="124.9229" y="316.2305">- legacy SAM selection</text></g><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,330.9727,86.0166,334.9727,96.0166,338.9727,92.0166,334.9727" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="407.7148" y1="334.9727" y2="334.9727"/></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,360.2832,401.7148,364.2832,391.7148,368.2832,395.7148,364.2832" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="364.2832" y2="364.2832"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="359.541">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.9854" x="148.1934" y="359.541">synchronous card selection scenario</text></g><g class="message" data-participant-1="rapi" data-participant-2="samReader"><polygon fill="#00FF00" points="1537.1152,420.2148,1547.1152,424.2148,1537.1152,428.2148,1541.1152,424.2148" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;" x1="413.7148" x2="1543.1152" y1="424.2148" y2="424.2148"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49.3403" x="420.7148" y="388.8516">SAM #x</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.7852" x="420.7148" y="404.1621">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.7837" x="453.6211" y="419.4727">- card selector</text></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,449.5254,1810.4053,453.5254,1800.4053,457.5254,1804.4053,453.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="453.5254" y2="453.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0859" x="1566.1152" y="448.7832">open card channel</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,463.5254,1560.1152,467.5254,1570.1152,471.5254,1566.1152,467.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="467.5254" y2="467.5254"/></g><g class="message" data-participant-1="samReader" data-participant-2="rapi"><polygon fill="#00FF00" points="424.7148,492.8359,414.7148,496.8359,424.7148,500.8359,420.7148,496.8359" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;stroke-dasharray:2,2;" x1="418.7148" x2="1553.1152" y1="496.8359" y2="496.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.915" x="430.7148" y="492.0938">receive selection response</text></g><path d="M1196,509.8359 L1196,534.8359 L1638,534.8359 L1638,519.8359 L1628,509.8359 L1196,509.8359" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1628,509.8359 L1628,519.8359 L1638,519.8359 L1628,509.8359" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421.9922" x="1202" y="527.4043">The SAM remains permanently selected between card transactions.</text><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,557.457,86.0166,561.457,96.0166,565.457,92.0166,561.457" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="407.7148" y1="561.457" y2="561.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.1816" x="102.0166" y="556.7148">selected active SmartCard image</text></g><g class="message" data-participant-1="app" data-participant-2="sapi"><polygon fill="#181818" points="1400.5239,586.7676,1410.5239,590.7676,1400.5239,594.7676,1404.5239,590.7676" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="1406.5239" y1="590.7676" y2="590.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.1807" x="92.0166" y="586.0254">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.6206" x="123.3105" y="586.0254">SAM card</text></g><g class="message" data-participant-1="sapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,631.3887,86.0166,635.3887,96.0166,639.3887,92.0166,635.3887" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="1416.5239" y1="635.3887" y2="635.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.894" x="102.0166" y="615.3359">[legacy SAM image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2983" x="134.9229" y="630.6465">- identification data]</text></g><path d="M1217,648.3887 L1217,688.3887 L1616,688.3887 L1616,658.3887 L1606,648.3887 L1217,648.3887" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1606,648.3887 L1606,658.3887 L1616,658.3887 L1606,648.3887" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.1045" x="1223" y="665.957">Apart from SAM module selection, a secure transaction with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="363.3018" x="1223" y="681.2676">a Calypso card is managed independently of the SAM API.</text><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,711.3203,598.3037,715.3203,588.3037,719.3203,592.3037,715.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="715.3203" y2="715.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.2612" x="92.0166" y="710.5781">init</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.7017" x="118.3911" y="710.5781">crypto context for next transaction</text></g><g class="message" data-participant-1="capi" data-participant-2="samReader"><polygon fill="#00FF00" points="1537.1152,771.252,1547.1152,775.252,1537.1152,779.252,1541.1152,775.252" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;" x1="610.3037" x2="1543.1152" y1="775.252" y2="775.252"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.5522" x="617.3037" y="739.8887">SAM #x'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="755.1992">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="770.5098">- APDU list</text></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,800.5625,1810.4053,804.5625,1800.4053,808.5625,1804.4053,804.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="804.5625" y2="804.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4048" x="1566.1152" y="799.8203">get challenge</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,829.873,1560.1152,833.873,1570.1152,837.873,1566.1152,833.873" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="833.873" y2="833.873"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="1576.1152" y="829.1309">[SAM challenge]</text></g><g class="message" data-participant-1="samReader" data-participant-2="capi"><polygon fill="#00FF00" points="621.3037,859.1836,611.3037,863.1836,621.3037,867.1836,617.3037,863.1836" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="1553.1152" y1="863.1836" y2="863.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="627.3037" y="858.4414">[SAM challenge]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,873.1836,86.0166,877.1836,96.0166,881.1836,92.0166,877.1836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="877.1836" y2="877.1836"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,933.1152,598.3037,937.1152,588.3037,941.1152,592.3037,937.1152" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="937.1152" y2="937.1152"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="901.752">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7681" x="148.0537" y="901.752">card selection:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.7852" x="124.9229" y="917.0625">- filter by specific AID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.1572" x="124.9229" y="932.373">- filter invalidated card status</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,947.1152,86.0166,951.1152,96.0166,955.1152,92.0166,951.1152" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="951.1152" y2="951.1152"/></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,991.7363,401.7148,995.7363,391.7148,999.7363,395.7148,995.7363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="995.7363" y2="995.7363"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="975.6836">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.7192" x="148.0537" y="975.6836">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.9214" x="124.9229" y="990.9941">- Calypso card selection</text></g><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1005.7363,86.0166,1009.7363,96.0166,1013.7363,92.0166,1009.7363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="407.7148" y1="1009.7363" y2="1009.7363"/></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,1035.0469,401.7148,1039.0469,391.7148,1043.0469,395.7148,1039.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="1039.0469" y2="1039.0469"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.4204" x="92.0166" y="1034.3047">schedule</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.1646" x="155.5503" y="1034.3047">asynchronous card selection scenario</text></g><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1049.0469,86.0166,1053.0469,96.0166,1057.0469,92.0166,1053.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="402.7148" y1="1053.0469" y2="1053.0469"/></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,1078.3574,401.7148,1082.3574,391.7148,1086.3574,395.7148,1082.3574" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="1082.3574" y2="1082.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.5435" x="92.0166" y="1077.6152">add</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.0332" x="119.6733" y="1077.6152">observer</text></g><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1092.3574,86.0166,1096.3574,96.0166,1100.3574,92.0166,1096.3574" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="402.7148" y1="1096.3574" y2="1096.3574"/></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,1121.668,401.7148,1125.668,391.7148,1129.668,395.7148,1125.668" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="1125.668" y2="1125.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.0967" x="92.0166" y="1120.9258">start detection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.2554" x="194.2266" y="1120.9258">- repeating mode</text></g><polygon fill="#FFA500" points="794,1138.668,952,1138.668,962,1157.668,952,1176.668,794,1176.668,784,1157.668,794,1138.668" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="796" y="1155.2363">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154.9082" x="796" y="1170.5469">Wait For Card Insertion</text><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1184.2891,86.0166,1188.2891,96.0166,1192.2891,92.0166,1188.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="407.7148" y1="1188.2891" y2="1188.2891"/></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="1217.5996" y2="1217.5996"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="1217.5996" y2="1230.5996"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="1230.5996" y2="1230.5996"/><polygon fill="#181818" points="96.0166,1226.5996,86.0166,1230.5996,96.0166,1234.5996,92.0166,1230.5996" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.355" x="92.0166" y="1212.8574">wait</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.2334" x="124.4849" y="1212.8574">for card presence</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1861.9053" x="0" y="1266.9102"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="1266.9102" y2="1266.9102"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="1269.9102" y2="1269.9102"/><rect fill="#EEEEEE" height="38.6211" style="stroke:#000000;stroke-width:2;" width="221.3208" x="820.2922" y="1248.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204.2549" x="826.2922" y="1265.168">Access Control operation start</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203.0361" x="826.2922" y="1280.4785">Card selection &amp; identification</text><g class="message" data-participant-1="cardReader" data-participant-2="cardReader"><polygon fill="#FFA500" points="884.9067,1314.5313,874.9067,1318.5313,884.9067,1322.5313,880.9067,1318.5313" style="stroke:#FFA500;stroke-width:1;"/><line style="stroke:#FFA500;stroke-width:1;" x1="878.9067" x2="1050.0376" y1="1318.5313" y2="1318.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.3394" x="890.9067" y="1313.7891">card</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.979" x="922.3594" y="1313.7891">insertion</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4727" x="990.5649" y="1313.7891">.  .  .  .  .</text></g><polygon fill="#FFA500" points="788,1331.5313,959,1331.5313,969,1350.5313,959,1369.5313,788,1369.5313,778,1350.5313,788,1331.5313" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="790" y="1348.0996">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="167.6099" x="790" y="1363.4102">Wait For Card Processing</text><g class="message" data-participant-1="cardReader" data-participant-2="rapi"><polygon fill="#FFA500" points="424.7148,1392.4629,414.7148,1396.4629,424.7148,1400.4629,420.7148,1396.4629" style="stroke:#FFA500;stroke-width:1;"/><line style="stroke:#FFA500;stroke-width:1;" x1="418.7148" x2="872.9067" y1="1396.4629" y2="1396.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.979" x="430.7148" y="1391.7207">insertion</text></g><g class="message" data-participant-1="rapi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,1452.3945,866.9067,1456.3945,856.9067,1460.3945,860.9067,1456.3945" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="413.7148" x2="862.9067" y1="1456.3945" y2="1456.3945"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.7148" y="1421.0313">Card #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.7852" x="420.7148" y="1436.3418">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.7837" x="453.6211" y="1451.6523">- card selector</text></g><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,1481.7051,1135.5542,1485.7051,1125.5542,1489.7051,1129.5542,1485.7051" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="1485.7051" y2="1485.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0859" x="885.9067" y="1480.9629">open card channel</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,1495.7051,879.9067,1499.7051,889.9067,1503.7051,885.9067,1499.7051" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="1499.7051" y2="1499.7051"/></g><polygon fill="#B0E0E6" points="1099,1512.7051,1185,1512.7051,1195,1531.7051,1185,1550.7051,1099,1550.7051,1089,1531.7051,1099,1512.7051" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2783" x="1101" y="1529.2734">card in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.896" x="1101" y="1544.584">ratified</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,1573.6367,1135.5542,1577.6367,1125.5542,1581.6367,1129.5542,1577.6367" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="1577.6367" y2="1577.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.7622" x="885.9067" y="1572.8945">select application (aid)</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,1602.9473,879.9067,1606.9473,889.9067,1610.9473,885.9067,1606.9473" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="1606.9473" y2="1606.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.6172" x="895.9067" y="1602.2051">[card FCI]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="rapi"><polygon fill="#0000FF" points="424.7148,1632.2578,414.7148,1636.2578,424.7148,1640.2578,420.7148,1636.2578" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="418.7148" x2="872.9067" y1="1636.2578" y2="1636.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.915" x="430.7148" y="1631.5156">receive selection response</text></g><g class="message" data-participant-1="rapi" data-participant-2="rapi"><line style="stroke:#181818;stroke-width:1;" x1="413.7148" x2="455.7148" y1="1665.5684" y2="1665.5684"/><line style="stroke:#181818;stroke-width:1;" x1="455.7148" x2="455.7148" y1="1665.5684" y2="1678.5684"/><line style="stroke:#181818;stroke-width:1;" x1="414.7148" x2="455.7148" y1="1678.5684" y2="1678.5684"/><polygon fill="#181818" points="424.7148,1674.5684,414.7148,1678.5684,424.7148,1682.5684,420.7148,1678.5684" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.5889" x="420.7148" y="1660.8262">checks invalidation status</text></g><rect fill="#D8BFD8" height="38" style="stroke:#181818;stroke-width:0.5;" width="377" x="418" y="1691.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369.6504" x="422" y="1708.1367">&#65039;&#9888;&#65039;if (card invalidated) &#8594; app not notified of card selection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.5801" x="422" y="1723.4473">close channel &amp; wait for card removal from reader</text><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1752.5,86.0166,1756.5,96.0166,1760.5,92.0166,1756.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="407.7148" y1="1756.5" y2="1756.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.3047" x="102.0166" y="1751.7578">notify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.0737" x="145.4346" y="1751.7578">scheduled card selections responsee</text></g><g class="message" data-participant-1="app" data-participant-2="rapi"><polygon fill="#181818" points="391.7148,1781.8105,401.7148,1785.8105,391.7148,1789.8105,395.7148,1785.8105" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="397.7148" y1="1785.8105" y2="1785.8105"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="37.1338" x="92.0166" y="1781.0684">parse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.8311" x="133.2637" y="1781.0684">scheduled card selections response</text></g><g class="message" data-participant-1="rapi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1811.1211,86.0166,1815.1211,96.0166,1819.1211,92.0166,1815.1211" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="407.7148" y1="1815.1211" y2="1815.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.1816" x="102.0166" y="1810.3789">selected active SmartCard image</text></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,1840.4316,598.3037,1844.4316,588.3037,1848.4316,592.3037,1844.4316" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="1844.4316" y2="1844.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.1807" x="92.0166" y="1839.6895">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.9707" x="123.3105" y="1839.6895">Calypso card</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,1900.3633,86.0166,1904.3633,96.0166,1908.3633,92.0166,1904.3633" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="1904.3633" y2="1904.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="1869">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="1884.3105">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.4854" x="134.9229" y="1899.6211">- invalidation status]</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="1948.9844" y2="1948.9844"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="1948.9844" y2="1961.9844"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="1961.9844" y2="1961.9844"/><polygon fill="#181818" points="96.0166,1957.9844,86.0166,1961.9844,96.0166,1965.9844,92.0166,1961.9844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.4614" x="92.0166" y="1928.9316">get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.3604" x="117.5913" y="1928.9316">card file structure reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.2095" x="92.0166" y="1944.2422">from card image</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1861.9053" x="0" y="1990.6396"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="1990.6396" y2="1990.6396"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="1993.6396" y2="1993.6396"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="177.8394" x="842.033" y="1979.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="159.5547" x="848.033" y="1996.5527">Card secure transaction</text><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="2065.2266" y2="2065.2266"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="2065.2266" y2="2078.2266"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="2078.2266" y2="2078.2266"/><polygon fill="#181818" points="96.0166,2074.2266,86.0166,2078.2266,96.0166,2082.2266,92.0166,2078.2266" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71.5889" x="92.0166" y="2029.8633">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.7642" x="167.7188" y="2029.8633">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1821" x="124.9229" y="2045.1738">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.0107" x="124.9229" y="2060.4844">- Calypso SAM resource</text></g><path d="M455,2091.2266 L455,2116.2266 L755,2116.2266 L755,2101.2266 L745,2091.2266 L455,2091.2266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M745,2091.2266 L745,2101.2266 L755,2101.2266 L745,2091.2266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.1191" x="461" y="2108.7949">Only reads ticketing data inside the session.</text><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,2169.4688,598.3037,2173.4688,588.3037,2177.4688,592.3037,2173.4688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="2173.4688" y2="2173.4688"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="2138.1055">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="2138.1055">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.1763" x="124.9229" y="2153.416">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8022" x="124.9229" y="2168.7266">- read environment file</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,2183.4688,86.0166,2187.4688,96.0166,2191.4688,92.0166,2187.4688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="2187.4688" y2="2187.4688"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,2212.7793,598.3037,2216.7793,588.3037,2220.7793,592.3037,2216.7793" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="2216.7793" y2="2216.7793"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="2212.0371">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="2212.0371">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="2212.0371">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="2212.0371">channel open)</text></g><g class="message" data-participant-1="capi" data-participant-2="capi"><line style="stroke:#00FF00;stroke-width:1;" x1="610.3037" x2="652.3037" y1="2282.5254" y2="2282.5254"/><line style="stroke:#00FF00;stroke-width:1;" x1="652.3037" x2="652.3037" y1="2282.5254" y2="2295.5254"/><line style="stroke:#00FF00;stroke-width:1;" x1="611.3037" x2="652.3037" y1="2295.5254" y2="2295.5254"/><polygon fill="#00FF00" points="621.3037,2291.5254,611.3037,2295.5254,621.3037,2299.5254,617.3037,2295.5254" style="stroke:#00FF00;stroke-width:1;"/><path d="M636.8037,2238.5293 C636.8037,2243.914 632.4384,2248.2793 627.0537,2248.2793 C621.669,2248.2793 617.3037,2243.914 617.3037,2238.5293 C617.3037,2233.1446 621.669,2228.7793 627.0537,2228.7793 C632.4384,2228.7793 636.8037,2233.1446 636.8037,2238.5293" fill="#FFCC4D"/><path d="M617.9754,2234.7474 C618.1054,2234.8768 618.7543,2235.2658 618.8838,2235.6547 C619.0138,2236.043 619.2738,2238.246 620.0527,2238.8944 C620.856,2239.5617 623.886,2239.3136 624.4662,2239.0244 C625.7645,2238.3771 625.9238,2236.5701 626.1535,2235.6547 C626.2829,2235.1363 627.0618,2235.1363 627.0618,2235.1363 C627.0618,2235.1363 627.8408,2235.1363 627.9708,2235.6541 C628.2004,2236.5701 628.3608,2238.3771 629.658,2239.0238 C630.2387,2239.3136 633.2688,2239.5623 634.0732,2238.8949 C634.851,2238.2465 635.1105,2236.0436 635.2405,2235.6547 C635.3694,2235.2663 636.0194,2234.8774 636.1488,2234.7479 C636.2794,2234.6185 636.2794,2234.1001 636.1488,2233.9701 C635.8894,2233.7112 632.8263,2233.4804 629.528,2233.8406 C628.8699,2233.9127 628.6197,2234.0995 627.0613,2234.0995 C625.504,2234.0995 625.2527,2233.9121 624.5951,2233.8406 C621.299,2233.4799 618.2354,2233.7106 617.9754,2233.9695 C617.8459,2234.099 617.8459,2234.6179 617.9754,2234.7474" fill="#292F33"/><path d="M632.1102,2241.5783 C632.0138,2241.4911 631.8697,2241.4857 631.7662,2241.5626 C631.7451,2241.5783 629.6418,2243.1335 627.0537,2243.1335 C624.4721,2243.1335 622.3618,2241.5783 622.3412,2241.5626 C622.2378,2241.4857 622.0937,2241.4922 621.9973,2241.5783 C621.9014,2241.665 621.8797,2241.808 621.9463,2241.9185 C622.0162,2242.035 623.6889,2244.7585 627.0537,2244.7585 C630.4185,2244.7585 632.0918,2242.035 632.1611,2241.9185 C632.2277,2241.8075 632.2066,2241.665 632.1102,2241.5783" fill="#664500"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.9766" x="640.917" y="2247.1621">SAM challenge already known</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.8677" x="617.3037" y="2262.4727">no need to request it during</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.3057" x="617.3037" y="2277.7832">the card transaction</text></g><g class="message" data-participant-1="capi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,2351.457,866.9067,2355.457,856.9067,2359.457,860.9067,2355.457" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="610.3037" x2="862.9067" y1="2355.457" y2="2355.457"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="617.3037" y="2320.0938">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="2335.4043">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="2350.7148">- APDU list</text></g><path d="M634,2370.457 L928.8818,2370.457 L928.8818,2377.7676 L918.8818,2387.7676 L634,2387.7676 L634,2370.457" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="162.9883" style="stroke:#000000;stroke-width:1.5;" width="543.0542" x="634" y="2370.457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="649" y="2384.0254">Card APDU commands inside session</text><path d="M644,2392.7676 L644,2423.7676 L1103,2423.7676 L1103,2402.7676 L1093,2392.7676 L644,2392.7676" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1093,2392.7676 L1093,2402.7676 L1103,2402.7676 L1093,2392.7676" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M669.5,2407.5176 C669.5,2412.9023 665.1347,2417.2676 659.75,2417.2676 C654.3653,2417.2676 650,2412.9023 650,2407.5176 C650,2402.1329 654.3653,2397.7676 659.75,2397.7676 C665.1347,2397.7676 669.5,2402.1329 669.5,2407.5176" fill="#FFCC4D"/><path d="M650.6717,2403.7357 C650.8017,2403.8651 651.4506,2404.254 651.58,2404.643 C651.71,2405.0313 651.97,2407.2343 652.749,2407.8827 C653.5523,2408.55 656.5823,2408.3019 657.1625,2408.0127 C658.4608,2407.3654 658.6201,2405.5584 658.8498,2404.643 C658.9792,2404.1246 659.7581,2404.1246 659.7581,2404.1246 C659.7581,2404.1246 660.537,2404.1246 660.667,2404.6424 C660.8967,2405.5584 661.057,2407.3654 662.3543,2408.0121 C662.935,2408.3019 665.9651,2408.5505 666.7695,2407.8832 C667.5473,2407.2348 667.8068,2405.0319 667.9368,2404.643 C668.0657,2404.2546 668.7157,2403.8657 668.8451,2403.7362 C668.9757,2403.6067 668.9757,2403.0884 668.8451,2402.9584 C668.5857,2402.6995 665.5225,2402.4687 662.2243,2402.8289 C661.5662,2402.901 661.316,2403.0878 659.7576,2403.0878 C658.2003,2403.0878 657.949,2402.9004 657.2914,2402.8289 C653.9953,2402.4682 650.9317,2402.6989 650.6717,2402.9578 C650.5422,2403.0873 650.5422,2403.6062 650.6717,2403.7357" fill="#292F33"/><path d="M664.8065,2410.5666 C664.71,2410.4794 664.566,2410.474 664.4625,2410.5509 C664.4414,2410.5666 662.3381,2412.1217 659.75,2412.1217 C657.1684,2412.1217 655.0581,2410.5666 655.0375,2410.5509 C654.934,2410.474 654.79,2410.4805 654.6935,2410.5666 C654.5977,2410.6533 654.576,2410.7963 654.6426,2410.9068 C654.7125,2411.0232 656.3852,2413.7467 659.75,2413.7467 C663.1148,2413.7467 664.788,2411.0232 664.8574,2410.9068 C664.924,2410.7957 664.9029,2410.6533 664.8065,2410.5666" fill="#664500"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.0542" x="673.6133" y="2416.1504">Optimization: environment file read through the session opening.</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,2476.8242,1135.5542,2480.8242,1125.5542,2484.8242,1129.5542,2480.8242" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="2480.8242" y2="2480.8242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.6772" x="885.9067" y="2445.4609">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4751" x="918.813" y="2460.7715">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.5337" x="918.813" y="2476.082">SFI environment to read)</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,2521.4453,879.9067,2525.4453,889.9067,2529.4453,885.9067,2525.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="2525.4453" y2="2525.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.5581" x="895.9067" y="2505.3926">[card challenge &amp; ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.2227" x="904.1333" y="2520.7031">environment data]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="capi"><polygon fill="#0000FF" points="621.3037,2573.0664,611.3037,2577.0664,621.3037,2581.0664,617.3037,2577.0664" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="872.9067" y1="2577.0664" y2="2577.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.5581" x="627.3037" y="2557.0137">[card challenge &amp; ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.2227" x="635.5303" y="2572.3242">environment data]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,2663.6191,86.0166,2667.6191,96.0166,2671.6191,92.0166,2667.6191" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="2667.6191" y2="2667.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="2601.6348">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="2616.9453">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="2632.2559">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="2647.5664">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.3691" x="134.9229" y="2662.877">- ratification status]</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="2712.2402" y2="2712.2402"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="2712.2402" y2="2725.2402"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="2725.2402" y2="2725.2402"/><polygon fill="#181818" points="96.0166,2721.2402,86.0166,2725.2402,96.0166,2729.2402,92.0166,2725.2402" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.4614" x="92.0166" y="2692.1875">get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.022" x="117.5913" y="2692.1875">ticketing environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.2095" x="92.0166" y="2707.498">from card image</text></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,2765.8613,598.3037,2769.8613,588.3037,2773.8613,592.3037,2769.8613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="2769.8613" y2="2769.8613"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="2749.8086">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="2749.8086">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.3555" x="124.9229" y="2765.1191">- read last event</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,2779.8613,86.0166,2783.8613,96.0166,2787.8613,92.0166,2783.8613" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="2783.8613" y2="2783.8613"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,2809.1719,598.3037,2813.1719,588.3037,2817.1719,592.3037,2813.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="2813.1719" y2="2813.1719"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="2808.4297">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="2808.4297">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="2808.4297">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="2808.4297">channel open)</text></g><g class="message" data-participant-1="capi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,2869.1035,866.9067,2873.1035,856.9067,2877.1035,860.9067,2873.1035" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="610.3037" x2="862.9067" y1="2873.1035" y2="2873.1035"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="617.3037" y="2837.7402">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="2853.0508">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="2868.3613">- APDU list</text></g><path d="M786.4727,2888.1035 L1081.3545,2888.1035 L1081.3545,2895.4141 L1071.3545,2905.4141 L786.4727,2905.4141 L786.4727,2888.1035" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="2888.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="801.4727" y="2901.6719">Card APDU commands inside session</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,2922.7246,1135.5542,2926.7246,1125.5542,2930.7246,1129.5542,2926.7246" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="2926.7246" y2="2926.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.9961" x="885.9067" y="2921.9824">read record (last event)</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,2952.0352,879.9067,2956.0352,889.9067,2960.0352,885.9067,2956.0352" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="2956.0352" y2="2956.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6548" x="895.9067" y="2951.293">[last event data]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="capi"><polygon fill="#0000FF" points="621.3037,2988.3457,611.3037,2992.3457,621.3037,2996.3457,617.3037,2992.3457" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="872.9067" y1="2992.3457" y2="2992.3457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6548" x="627.3037" y="2987.6035">[last event data]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,3094.209,86.0166,3098.209,96.0166,3102.209,92.0166,3098.209" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="3098.209" y2="3098.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="3016.9141">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="3032.2246">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="3047.5352">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="3062.8457">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="3078.1563">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0625" x="134.9229" y="3093.4668">- last event data]</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="3142.8301" y2="3142.8301"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="3142.8301" y2="3155.8301"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="3155.8301" y2="3155.8301"/><polygon fill="#181818" points="96.0166,3151.8301,86.0166,3155.8301,96.0166,3159.8301,92.0166,3155.8301" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.4614" x="92.0166" y="3122.7773">get</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.2266" x="117.5913" y="3122.7773">ticketing last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.2095" x="92.0166" y="3138.0879">from card image</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="3200.4512" y2="3200.4512"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="3200.4512" y2="3213.4512"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="3213.4512" y2="3213.4512"/><polygon fill="#181818" points="96.0166,3209.4512,86.0166,3213.4512,96.0166,3217.4512,92.0166,3213.4512" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.957" x="92.0166" y="3180.3984">anti-passback management</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.1196" x="92.0166" y="3195.709">&amp; communication failure recovery</text></g><rect fill="#D8BFD8" height="99" style="stroke:#181818;stroke-width:0.5;" width="414" x="90" y="3226.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.8354" x="94" y="3243.0195">&#65039;&#9888;&#65039;if (last event occurred shorter than the anti-pass delay)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="340.4502" x="94" y="3258.3301">&amp;&amp; (card status is ratified) &#8594; decline card transaction,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.5801" x="94" y="3273.6406">close channel &amp; wait for card removal from reader</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="94" y="3288.9512">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.8354" x="94" y="3304.2617">&#65039;&#9888;&#65039;if (last event occurred shorter than the anti-pass delay)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.1738" x="94" y="3319.5723">&amp;&amp; (card status is none-ratified) &#8594; manage recovery transaction</text><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,3363.9355,598.3037,3367.9355,588.3037,3371.9355,592.3037,3367.9355" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="3367.9355" y2="3367.9355"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="3347.8828">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="3347.8828">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.3838" x="124.9229" y="3363.1934">- read contract list</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,3377.9355,86.0166,3381.9355,96.0166,3385.9355,92.0166,3381.9355" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="3381.9355" y2="3381.9355"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,3407.2461,598.3037,3411.2461,588.3037,3415.2461,592.3037,3411.2461" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="3411.2461" y2="3411.2461"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="3406.5039">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="3406.5039">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="3406.5039">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="3406.5039">channel open)</text></g><g class="message" data-participant-1="capi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,3467.1777,866.9067,3471.1777,856.9067,3475.1777,860.9067,3471.1777" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="610.3037" x2="862.9067" y1="3471.1777" y2="3471.1777"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="617.3037" y="3435.8145">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="3451.125">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="3466.4355">- APDU list</text></g><path d="M786.4727,3486.1777 L1081.3545,3486.1777 L1081.3545,3493.4883 L1071.3545,3503.4883 L786.4727,3503.4883 L786.4727,3486.1777" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="3486.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="801.4727" y="3499.7461">Card APDU commands inside session</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,3520.7988,1135.5542,3524.7988,1125.5542,3528.7988,1129.5542,3524.7988" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="3524.7988" y2="3524.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.0244" x="885.9067" y="3520.0566">read record (contract list)</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,3550.1094,879.9067,3554.1094,889.9067,3558.1094,885.9067,3554.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="3554.1094" y2="3554.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.6831" x="895.9067" y="3549.3672">[contract list data]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="capi"><polygon fill="#0000FF" points="621.3037,3586.4199,611.3037,3590.4199,621.3037,3594.4199,617.3037,3590.4199" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="872.9067" y1="3590.4199" y2="3590.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.6831" x="627.3037" y="3585.6777">[contract list data]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,3707.5938,86.0166,3711.5938,96.0166,3715.5938,92.0166,3711.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="3711.5938" y2="3711.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="3614.9883">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="3630.2988">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="3645.6094">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="3660.9199">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="3676.2305">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.835" x="134.9229" y="3691.541">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.0908" x="134.9229" y="3706.8516">- contract list data]</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="3740.9043" y2="3740.9043"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="3740.9043" y2="3753.9043"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="3753.9043" y2="3753.9043"/><polygon fill="#181818" points="96.0166,3749.9043,86.0166,3753.9043,96.0166,3757.9043,92.0166,3753.9043" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.9849" x="92.0166" y="3736.1621">identifies contract</text></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,3794.5254,598.3037,3798.5254,588.3037,3802.5254,592.3037,3798.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="3798.5254" y2="3798.5254"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="3778.4727">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="3778.4727">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.5718" x="124.9229" y="3793.7832">- read contract #x</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,3808.5254,86.0166,3812.5254,96.0166,3816.5254,92.0166,3812.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="3812.5254" y2="3812.5254"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,3837.8359,598.3037,3841.8359,588.3037,3845.8359,592.3037,3841.8359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="3841.8359" y2="3841.8359"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="3837.0938">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="3837.0938">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="3837.0938">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="3837.0938">channel open)</text></g><g class="message" data-participant-1="capi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,3897.7676,866.9067,3901.7676,856.9067,3905.7676,860.9067,3901.7676" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="610.3037" x2="862.9067" y1="3901.7676" y2="3901.7676"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="617.3037" y="3866.4043">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="3881.7148">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="3897.0254">- APDU list</text></g><path d="M786.4727,3916.7676 L1081.3545,3916.7676 L1081.3545,3924.0781 L1071.3545,3934.0781 L786.4727,3934.0781 L786.4727,3916.7676" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="3916.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="801.4727" y="3930.3359">Card APDU commands inside session</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,3951.3887,1135.5542,3955.3887,1125.5542,3959.3887,1129.5542,3955.3887" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="3955.3887" y2="3955.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.2124" x="885.9067" y="3950.6465">read record (contract #x)</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,3980.6992,879.9067,3984.6992,889.9067,3988.6992,885.9067,3984.6992" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="3984.6992" y2="3984.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8711" x="895.9067" y="3979.957">[contract #x data]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="capi"><polygon fill="#0000FF" points="621.3037,4017.0098,611.3037,4021.0098,621.3037,4025.0098,617.3037,4021.0098" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="872.9067" y1="4021.0098" y2="4021.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8711" x="627.3037" y="4016.2676">[contract #x data]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,4153.4941,86.0166,4157.4941,96.0166,4161.4941,92.0166,4157.4941" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="4157.4941" y2="4157.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="4045.5781">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="4060.8887">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="4076.1992">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="4091.5098">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="4106.8203">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.835" x="134.9229" y="4122.1309">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="4137.4414">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.2788" x="134.9229" y="4152.752">- contract #x data]</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="4186.8047" y2="4186.8047"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="4186.8047" y2="4199.8047"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="4199.8047" y2="4199.8047"/><polygon fill="#181818" points="96.0166,4195.8047,86.0166,4199.8047,96.0166,4203.8047,92.0166,4199.8047" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.0098" x="92.0166" y="4182.0625">identifies associated counter</text></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,4240.4258,598.3037,4244.4258,588.3037,4248.4258,592.3037,4244.4258" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="4244.4258" y2="4244.4258"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="4224.373">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="4224.373">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.7441" x="124.9229" y="4239.6836">- reader counter #x</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,4254.4258,86.0166,4258.4258,96.0166,4262.4258,92.0166,4258.4258" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="4258.4258" y2="4258.4258"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,4283.7363,598.3037,4287.7363,588.3037,4291.7363,592.3037,4287.7363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="4287.7363" y2="4287.7363"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="4282.9941">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="4282.9941">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="4282.9941">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="4282.9941">channel open)</text></g><g class="message" data-participant-1="capi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,4343.668,866.9067,4347.668,856.9067,4351.668,860.9067,4347.668" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="610.3037" x2="862.9067" y1="4347.668" y2="4347.668"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="617.3037" y="4312.3047">Card #6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="4327.6152">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="4342.9258">- APDU list</text></g><path d="M786.4727,4362.668 L1081.3545,4362.668 L1081.3545,4369.9785 L1071.3545,4379.9785 L786.4727,4379.9785 L786.4727,4362.668" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="390.5815" x="786.4727" y="4362.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="801.4727" y="4376.2363">Card APDU commands inside session</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,4397.2891,1135.5542,4401.2891,1125.5542,4405.2891,1129.5542,4401.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="4401.2891" y2="4401.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.8228" x="885.9067" y="4396.5469">read record (counter #x)</text></g><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,4426.5996,879.9067,4430.5996,889.9067,4434.5996,885.9067,4430.5996" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="4430.5996" y2="4430.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.729" x="895.9067" y="4425.8574">[counter #1 data]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="capi"><polygon fill="#0000FF" points="621.3037,4462.9102,611.3037,4466.9102,621.3037,4470.9102,617.3037,4466.9102" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="872.9067" y1="4466.9102" y2="4466.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9883" x="627.3037" y="4462.168">[card challenge]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,4614.7051,86.0166,4618.7051,96.0166,4622.7051,92.0166,4618.7051" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="4618.7051" y2="4618.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="4491.4785">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="4506.7891">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="4522.0996">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="4537.4102">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="4552.7207">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.835" x="134.9229" y="4568.0313">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="4583.3418">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0513" x="134.9229" y="4598.6523">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.8892" x="134.9229" y="4613.9629">- counter #x data]</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="4648.0156" y2="4648.0156"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="4648.0156" y2="4661.0156"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="4661.0156" y2="4661.0156"/><polygon fill="#181818" points="96.0166,4657.0156,86.0166,4661.0156,96.0166,4665.0156,92.0166,4661.0156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.2065" x="92.0166" y="4643.2734">defines data to update</text></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,4732.2578,598.3037,4736.2578,588.3037,4740.2578,592.3037,4736.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="4736.2578" y2="4736.2578"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="4685.584">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="143.9404" y="4685.584">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.938" x="124.9229" y="4700.8945">- decrease counter #x (new value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.9023" x="124.9229" y="4716.2051">- append event record (new event)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.9043" x="124.9229" y="4731.5156">- close secure session (not ratified)</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,4746.2578,86.0166,4750.2578,96.0166,4754.2578,92.0166,4750.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="4750.2578" y2="4750.2578"/></g><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,4775.5684,598.3037,4779.5684,588.3037,4783.5684,592.3037,4779.5684" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="4779.5684" y2="4779.5684"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="4774.8262">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="4774.8262">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="34.417" x="225.5078" y="4774.8262">close</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.7661" x="264.0381" y="4774.8262">channel after)</text></g><g class="message" data-participant-1="capi" data-participant-2="capi"><line style="stroke:#181818;stroke-width:1;" x1="610.3037" x2="652.3037" y1="4808.8789" y2="4808.8789"/><line style="stroke:#181818;stroke-width:1;" x1="652.3037" x2="652.3037" y1="4808.8789" y2="4821.8789"/><line style="stroke:#181818;stroke-width:1;" x1="611.3037" x2="652.3037" y1="4821.8789" y2="4821.8789"/><polygon fill="#181818" points="621.3037,4817.8789,611.3037,4821.8789,621.3037,4825.8789,617.3037,4821.8789" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.603" x="617.3037" y="4804.1367">anticipates the future card responses</text></g><path d="M247,4834.8789 L247,4874.8789 L961,4874.8789 L961,4844.8789 L951,4834.8789 L247,4834.8789" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M951,4834.8789 L951,4844.8789 L961,4844.8789 L951,4834.8789" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.2744" x="253" y="4852.4473">If the current value of the counter #x were</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="61.896" x="524.3877" y="4852.4473">unknown</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319.6108" x="586.2837" y="4852.4473">, then the transmission of an additional card APDU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.856" x="253" y="4867.7578">message would be necessary to operate the decrease counter in a different message than the session closing.</text><g class="message" data-participant-1="capi" data-participant-2="samReader"><polygon fill="#00FF00" points="1537.1152,4928.4316,1547.1152,4932.4316,1537.1152,4936.4316,1541.1152,4932.4316" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;" x1="610.3037" x2="1543.1152" y1="4932.4316" y2="4932.4316"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="617.3037" y="4897.0684">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="4912.3789">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="4927.6895">- APDU list</text></g><path d="M1315,4945.4316 L1315,4976.4316 L1791,4976.4316 L1791,4955.4316 L1781,4945.4316 L1315,4945.4316" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1781,4945.4316 L1781,4955.4316 L1791,4955.4316 L1781,4945.4316" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1340.5,4960.1816 C1340.5,4965.5663 1336.1347,4969.9316 1330.75,4969.9316 C1325.3653,4969.9316 1321,4965.5663 1321,4960.1816 C1321,4954.7969 1325.3653,4950.4316 1330.75,4950.4316 C1336.1347,4950.4316 1340.5,4954.7969 1340.5,4960.1816" fill="#FFCC4D"/><path d="M1321.6717,4956.3997 C1321.8017,4956.5292 1322.4506,4956.9181 1322.58,4957.307 C1322.71,4957.6954 1322.97,4959.8983 1323.749,4960.5467 C1324.5523,4961.2141 1327.5823,4960.966 1328.1625,4960.6767 C1329.4608,4960.0294 1329.6201,4958.2224 1329.8498,4957.307 C1329.9792,4956.7886 1330.7581,4956.7886 1330.7581,4956.7886 C1330.7581,4956.7886 1331.537,4956.7886 1331.667,4957.3065 C1331.8967,4958.2224 1332.057,4960.0294 1333.3543,4960.6762 C1333.935,4960.966 1336.9651,4961.2146 1337.7695,4960.5473 C1338.5473,4959.8989 1338.8068,4957.6959 1338.9368,4957.307 C1339.0657,4956.9186 1339.7157,4956.5297 1339.8451,4956.4003 C1339.9757,4956.2708 1339.9757,4955.7524 1339.8451,4955.6224 C1339.5857,4955.3635 1336.5225,4955.1328 1333.2243,4955.493 C1332.5662,4955.565 1332.316,4955.7519 1330.7576,4955.7519 C1329.2003,4955.7519 1328.949,4955.5645 1328.2914,4955.493 C1324.9953,4955.1322 1321.9317,4955.363 1321.6717,4955.6219 C1321.5422,4955.7513 1321.5422,4956.2703 1321.6717,4956.3997" fill="#292F33"/><path d="M1335.8065,4963.2307 C1335.71,4963.1435 1335.566,4963.1381 1335.4625,4963.215 C1335.4414,4963.2307 1333.3381,4964.7858 1330.75,4964.7858 C1328.1684,4964.7858 1326.0581,4963.2307 1326.0375,4963.215 C1325.934,4963.1381 1325.79,4963.1446 1325.6935,4963.2307 C1325.5977,4963.3173 1325.576,4963.4603 1325.6426,4963.5708 C1325.7125,4963.6873 1327.3852,4966.4108 1330.75,4966.4108 C1334.1148,4966.4108 1335.788,4963.6873 1335.8574,4963.5708 C1335.924,4963.4598 1335.9029,4963.3173 1335.8065,4963.2307" fill="#664500"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.9453" x="1344.6133" y="4968.8145">All card session data managed within a single SAM command group.</text><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,4998.8672,1810.4053,5002.8672,1800.4053,5006.8672,1804.4053,5002.8672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5002.8672" y2="5002.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.124" x="1566.1152" y="4998.125">select diversifier (card serial)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5012.8672,1560.1152,5016.8672,1570.1152,5020.8672,1566.1152,5016.8672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5016.8672" y2="5016.8672"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5042.1777,1810.4053,5046.1777,1800.4053,5050.1777,1804.4053,5046.1777" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5046.1777" y2="5046.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="1566.1152" y="5041.4355">digest init (opening data)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5056.1777,1560.1152,5060.1777,1570.1152,5064.1777,1566.1152,5060.1777" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5060.1777" y2="5060.1777"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5085.4883,1810.4053,5089.4883,1800.4053,5093.4883,1804.4053,5089.4883" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5089.4883" y2="5089.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.6914" x="1566.1152" y="5084.7461">digest update (read environment)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5099.4883,1560.1152,5103.4883,1570.1152,5107.4883,1566.1152,5103.4883" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5103.4883" y2="5103.4883"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5128.7988,1810.4053,5132.7988,1800.4053,5136.7988,1804.4053,5132.7988" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5132.7988" y2="5132.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.8594" x="1566.1152" y="5128.0566">digest update (last event)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5142.7988,1560.1152,5146.7988,1570.1152,5150.7988,1566.1152,5146.7988" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5146.7988" y2="5146.7988"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5172.1094,1810.4053,5176.1094,1800.4053,5180.1094,1804.4053,5176.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5176.1094" y2="5176.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.9243" x="1566.1152" y="5171.3672">digest update (read contract list)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5186.1094,1560.1152,5190.1094,1570.1152,5194.1094,1566.1152,5190.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5190.1094" y2="5190.1094"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5215.4199,1810.4053,5219.4199,1800.4053,5223.4199,1804.4053,5219.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5219.4199" y2="5219.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.1123" x="1566.1152" y="5214.6777">digest update (read contract #x)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5229.4199,1560.1152,5233.4199,1570.1152,5237.4199,1566.1152,5233.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5233.4199" y2="5233.4199"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5258.7305,1810.4053,5262.7305,1800.4053,5266.7305,1804.4053,5262.7305" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5262.7305" y2="5262.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0435" x="1566.1152" y="5257.9883">digest update (read counters)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5272.7305,1560.1152,5276.7305,1570.1152,5280.7305,1566.1152,5276.7305" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5276.7305" y2="5276.7305"/></g><path d="M1468.0313,5291.7305 L1761.7515,5291.7305 L1761.7515,5304.8555 L1751.7515,5314.8555 L1468.0313,5314.8555 L1468.0313,5291.7305" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.7461" style="stroke:#000000;stroke-width:1.5;" width="383.874" x="1468.0313" y="5291.7305"/><path d="M1502.5313,5302.4805 C1502.5313,5307.8652 1498.166,5312.2305 1492.7813,5312.2305 C1487.3965,5312.2305 1483.0313,5307.8652 1483.0313,5302.4805 C1483.0313,5297.0958 1487.3965,5292.7305 1492.7813,5292.7305 C1498.166,5292.7305 1502.5313,5297.0958 1502.5313,5302.4805" fill="#FFCC4D"/><path d="M1483.7029,5298.6986 C1483.8329,5298.828 1484.4818,5299.2169 1484.6113,5299.6058 C1484.7413,5299.9942 1485.0013,5302.1972 1485.7802,5302.8456 C1486.5835,5303.5129 1489.6136,5303.2648 1490.1937,5302.9756 C1491.4921,5302.3283 1491.6513,5300.5213 1491.881,5299.6058 C1492.0105,5299.0875 1492.7894,5299.0875 1492.7894,5299.0875 C1492.7894,5299.0875 1493.5683,5299.0875 1493.6983,5299.6053 C1493.928,5300.5213 1494.0883,5302.3283 1495.3856,5302.975 C1495.9663,5303.2648 1498.9963,5303.5134 1499.8007,5302.8461 C1500.5785,5302.1977 1500.838,5299.9948 1500.968,5299.6058 C1501.0969,5299.2175 1501.7469,5298.8286 1501.8764,5298.6991 C1502.0069,5298.5696 1502.0069,5298.0513 1501.8764,5297.9213 C1501.6169,5297.6623 1498.5538,5297.4316 1495.2556,5297.7918 C1494.5975,5297.8638 1494.3472,5298.0507 1492.7888,5298.0507 C1491.2315,5298.0507 1490.9802,5297.8633 1490.3226,5297.7918 C1487.0266,5297.4311 1483.9629,5297.6618 1483.7029,5297.9207 C1483.5735,5298.0502 1483.5735,5298.5691 1483.7029,5298.6986" fill="#292F33"/><path d="M1497.8377,5305.5295 C1497.7413,5305.4423 1497.5972,5305.4369 1497.4938,5305.5138 C1497.4726,5305.5295 1495.3693,5307.0846 1492.7813,5307.0846 C1490.1997,5307.0846 1488.0893,5305.5295 1488.0688,5305.5138 C1487.9653,5305.4369 1487.8212,5305.4434 1487.7248,5305.5295 C1487.6289,5305.6162 1487.6073,5305.7592 1487.6739,5305.8697 C1487.7438,5305.9861 1489.4164,5308.7096 1492.7813,5308.7096 C1496.1461,5308.7096 1497.8193,5305.9861 1497.8886,5305.8697 C1497.9553,5305.7586 1497.9341,5305.6162 1497.8377,5305.5295" fill="#664500"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4.2847" x="1502.5313" y="5311.1133">&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="74.5786" x="1506.8159" y="5311.1133">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.0723" x="1585.6792" y="5311.1133">Card APDU responses</text><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5332.166,1810.4053,5336.166,1800.4053,5340.166,1804.4053,5336.166" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5336.166" y2="5336.166"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.1875" x="1566.1152" y="5331.4238">digest update (decrease counter)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5346.166,1560.1152,5350.166,1570.1152,5354.166,1566.1152,5350.166" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5350.166" y2="5350.166"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5375.4766,1810.4053,5379.4766,1800.4053,5383.4766,1804.4053,5379.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5379.4766" y2="5379.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.29" x="1566.1152" y="5374.7344">digest update (append event record)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5389.4766,1560.1152,5393.4766,1570.1152,5397.4766,1566.1152,5393.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5393.4766" y2="5393.4766"/></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,5425.7871,1810.4053,5429.7871,1800.4053,5433.7871,1804.4053,5429.7871" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="5429.7871" y2="5429.7871"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1626" x="1566.1152" y="5425.0449">digest close</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,5455.0977,1560.1152,5459.0977,1570.1152,5463.0977,1566.1152,5459.0977" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="5459.0977" y2="5459.0977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="1576.1152" y="5454.3555">[SAM certificate]</text></g><g class="message" data-participant-1="samReader" data-participant-2="capi"><polygon fill="#00FF00" points="621.3037,5484.4082,611.3037,5488.4082,621.3037,5492.4082,617.3037,5488.4082" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="1553.1152" y1="5488.4082" y2="5488.4082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="627.3037" y="5483.666">[SAM certificate]</text></g><g class="message" data-participant-1="capi" data-participant-2="cardReader"><polygon fill="#0000FF" points="856.9067,5544.3398,866.9067,5548.3398,856.9067,5552.3398,860.9067,5548.3398" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="610.3037" x2="862.9067" y1="5548.3398" y2="5548.3398"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="617.3037" y="5512.9766">Card #7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="5528.2871">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="5543.5977">- APDU list</text></g><path d="M786.4727,5563.3398 L1081.3545,5563.3398 L1081.3545,5570.6504 L1071.3545,5580.6504 L786.4727,5580.6504 L786.4727,5563.3398" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="247.1055" style="stroke:#000000;stroke-width:1.5;" width="440.9497" x="786.4727" y="5563.3398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="801.4727" y="5576.9082">Card APDU commands inside session</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,5597.9609,1135.5542,5601.9609,1125.5542,5605.9609,1129.5542,5601.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="5601.9609" y2="5601.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.5405" x="885.9067" y="5597.2188">decrease counter (counter #1, value)</text></g><rect fill="#7FFFD4" height="53" style="stroke:#181818;stroke-width:0.5;" width="150" x="1067" y="5614.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4224" x="1071" y="5631.5293">data update is delayed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.5532" x="1071" y="5646.8398">in the volatile card's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.5957" x="1071" y="5662.1504">modification buffer</text><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,5691.2031,879.9067,5695.2031,889.9067,5699.2031,885.9067,5695.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="5695.2031" y2="5695.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.189" x="895.9067" y="5690.4609">[new counter value]</text></g><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,5720.5137,1135.5542,5724.5137,1125.5542,5728.5137,1129.5542,5724.5137" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="5724.5137" y2="5724.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1987" x="885.9067" y="5719.7715">append record (event, data)</text></g><rect fill="#7FFFD4" height="53" style="stroke:#181818;stroke-width:0.5;" width="150" x="1067" y="5737.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4224" x="1071" y="5754.082">data update is delayed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.5532" x="1071" y="5769.3926">in the volatile card's</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.5957" x="1071" y="5784.7031">modification buffer</text><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,5798.4453,879.9067,5802.4453,889.9067,5806.4453,885.9067,5802.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="5802.4453" y2="5802.4453"/></g><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,5850.0664,1135.5542,5854.0664,1125.5542,5858.0664,1129.5542,5854.0664" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="5854.0664" y2="5854.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.6475" x="885.9067" y="5834.0137">close secure session (SAM certificate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13.8062" x="890.02" y="5849.3242">as</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.5767" x="907.9395" y="5849.3242">non-ratified</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="990.5161" y="5849.3242">)</text></g><g class="message" data-participant-1="card" data-participant-2="card"><line style="stroke:#181818;stroke-width:1;" x1="1147.5542" x2="1189.5542" y1="5898.6875" y2="5898.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1189.5542" x2="1189.5542" y1="5898.6875" y2="5911.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1148.5542" x2="1189.5542" y1="5911.6875" y2="5911.6875"/><polygon fill="#181818" points="1158.5542,5907.6875,1148.5542,5911.6875,1158.5542,5915.6875,1154.5542,5911.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.4971" x="1154.5542" y="5878.6348">if the SAM certificate is authenticated,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.9697" x="1154.5542" y="5893.9453">data updates are commited atomically</text></g><rect fill="#7FFFD4" height="38" style="stroke:#181818;stroke-width:0.5;" width="199" x="1042" y="5924.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3652" x="1046" y="5941.2559">card data is updated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.8135" x="1046" y="5956.5664">modification buffer is emptied</text><polygon fill="#B0E0E6" points="1099,5973.3086,1185,5973.3086,1195,5992.3086,1185,6011.3086,1099,6011.3086,1089,5992.3086,1099,5973.3086" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2783" x="1101" y="5989.877">card in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.5767" x="1101" y="6005.1875">non-ratified</text><rect fill="#D8BFD8" height="84" style="stroke:#181818;stroke-width:0.5;" width="355" x="777" y="6021.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.2813" x="781" y="6038.498">&#9888;&#65039; very short period during which a RF communication</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.0713" x="781" y="6053.8086">loss could allow card data to be updated without the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.7271" x="781" y="6069.1191">terminal being able to get the card certificate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.481" x="781" y="6084.4297">&#8594; if this happens, a recovery transaction will need</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.7866" x="781" y="6099.7402">to be managed afterward</text><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,6128.793,879.9067,6132.793,889.9067,6136.793,885.9067,6132.793" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="6132.793" y2="6132.793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="895.9067" y="6128.0508">[card certificate]</text></g><path d="M641,6145.793 L641,6176.793 L1105,6176.793 L1105,6155.793 L1095,6145.793 L641,6145.793" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1095,6145.793 L1095,6155.793 L1105,6155.793 L1095,6145.793" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M666.5,6160.543 C666.5,6165.9277 662.1347,6170.293 656.75,6170.293 C651.3653,6170.293 647,6165.9277 647,6160.543 C647,6155.1583 651.3653,6150.793 656.75,6150.793 C662.1347,6150.793 666.5,6155.1583 666.5,6160.543" fill="#FFCC4D"/><path d="M647.6717,6156.7611 C647.8017,6156.8905 648.4506,6157.2794 648.58,6157.6683 C648.71,6158.0567 648.97,6160.2597 649.749,6160.9081 C650.5523,6161.5754 653.5823,6161.3273 654.1625,6161.0381 C655.4608,6160.3908 655.6201,6158.5838 655.8498,6157.6683 C655.9792,6157.15 656.7581,6157.15 656.7581,6157.15 C656.7581,6157.15 657.537,6157.15 657.667,6157.6678 C657.8967,6158.5838 658.057,6160.3908 659.3543,6161.0375 C659.935,6161.3273 662.9651,6161.5759 663.7695,6160.9086 C664.5473,6160.2602 664.8068,6158.0573 664.9368,6157.6683 C665.0657,6157.28 665.7157,6156.8911 665.8451,6156.7616 C665.9757,6156.6321 665.9757,6156.1138 665.8451,6155.9838 C665.5857,6155.7248 662.5225,6155.4941 659.2243,6155.8543 C658.5662,6155.9263 658.316,6156.1132 656.7576,6156.1132 C655.2003,6156.1132 654.949,6155.9258 654.2914,6155.8543 C650.9953,6155.4936 647.9317,6155.7243 647.6717,6155.9832 C647.5422,6156.1127 647.5422,6156.6316 647.6717,6156.7611" fill="#292F33"/><path d="M661.8065,6163.592 C661.71,6163.5048 661.566,6163.4994 661.4625,6163.5763 C661.4414,6163.592 659.3381,6165.1471 656.75,6165.1471 C654.1684,6165.1471 652.0581,6163.592 652.0375,6163.5763 C651.934,6163.4994 651.79,6163.5059 651.6935,6163.592 C651.5977,6163.6787 651.576,6163.8217 651.6426,6163.9322 C651.7125,6164.0486 653.3852,6166.7721 656.75,6166.7721 C660.1148,6166.7721 661.788,6164.0486 661.8574,6163.9322 C661.924,6163.8211 661.9029,6163.6787 661.8065,6163.592" fill="#664500"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9102" x="670.6133" y="6169.1758">ratification command immediately performed after session closing</text><g class="message" data-participant-1="cardReader" data-participant-2="card"><polygon fill="#181818" points="1125.5542,6199.2285,1135.5542,6203.2285,1125.5542,6207.2285,1129.5542,6203.2285" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="878.9067" x2="1131.5542" y1="6203.2285" y2="6203.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.6274" x="885.9067" y="6198.4863">ratification command</text></g><polygon fill="#B0E0E6" points="1099,6216.2285,1185,6216.2285,1195,6235.2285,1185,6254.2285,1099,6254.2285,1089,6235.2285,1099,6216.2285" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2783" x="1101" y="6232.7969">card in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.896" x="1101" y="6248.1074">ratified</text><g class="message" data-participant-1="card" data-participant-2="cardReader"><polygon fill="#181818" points="889.9067,6277.1602,879.9067,6281.1602,889.9067,6285.1602,885.9067,6281.1602" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="883.9067" x2="1136.5542" y1="6281.1602" y2="6281.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21.436" x="895.9067" y="6276.418">ack</text></g><g class="message" data-participant-1="cardReader" data-participant-2="capi"><polygon fill="#0000FF" points="621.3037,6306.4707,611.3037,6310.4707,621.3037,6314.4707,617.3037,6310.4707" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="872.9067" y1="6310.4707" y2="6310.4707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="627.3037" y="6305.7285">[card certificate]</text></g><polygon fill="#FFA500" points="795,6323.4707,950,6323.4707,960,6342.4707,950,6361.4707,795,6361.4707,785,6342.4707,795,6323.4707" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="797" y="6340.0391">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.9248" x="797" y="6355.3496">Wait For Card Removal</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1861.9053" x="0" y="6387.7471"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="6387.7471" y2="6387.7471"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="6390.7471" y2="6390.7471"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="279.8779" x="791.0137" y="6377.0918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="261.5933" x="797.0137" y="6393.6602">End of the contactless card transaction</text><g class="message" data-participant-1="capi" data-participant-2="samReader"><polygon fill="#00FF00" points="1537.1152,6458.334,1547.1152,6462.334,1537.1152,6466.334,1541.1152,6462.334" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;" x1="610.3037" x2="1543.1152" y1="6462.334" y2="6462.334"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="617.3037" y="6426.9707">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="6442.2813">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="6457.5918">- APDU list</text></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,6487.6445,1810.4053,6491.6445,1800.4053,6495.6445,1804.4053,6491.6445" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="6491.6445" y2="6491.6445"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.2842" x="1566.1152" y="6486.9023">digest authenticate (card certificate)</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,6516.9551,1560.1152,6520.9551,1570.1152,6524.9551,1566.1152,6520.9551" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="6520.9551" y2="6520.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4131" x="1576.1152" y="6516.2129">[authentication status]</text></g><g class="message" data-participant-1="samReader" data-participant-2="capi"><polygon fill="#00FF00" points="621.3037,6546.2656,611.3037,6550.2656,621.3037,6554.2656,617.3037,6550.2656" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="1553.1152" y1="6550.2656" y2="6550.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9507" x="627.3037" y="6545.5234">[authentification status]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,6713.3711,86.0166,6717.3711,96.0166,6721.3711,92.0166,6717.3711" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="6717.3711" y2="6717.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="6574.834">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="6590.1445">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="6605.4551">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="6620.7656">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="134.9229" y="6636.0762">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="line-through" textLength="110.5063" x="146.5581" y="6636.0762">ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.3018" x="134.9229" y="6651.3867">- last event data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="6666.6973">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0513" x="134.9229" y="6682.0078">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.356" x="134.9229" y="6697.3184">- counter #x data (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4956" x="102.0166" y="6712.6289">authentification status</text></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="6752.4961" y2="6752.4961"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="6752.4961" y2="6765.4961"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="6765.4961" y2="6765.4961"/><polygon fill="#181818" points="96.0166,6761.4961,86.0166,6765.4961,96.0166,6769.4961,92.0166,6765.4961" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.4629" x="92.0166" y="6747.7539">card successfully authenticated</text><ellipse cx="297.4868" cy="6744.2669" fill="#CCD6DD" rx="0.8125" ry="0.8125" style="stroke:#CCD6DD;stroke-width:1;"/><path d="M298.7976,6736.5395 C298.8253,6736.4111 298.841,6736.2784 298.841,6736.1419 C298.841,6735.0949 297.9922,6734.2461 296.9451,6734.2461 C295.9896,6734.2461 295.2075,6734.9546 295.0764,6735.8738 C295.0672,6735.8738 295.0585,6735.8711 295.0493,6735.8711 C294.4513,6735.8711 293.966,6736.3564 293.966,6736.9544 C293.966,6737.5524 294.4513,6738.0378 295.0493,6738.0378 C295.0672,6738.0378 295.0834,6738.0334 295.1008,6738.0323 C295.0694,6738.119 295.0493,6738.2111 295.0493,6738.3086 C295.0493,6738.5578 295.1641,6738.7782 295.3413,6738.9277 C295.1614,6739.1211 295.0493,6739.3778 295.0493,6739.6628 C295.0493,6740.2608 295.5346,6740.7461 296.1326,6740.7461 C296.1326,6740.9492 296.1922,6741.1366 296.2892,6741.2991 C295.8954,6741.3549 295.591,6741.6908 295.591,6742.1003 C295.591,6742.5488 295.955,6742.9128 296.4035,6742.9128 C296.852,6742.9128 297.216,6742.5488 297.216,6742.1003 C297.216,6742.0028 297.1959,6741.9107 297.1645,6741.824 C297.1819,6741.8251 297.1981,6741.8294 297.216,6741.8294 C297.814,6741.8294 298.2993,6741.3441 298.2993,6740.7461 C298.2993,6740.4206 298.1531,6740.1324 297.9256,6739.9336 C298.1525,6739.7348 298.2993,6739.4466 298.2993,6739.1211 C298.2993,6738.9163 298.2392,6738.7268 298.1401,6738.5632 C298.1926,6738.5713 298.2446,6738.5794 298.2993,6738.5794 C298.8973,6738.5794 299.3826,6738.0941 299.3826,6737.4961 C299.3826,6737.0785 299.1438,6736.7204 298.7976,6736.5395" fill="#CCD6DD"/><ellipse cx="296.6743" cy="6739.6628" fill="#E4EBEF" rx="0.5417" ry="0.5417" style="stroke:#E4EBEF;stroke-width:1;"/><path d="M298.2993,6736.4128 C298.2993,6735.8142 297.8145,6735.3294 297.216,6735.3294 C296.6174,6735.3294 296.1326,6735.8142 296.1326,6736.4128 C296.1326,6736.4301 296.137,6736.4469 296.1381,6736.4642 C296.0514,6736.4328 295.9593,6736.4128 295.8618,6736.4128 C295.4128,6736.4128 295.0493,6736.7762 295.0493,6737.2253 C295.0493,6737.6743 295.4128,6738.0378 295.8618,6738.0378 C295.9691,6738.0378 296.0704,6738.0161 296.1641,6737.9782 C296.2572,6738.3238 296.5698,6738.5794 296.9451,6738.5794 C297.3942,6738.5794 297.7576,6738.216 297.7576,6737.7669 C297.7576,6737.6326 297.7219,6737.508 297.6645,6737.3964 C298.0382,6737.2258 298.2993,6736.851 298.2993,6736.4128" fill="#E4EBEF"/><path d="M297.5475,6731.0373 C297.1049,6730.605 297.1049,6730.605 297.0746,6730.5812 C297.2008,6730.2464 297.1634,6729.8938 296.9392,6729.6647 C296.5996,6729.331 295.9869,6729.4003 295.5655,6729.8218 L294.4166,6730.9706 C293.9958,6731.3915 293.9259,6732.0047 294.2596,6732.3443 C294.4887,6732.568 294.8408,6732.6059 295.1761,6732.4797 C295.2004,6732.5095 295.6321,6732.9526 295.6321,6732.9526 C296.0552,6733.3751 296.7409,6733.3751 297.164,6732.9526 L297.5469,6732.5691 C297.97,6732.1461 297.97,6731.4603 297.5475,6731.0373" fill="#C1694F"/><path d="M297.2366,6731.5296 C297.2886,6731.4776 297.4505,6731.3065 297.6174,6731.1234 C297.5941,6731.0947 297.574,6731.0643 297.5469,6731.0373 C297.5469,6731.0373 297.1044,6730.605 297.0741,6730.5812 C297.0134,6730.7426 296.9175,6730.9008 296.7805,6731.0373 L295.6327,6732.1861 C295.4956,6732.3232 295.3375,6732.4191 295.1761,6732.4797 C295.2004,6732.5095 295.6321,6732.9526 295.6321,6732.9526 C295.6587,6732.9791 295.6896,6732.9992 295.7183,6733.023 C295.8759,6732.8816 296.0346,6732.7321 296.0877,6732.6796 L297.2366,6731.5296" fill="#A95233"/><path d="M312.4969,6742.2557 L309.7523,6739.5111 C307.7676,6737.5264 305.7862,6737.2686 301.9751,6735.7492 L300.2694,6737.4549 C302.0195,6741.0353 302.0222,6743.2719 304.0069,6745.2566 L306.752,6748.0017 C307.2899,6748.5396 307.72,6748.9821 308.2589,6748.4437 L312.8138,6743.8872 C313.3533,6743.3477 313.0348,6742.7936 312.4969,6742.2557" fill="#264612"/><path d="M302.3705,6735.9599 C303.3124,6736.3088 303.3124,6736.3088 302.0671,6737.5541 C300.9177,6738.7035 300.4871,6737.9067 300.4871,6737.9067 L298.62,6736.0396 L300.5353,6734.1242 L302.3705,6735.9599" fill="#FFE8B6"/><path d="M300.7016,6734.2911 L300.1524,6733.7413 L298.237,6735.6561 L298.7863,6736.2058 C299.3247,6736.7437 299.2299,6736.7773 300.2184,6735.7888 L300.5391,6735.4676 C301.3202,6734.6859 301.2395,6734.8289 300.7016,6734.2911" fill="#FFD983"/><path d="M300.3436,6733.1666 C300.661,6733.484 300.661,6733.9986 300.343,6734.316 L298.8117,6735.8473 C298.4943,6736.1652 297.9797,6736.1652 297.6623,6735.8473 C297.3449,6735.5304 297.3449,6735.0153 297.6623,6734.6978 L299.1936,6733.1666 C299.5116,6732.8497 300.0261,6732.8491 300.3436,6733.1666" fill="#264612"/><path d="M308.9615,6740.2526 C308.5384,6739.8301 307.8521,6739.8301 307.4291,6740.2526 L304.7484,6742.9339 C304.3254,6743.3564 304.3254,6744.0427 304.7484,6744.4657 L307.0461,6746.7635 C307.4692,6747.1865 308.1555,6747.1865 308.5785,6746.7635 L311.2592,6744.0828 C311.6823,6743.6597 311.6823,6742.9734 311.2592,6742.5509 L308.9615,6740.2526" fill="#FFE8B6"/></g><g class="message" data-participant-1="app" data-participant-2="app"><polygon fill="#181818" points="331.9106,6796.6953,341.9106,6800.6953,331.9106,6804.6953,335.9106,6800.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="337.9106" y1="6800.6953" y2="6800.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.8999" x="92.0166" y="6795.9531">notification &amp;</text><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="145.8809" x="181.0298" y="6794.8984">access granting</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1861.9053" x="0" y="6829.3506"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="6829.3506" y2="6829.3506"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="6832.3506" y2="6832.3506"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="252.1006" x="804.9023" y="6818.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="233.8159" x="810.9023" y="6835.2637">End of the Access Control opertion</text><g class="message" data-participant-1="app" data-participant-2="capi"><polygon fill="#181818" points="588.3037,6869.3164,598.3037,6873.3164,588.3037,6877.3164,592.3037,6873.3164" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="594.3037" y1="6873.3164" y2="6873.3164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.2612" x="92.0166" y="6868.5742">init</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.7017" x="118.3911" y="6868.5742">crypto context for next transaction</text></g><g class="message" data-participant-1="capi" data-participant-2="samReader"><polygon fill="#00FF00" points="1537.1152,6929.248,1547.1152,6933.248,1537.1152,6937.248,1541.1152,6933.248" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;" x1="610.3037" x2="1543.1152" y1="6933.248" y2="6933.248"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.5522" x="617.3037" y="6897.8848">SAM #x'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="617.3037" y="6913.1953">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="650.21" y="6928.5059">- APDU list</text></g><g class="message" data-participant-1="samReader" data-participant-2="sam"><polygon fill="#181818" points="1800.4053,6958.5586,1810.4053,6962.5586,1800.4053,6966.5586,1804.4053,6962.5586" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1559.1152" x2="1806.4053" y1="6962.5586" y2="6962.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4048" x="1566.1152" y="6957.8164">get challenge</text></g><g class="message" data-participant-1="sam" data-participant-2="samReader"><polygon fill="#181818" points="1570.1152,6987.8691,1560.1152,6991.8691,1570.1152,6995.8691,1566.1152,6991.8691" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1564.1152" x2="1811.4053" y1="6991.8691" y2="6991.8691"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="1576.1152" y="6987.127">[SAM challenge]</text></g><g class="message" data-participant-1="samReader" data-participant-2="capi"><polygon fill="#00FF00" points="621.3037,7017.1797,611.3037,7021.1797,621.3037,7025.1797,617.3037,7021.1797" style="stroke:#00FF00;stroke-width:1;"/><line style="stroke:#00FF00;stroke-width:1;stroke-dasharray:2,2;" x1="615.3037" x2="1553.1152" y1="7021.1797" y2="7021.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="627.3037" y="7016.4375">[SAM challenge]</text></g><g class="message" data-participant-1="capi" data-participant-2="app"><polygon fill="#181818" points="96.0166,7031.1797,86.0166,7035.1797,96.0166,7039.1797,92.0166,7035.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="90.0166" x2="604.3037" y1="7035.1797" y2="7035.1797"/></g><g class="message" data-participant-1="app" data-participant-2="app"><line style="stroke:#181818;stroke-width:1;" x1="85.0166" x2="127.0166" y1="7064.4902" y2="7064.4902"/><line style="stroke:#181818;stroke-width:1;" x1="127.0166" x2="127.0166" y1="7064.4902" y2="7077.4902"/><line style="stroke:#181818;stroke-width:1;" x1="86.0166" x2="127.0166" y1="7077.4902" y2="7077.4902"/><polygon fill="#181818" points="96.0166,7073.4902,86.0166,7077.4902,96.0166,7081.4902,92.0166,7077.4902" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.355" x="92.0166" y="7059.748">wait</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="124.4849" y="7059.748">for card removal</text></g><line style="stroke:#A80036;stroke-width:2;" x1="1133.5542" x2="1151.5542" y1="7068.4902" y2="7086.4902"/><line style="stroke:#A80036;stroke-width:2;" x1="1133.5542" x2="1151.5542" y1="7086.4902" y2="7068.4902"/><g class="message" data-participant-1="cardReader" data-participant-2="cardReader"><polygon fill="#FFA500" points="884.9067,7102.8008,874.9067,7106.8008,884.9067,7110.8008,880.9067,7106.8008" style="stroke:#FFA500;stroke-width:1;"/><line style="stroke:#FFA500;stroke-width:1;" x1="878.9067" x2="1044.0771" y1="7106.8008" y2="7106.8008"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.3394" x="890.9067" y="7102.0586">card</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.0186" x="922.3594" y="7102.0586">removal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4727" x="984.6045" y="7102.0586">.  .  .  .  .</text></g><polygon fill="#FFA500" points="794,7119.8008,952,7119.8008,962,7138.8008,952,7157.8008,794,7157.8008,784,7138.8008,794,7119.8008" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="796" y="7136.3691">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154.9082" x="796" y="7151.6797">Wait For Card Insertion</text><g class="message" data-participant-1="cardReader" data-participant-2="rapi"><polygon fill="#FFA500" points="419.7148,7180.7324,409.7148,7184.7324,419.7148,7188.7324,415.7148,7184.7324" style="stroke:#FFA500;stroke-width:1;"/><line style="stroke:#FFA500;stroke-width:1;" x1="413.7148" x2="872.9067" y1="7184.7324" y2="7184.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.0186" x="425.7148" y="7179.9902">removal</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1861.9053" x="0" y="7213.3877"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="7213.3877" y2="7213.3877"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1861.9053" y1="7216.3877" y2="7216.3877"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="226.1831" x="817.8611" y="7202.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="207.8984" x="823.8611" y="7219.3008">ready for next card transaction</text><!--SRC=[xLhDRjmu4hxhAOWOSEo6UyPsd77IiBrezy_0XqM2J1PxY7rWI-nkmXAb8ILtUXvWhmliSK_x6FiyymBx2bj5KXBrqt-sCvi4EyW4QQd8-c7zV2pLItNFHK8bZSWWf4fTnp9WSX27iIHxuvF1sV7OMqSoFEiFZeSEYKgPP76wJ5Y_GjX_EnmCnws4DnN2wxF- -UXrA-6WkkDmU79zsaeugX2Ehj- -ghAUqo1US34ZKnegvZclVabfojPhsFTJ_i3JPHkLzv9yO473OjI_dyau4u6clhYGBBYw0liEHyFHO8rz2yhH-TdWrS2Ryu2H_66fBd1zdyaaP1iP9vfCypuR3SRdQtcNn6z6PsVzOSw-U5wHO19cc_aZaTRdUlnwVBsMUqxwwkpjc-5rpji-hN3-MJ8cDhAU8PNctH_tnoThUHUqfwF1uFmaPvu_ThW3-tUIYjbcrMDDPevzV3fwkrQ0adZqq_dez3INe7XU5G4iiDp604kZ_sWm6ctINvEU3bwDNXyxwYzhhAcVWlU_-CZzUvPYGFMJ9EG-JNaiNX2g24qIiZUBmy03NYdtUK95IbvyO1IuaVxx6qqbQSB9NiB5VPLiGCDbek9RCQ0oAAXzJHtosJozHgThMqBq2iFcLjoAJYTO2XfnlzCXYMIA2P_PpMHWfN6sdA3Tg5oI5vqExjJf5CGREV_I__Ejo6LLfQp6JLSjgSYg80irHLKqgaXgDdH5XNsif41ReSAJuW-GsvmJULayQr1VNaAQyvbIP12BLCOXOT641G4Bo4Sc8oveI1HBySWLkRo4xPEaUmL_zGX8pr8GtTKjv1FFcuiOMCKF8B-ZYOqUQNvoGL1trlECtScDK4oc30x0OoBGMrXcQDaUkPY2VCH7jxt4jDZfWCd0ngpJkVWHtrsPGrCiP3vwPGyid7R9b8VWncIo9E_Z1PFTTu84DAMUOn8uk8fHy4bNA-a5h49d9PAFauWedmagUMn52zcC-ajjjuAcb4iQkNIio5Q9f9PeaqWndcufabeAVovZ4MTgbNXhPFYqTtmy7XyVtrqL9rlbQZAdTb2ozxbWUmk-HOMAUEhma-pNZAdK6CEH9PRkwRI5WbSyHlU8UYHEc31R-7Cg10kzbIuFlxlTKdntBqSzOq_9VCOVM4LcbSJWgbNFAFPoFHyEXy1_7-TC7x5a4UL2aGJ2YWecqd1fzuLOcx1qmN8LjAcevgT-m6WW9XeSD-YLIxKOm2A2VACZYKTqnff-uiHIf-DJXQ6BSY7BxQAXHpuvBglPM4-6iY5IFhNrG0VONJDsMepJnon9fZAEz9vH76IXO-uZGk67dqdc6eKiU3hNoscHVBJXk29WMX0B_Ya21ZuH63l7KvBQOu1yxTfKMyMtLk62erLykKnIs18Sbtq6wQ3m2Vo78q9fCDync2uLdl-8G7dP5YbQfqgGzDyF_m8vLgMR0gGU7pEMOcI48TC8fXe2SAxQ4VBtTyxoGe_SIdNIzZZmMnEMxoGi_vcokagOZvv7-ZV3oZik7cZ8mHN16ymUK6yojURarWdzd7c_uhDFoFnhPLB-d64mbKBHfwL-8uJBb0O114qyWS8DGGs5sw5po3JAWIWFM6guGOXrmQyJHZMIXA1d5T3W8hNLgE6l549a3B7fm0UzkOCVNC7RpMUHp8BgoCTGrvR9uLWRG89Q8qsUqtfPp5hQSh-U3X4sbJfTVB9AtNN_H7g67QQUGdv2Vd3_FDaqxmq405DNR5DkrIqaAaxC4SVR00SmFznTbRjLdL5Vuop4spjvEXveH_6kCbgKjOYW3kxnTxVhgD0mETa3y0Wl2lAAkT4Rfhm6NPiI6MKGbkSN9t90UN3Ov0zPLZCP3sxkAZiv1jy5eBYQwNEpgo55-FUgp9JMfp5BIcq0YJQobxQFSwWx8VF-y- -___xFVy7VV4eEh2sAJ7j8Vl_RF_JD0zRZ_zemM7zhoSuFOyNoeu6GmG0imm-mKWnx6c1W71nDA-jHZQwgcImXRFAC5zHugS8cRCSS2abTEGbqCuDDwVEniCslmZQtW6nLpy2Xga1fFNQpBvfkSRUYCDgZcEdxeEO0HHYyCfMPdo9waspA92RKMw7Fj9H2PrYRGHj0htxXXBIKmdsQ0_kQ6TnbRMKMJYZE9F9tNnbSRjwu-DJFyUax0UWH7L2Hj6Xze8d0EWgR9GWh5MRNM5IW-YCmJbC3dSEiMImJSZ0SNTzy1FVHDIba3omyDDGe9c7YWKE9Z-1CzHay1Uxuszuf_JW2t0qsEkXqxXbBq0biPACAXpkWPSkpfp8nmsuLKxqhKe6SX8QewPBSYtWXReM80Pr3G05YjmM4G2e9CWb71MLcpXhMzHokErIlqqTZz1L52vjs2R4TBrXKcD7wbZrohwtyQ- -icUbTalA8_wO3jjVm1ECVAG30R3Pt_LQV4HZBzL_SVKLDhVkZja309c2CUxOyGYDKpiiy6TzK1DA7HQ7svOnQwrzvvll455dVpKQtWbGsDTTEK69LpRGtcCVllQAcFd-YDI_g0jWuRqgxLLuk4rXptqPIVfRyfJqEt3CbaAP4-ktaeXsomgl_LLPe3r5jSa25CIm_A4s_Ej1AcgtZfx7aQmqBssPTA-wcMAcjRePAkHYHIJU1R3oX_htjHA6Gjs9Vds8cSl6cb8S65lcOrvTU1M_hndqht7Q4YNr8mn03HCrZYVsE5BnSf_L23CZA8LqUUllxDaiRgs2RBB-o6BmUC3_aebaeZnu1qx-Gm28Mh5kLsXYui66bmfUNXUTBPDWFbF2u4SRVJIux-ufpMSNwQt23IxOz8cXPzKqbDTipsQH6DTdbGZ9LhFmYyRBt-RkCbjVVGhJiVTuYLlO-xnufnPhl8avgpzkLMnazKBfYdvil3N4cKjJ_sU88htrcq-yra7xwgWCfD_swEB8q9u-yWdxNGPG_pUsuER82DWKqgaoVBOr9bc1lUSUGihO1Q0ldYHYs5E10i0K1osJCTivWOsnz60tpaqSYStUo6cWeNEz-O9kxWAKR0-FPmrCBvSGddOAEXvkoXEM5k1i7b5AmDUBmQQPxjNc_L7UqLLjNzCPyJjTu7gJLfio_iJjsNZ3OhTF9XExKTJf7I60Wlmrpst-QWYZuDP6Zvy5zmiyZLtEBG7i4-eiu2t5IWWY61i59A70EypNED68RXyrXMnBmgMu-fyLEnSqZFqOqOwq3zeYl-2VF_17VQvcZQklxzSCm_o9XrD61aqz2uB24jWDg69eX2Ej2H2TAL-lwt83zPXLm44AXaylyPiOaf-5XOvgcla70PxeZAy0K1xRHgENRUgc9Vd9GRs_ll87R3NaCxzeDv4bRO3bvt0RQiLLpjQbvDSzePfCoveCoevILiWnxzBCD4jN3xJ1VL15iYurQyc_xNbXOL-obC-6goHRybgqh6vJQpSCjBlMQyPOTKSxvruLo6hcoX3edHxOwwgMo_Ycy_sj68ogXHEltnAGRUvRSDd5OO5zoasaVuX2gP6YKUQdiooWEIiGnoJ1FwpT5-sOLvCBYdCkhPRrReQPrhRoeQnSxiWdewzIkWHwj9ktue-QmHxS2XuBngxZebdC9TiR0xiJBQJXdAIf7CwpGgVuTm5wExl0IiG7u6DUVhzCu0h8mN6vfHlEPI7yvLNRBOBMTa8X5ISejKTdFssaoesg5SZh3Y1kogOt0ejjgEfT4znDrdnB7DNaSsE-9P37d_XngwOTnjQFhmU5W5mKH2XWbNZZw0aW1q69LrkKupb8y0I_D9wmd33Ud4_0WeCPXlUAxfND27dOzzU61TURQinLEIBPrG84Fe0ByCEeP_ZaSq0XnWOC3XKrNVt-hvCrjFqDMhX4vqk1Hn0Ay8eTBDEaqbb4kJ1s5LK1OutBMildJftLQB43z-zgCbCtstUeTRaMnM3DCjElyrWVJPQzC5rrUaf48IimjKk0SuaH0lPDWfyzs1hEdNtWYrPPjD-DOQEcOzB2be3iht0-WQyjwlcRTPzFMwTK_ujhTxRPSlBlTrgitER1vvF0PBk7bPdUtOeM9rjtJpKKWqvCeqmnAGRL-G5w0QscKq9bWlIkp3YSUpLIOvR9FBXJ_ZVLEtY0uDKCjCuae5SSLBtx4brTrVsyPoAoE2_r_eFkF7EXUDqXhFn5wzTm8lnKStjBys3GTA_CK-DopiUrZmsj7OmjPj5UQKQJ2ezgoxty1]--></g></svg>