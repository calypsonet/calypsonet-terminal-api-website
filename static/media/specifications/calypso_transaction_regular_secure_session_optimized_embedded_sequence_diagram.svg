<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="6497px" preserveAspectRatio="none" style="width:1545px;height:6497px;background:#FFFFFF;" version="1.1" viewBox="0 0 1545 6497" width="1545px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="6316.0645" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.0166" y="91.4883"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="272.3516"/><rect fill="#FFC0CB" height="197.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="315.6621"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="947.1152"/><rect fill="#FFC0CB" height="149.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="990.4258"/><rect fill="#FFC0CB" height="262.7949" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="1332.5313"/><rect fill="#FFC0CB" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="1624.6367"/><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="666.6992"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="888.4941"/><rect fill="#ADD8E6" height="59.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="1683.2578"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="1954.6738"/><rect fill="#ADD8E6" height="511.1504" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="1997.9844"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="2553.7559"/><rect fill="#ADD8E6" height="285.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="2597.0664"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="2969.0352"/><rect fill="#ADD8E6" height="300.3477" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3012.3457"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3399.625"/><rect fill="#ADD8E6" height="315.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3442.9355"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3845.5254"/><rect fill="#ADD8E6" height="330.9688" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3888.8359"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="4337.3574"/><rect fill="#ADD8E6" height="1550.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="4380.668"/><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="6043.8262"/><rect fill="#ADD8E6" height="173.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="1392.4629"/><rect fill="#ADD8E6" height="190.9883" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="2136.6621"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="2656.998"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="3072.2773"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="3502.8672"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="3948.7676"/><rect fill="#ADD8E6" height="466.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="5149.4395"/><rect fill="#ADD8E6" height="4819.2266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1030.1665" y="1421.7734"/><rect fill="#90EE90" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1115.1738" y="213.7305"/><rect fill="#90EE90" height="44.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="1115.1738" y="542.1465"/><rect fill="#90EE90" height="72.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="375.5938"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="726.6309"/><rect fill="#90EE90" height="555.9766" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="4533.5313"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="5676.1543"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="6103.7578"/><rect fill="#90EE90" height="6002.6484" style="stroke:#181818;stroke-width:1.0;" width="10" x="1489.4785" y="404.9043"/><rect fill="none" height="147.6777" style="stroke:#000000;stroke-width:1.5;" width="543.6665" x="526" y="2151.6621"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="2671.998"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="3087.2773"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="3517.8672"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="3963.7676"/><rect fill="none" height="109.7461" style="stroke:#000000;stroke-width:1.5;" width="358.2974" x="1170.6812" y="4892.8301"/><rect fill="none" height="119.2422" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="5164.4395"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="80" x2="80" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="408.4229" x2="408.4229" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="497.0068" x2="497.0068" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="765.6616" x2="765.6616" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1034.6665" x2="1034.6665" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1119.6665" x2="1119.6665" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1230.6812" x2="1230.6812" y1="81.4883" y2="6416.5527"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1493.9785" x2="1493.9785" y1="81.4883" y2="6416.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="78.5352">Ticketing Application</text><ellipse cx="80.0166" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,21.5 L80.0166,48.5 M67.0166,29.5 L93.0166,29.5 M80.0166,48.5 L67.0166,63.5 M80.0166,48.5 L93.0166,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="6429.0879">Ticketing Application</text><ellipse cx="80.0166" cy="6440.541" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,6448.541 L80.0166,6475.541 M67.0166,6456.541 L93.0166,6456.541 M80.0166,6475.541 L67.0166,6490.541 M80.0166,6475.541 L93.0166,6490.541 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86.584" x="365.4229" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.584" x="372.4229" y="70.5352">Reader API</text><rect fill="#FFC0CB" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86.584" x="365.4229" y="6415.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.584" x="372.4229" y="6436.0879">Reader API</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="462.0068" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="471.2524" y="54.0469">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="469.0068" y="70.5352">Card API</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="462.0068" y="6415.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="471.2524" y="6436.0879">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="469.0068" y="6452.5762">Card API</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.7148" x="714.6616" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.7148" x="721.6616" y="54.0469">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="743.1572" y="70.5352">Reader</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.7148" x="714.6616" y="6415.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.7148" x="721.6616" y="6436.0879">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="743.1572" y="6452.5762">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="1015.2441" y="78.5352">Card</text><path d="M1014.6665,37 L1014.6665,61 M1014.6665,49 L1031.6665,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1043.6665" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="1015.2441" y="6429.0879">Card</text><path d="M1014.6665,6436.041 L1014.6665,6460.041 M1014.6665,6448.041 L1031.6665,6448.041 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1043.6665" cy="6448.041" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="1069.6665" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="1076.6665" y="54.0469">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.4307" x="1109.4585" y="70.5352">API</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="1069.6665" y="6415.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="1076.6665" y="6436.0879">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.4307" x="1109.4585" y="6452.5762">API</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="1180.6812" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="1187.6812" y="54.0469">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="1207.8267" y="70.5352">Reader</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="1180.6812" y="6415.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="1187.6812" y="6436.0879">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="1207.8267" y="6452.5762">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1475.9712" y="78.5352">SAM</text><path d="M1473.9785,37 L1473.9785,61 M1473.9785,49 L1490.9785,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1502.9785" cy="49" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1475.9712" y="6429.0879">SAM</text><path d="M1473.9785,6436.041 L1473.9785,6460.041 M1473.9785,6448.041 L1490.9785,6448.041 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1502.9785" cy="6448.041" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="6316.0645" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.0166" y="91.4883"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="272.3516"/><rect fill="#FFC0CB" height="197.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="315.6621"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="947.1152"/><rect fill="#FFC0CB" height="149.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="990.4258"/><rect fill="#FFC0CB" height="262.7949" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="1332.5313"/><rect fill="#FFC0CB" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.7148" y="1624.6367"/><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="666.6992"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="888.4941"/><rect fill="#ADD8E6" height="59.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="1683.2578"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="1954.6738"/><rect fill="#ADD8E6" height="511.1504" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="1997.9844"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="2553.7559"/><rect fill="#ADD8E6" height="285.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="2597.0664"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="2969.0352"/><rect fill="#ADD8E6" height="300.3477" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3012.3457"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3399.625"/><rect fill="#ADD8E6" height="315.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3442.9355"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3845.5254"/><rect fill="#ADD8E6" height="330.9688" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="3888.8359"/><rect fill="#ADD8E6" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="4337.3574"/><rect fill="#ADD8E6" height="1550.5234" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="4380.668"/><rect fill="#ADD8E6" height="161.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="492.916" y="6043.8262"/><rect fill="#ADD8E6" height="173.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="1392.4629"/><rect fill="#ADD8E6" height="190.9883" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="2136.6621"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="2656.998"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="3072.2773"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="3502.8672"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="3948.7676"/><rect fill="#ADD8E6" height="466.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="761.519" y="5149.4395"/><rect fill="#ADD8E6" height="4819.2266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1030.1665" y="1421.7734"/><rect fill="#90EE90" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1115.1738" y="213.7305"/><rect fill="#90EE90" height="44.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="1115.1738" y="542.1465"/><rect fill="#90EE90" height="72.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="375.5938"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="726.6309"/><rect fill="#90EE90" height="555.9766" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="4533.5313"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="5676.1543"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1226.1885" y="6103.7578"/><rect fill="#90EE90" height="6002.6484" style="stroke:#181818;stroke-width:1.0;" width="10" x="1489.4785" y="404.9043"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1538.9785" x="0" y="112.1436"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="112.1436" y2="112.1436"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="115.1436" y2="115.1436"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="314.8091" x="612.0847" y="101.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="296.5244" x="618.0847" y="118.0566">Access Control embedded Terminal settings</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="156.1094" y2="156.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="156.1094" y2="169.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="169.1094" y2="169.1094"/><polygon fill="#181818" points="96.0166,165.1094,86.0166,169.1094,96.0166,173.1094,92.0166,169.1094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2363" x="92.0166" y="151.3672">set</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6104" x="116.3662" y="151.3672">Calypso SAM lib</text><polygon fill="#181818" points="1103.1738,209.7305,1113.1738,213.7305,1103.1738,217.7305,1107.1738,213.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="1109.1738" y1="213.7305" y2="213.7305"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="193.6777">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7681" x="148.0537" y="193.6777">card selection:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.5103" x="124.9229" y="208.9883">- filter by Power-On data</text><polygon fill="#181818" points="96.0166,223.7305,86.0166,227.7305,96.0166,231.7305,92.0166,227.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="1119.1738" y1="227.7305" y2="227.7305"/><polygon fill="#181818" points="391.7148,268.3516,401.7148,272.3516,391.7148,276.3516,395.7148,272.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="272.3516" y2="272.3516"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="252.2988">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.7192" x="148.0537" y="252.2988">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.9683" x="124.9229" y="267.6094">- legacy SAM selection</text><polygon fill="#181818" points="96.0166,282.3516,86.0166,286.3516,96.0166,290.3516,92.0166,286.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.7148" y1="286.3516" y2="286.3516"/><polygon fill="#181818" points="391.7148,311.6621,401.7148,315.6621,391.7148,319.6621,395.7148,315.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="315.6621" y2="315.6621"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="310.9199">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.9854" x="148.1934" y="310.9199">synchronous card selection scenario</text><polygon fill="#00FF00" points="1214.1885,371.5938,1224.1885,375.5938,1214.1885,379.5938,1218.1885,375.5938" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.7148" x2="1220.1885" y1="375.5938" y2="375.5938"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49.3403" x="420.7148" y="340.2305">SAM #x</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.7852" x="420.7148" y="355.541">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.7837" x="453.6211" y="370.8516">- card selector</text><polygon fill="#181818" points="1477.4785,400.9043,1487.4785,404.9043,1477.4785,408.9043,1481.4785,404.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="404.9043" y2="404.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0859" x="1243.1885" y="400.1621">open card channel</text><polygon fill="#181818" points="1247.1885,414.9043,1237.1885,418.9043,1247.1885,422.9043,1243.1885,418.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="418.9043" y2="418.9043"/><polygon fill="#00FF00" points="424.7148,444.2148,414.7148,448.2148,424.7148,452.2148,420.7148,448.2148" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.7148" x2="1230.1885" y1="448.2148" y2="448.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.915" x="430.7148" y="443.4727">receive selection response</text><path d="M898,461.2148 L898,486.2148 L1340,486.2148 L1340,471.2148 L1330,461.2148 L898,461.2148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1330,461.2148 L1330,471.2148 L1340,471.2148 L1330,461.2148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421.9922" x="904" y="478.7832">The SAM remains permanently selected between card transactions.</text><polygon fill="#181818" points="96.0166,508.8359,86.0166,512.8359,96.0166,516.8359,92.0166,512.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.7148" y1="512.8359" y2="512.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.1816" x="102.0166" y="508.0938">selected active SmartCard image</text><polygon fill="#181818" points="1103.1738,538.1465,1113.1738,542.1465,1103.1738,546.1465,1107.1738,542.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="1109.1738" y1="542.1465" y2="542.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.1807" x="92.0166" y="537.4043">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.6206" x="123.3105" y="537.4043">SAM card</text><polygon fill="#181818" points="96.0166,582.7676,86.0166,586.7676,96.0166,590.7676,92.0166,586.7676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="1119.1738" y1="586.7676" y2="586.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.894" x="102.0166" y="566.7148">[legacy SAM image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2983" x="134.9229" y="582.0254">- identification data]</text><path d="M920,599.7676 L920,639.7676 L1319,639.7676 L1319,609.7676 L1309,599.7676 L920,599.7676 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1309,599.7676 L1309,609.7676 L1319,609.7676 L1309,599.7676 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.1045" x="926" y="617.3359">Apart from SAM module selection, a secure transaction with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="363.3018" x="926" y="632.6465">a Calypso card is managed independently of the SAM API.</text><polygon fill="#181818" points="480.916,662.6992,490.916,666.6992,480.916,670.6992,484.916,666.6992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="666.6992" y2="666.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.2612" x="92.0166" y="661.957">init</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.7017" x="118.3911" y="661.957">crypto context for next transaction</text><polygon fill="#00FF00" points="1214.1885,722.6309,1224.1885,726.6309,1214.1885,730.6309,1218.1885,726.6309" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="502.916" x2="1220.1885" y1="726.6309" y2="726.6309"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.5522" x="509.916" y="691.2676">SAM #x'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="706.5781">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="721.8887">- APDU list</text><polygon fill="#181818" points="1477.4785,751.9414,1487.4785,755.9414,1477.4785,759.9414,1481.4785,755.9414" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="755.9414" y2="755.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4048" x="1243.1885" y="751.1992">get challenge</text><polygon fill="#181818" points="1247.1885,781.252,1237.1885,785.252,1247.1885,789.252,1243.1885,785.252" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="785.252" y2="785.252"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="1253.1885" y="780.5098">[SAM challenge]</text><polygon fill="#00FF00" points="513.916,810.5625,503.916,814.5625,513.916,818.5625,509.916,814.5625" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="1230.1885" y1="814.5625" y2="814.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="519.916" y="809.8203">[SAM challenge]</text><polygon fill="#181818" points="96.0166,824.5625,86.0166,828.5625,96.0166,832.5625,92.0166,828.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="828.5625" y2="828.5625"/><polygon fill="#181818" points="480.916,884.4941,490.916,888.4941,480.916,892.4941,484.916,888.4941" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="888.4941" y2="888.4941"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="853.1309">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7681" x="148.0537" y="853.1309">card selection:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.7852" x="124.9229" y="868.4414">- filter by specific AID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.1572" x="124.9229" y="883.752">- filter invalidated card status</text><polygon fill="#181818" points="96.0166,898.4941,86.0166,902.4941,96.0166,906.4941,92.0166,902.4941" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="902.4941" y2="902.4941"/><polygon fill="#181818" points="391.7148,943.1152,401.7148,947.1152,391.7148,951.1152,395.7148,947.1152" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="947.1152" y2="947.1152"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="927.0625">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.7192" x="148.0537" y="927.0625">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.9214" x="124.9229" y="942.373">- Calypso card selection</text><polygon fill="#181818" points="96.0166,957.1152,86.0166,961.1152,96.0166,965.1152,92.0166,961.1152" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.7148" y1="961.1152" y2="961.1152"/><polygon fill="#181818" points="391.7148,986.4258,401.7148,990.4258,391.7148,994.4258,395.7148,990.4258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="990.4258" y2="990.4258"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.4204" x="92.0166" y="985.6836">schedule</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.1646" x="155.5503" y="985.6836">asynchronous card selection scenario</text><polygon fill="#181818" points="96.0166,1000.4258,86.0166,1004.4258,96.0166,1008.4258,92.0166,1004.4258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="402.7148" y1="1004.4258" y2="1004.4258"/><polygon fill="#181818" points="391.7148,1029.7363,401.7148,1033.7363,391.7148,1037.7363,395.7148,1033.7363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="1033.7363" y2="1033.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.5435" x="92.0166" y="1028.9941">add</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.0332" x="119.6733" y="1028.9941">observer</text><polygon fill="#181818" points="96.0166,1043.7363,86.0166,1047.7363,96.0166,1051.7363,92.0166,1047.7363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="402.7148" y1="1047.7363" y2="1047.7363"/><polygon fill="#181818" points="391.7148,1073.0469,401.7148,1077.0469,391.7148,1081.0469,395.7148,1077.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="1077.0469" y2="1077.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.0967" x="92.0166" y="1072.3047">start detection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.2554" x="194.2266" y="1072.3047">- repeating mode</text><polygon fill="#FFA500" points="687,1090.0469,845,1090.0469,855,1109.0469,845,1128.0469,687,1128.0469,677,1109.0469,687,1090.0469" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="689" y="1106.6152">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154.9082" x="689" y="1121.9258">Wait For Card Insertion</text><polygon fill="#181818" points="96.0166,1135.668,86.0166,1139.668,96.0166,1143.668,92.0166,1139.668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.7148" y1="1139.668" y2="1139.668"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="1168.9785" y2="1168.9785"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="1168.9785" y2="1181.9785"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="1181.9785" y2="1181.9785"/><polygon fill="#181818" points="96.0166,1177.9785,86.0166,1181.9785,96.0166,1185.9785,92.0166,1181.9785" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.355" x="92.0166" y="1164.2363">wait</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.2334" x="124.4849" y="1164.2363">for card presence</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1538.9785" x="0" y="1210.6338"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="1210.6338" y2="1210.6338"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="1213.6338" y2="1213.6338"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="221.3208" x="658.8289" y="1199.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="203.0361" x="664.8289" y="1216.5469">Card selection &amp; identification</text><polygon fill="#FFA500" points="777.519,1250.5996,767.519,1254.5996,777.519,1258.5996,773.519,1254.5996" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;" x1="771.519" x2="942.6499" y1="1254.5996" y2="1254.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.3394" x="783.519" y="1249.8574">card</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.979" x="814.9717" y="1249.8574">insertion</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4727" x="883.1772" y="1249.8574">.  .  .  .  .</text><polygon fill="#FFA500" points="680,1267.5996,851,1267.5996,861,1286.5996,851,1305.5996,680,1305.5996,670,1286.5996,680,1267.5996" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="682" y="1284.168">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="167.6099" x="682" y="1299.4785">Wait For Card Processing</text><polygon fill="#FFA500" points="424.7148,1328.5313,414.7148,1332.5313,424.7148,1336.5313,420.7148,1332.5313" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;" x1="418.7148" x2="765.519" y1="1332.5313" y2="1332.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59.979" x="430.7148" y="1327.7891">insertion</text><polygon fill="#0000FF" points="749.519,1388.4629,759.519,1392.4629,749.519,1396.4629,753.519,1392.4629" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.7148" x2="755.519" y1="1392.4629" y2="1392.4629"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.7148" y="1357.0996">Card #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.7852" x="420.7148" y="1372.4102">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.7837" x="453.6211" y="1387.7207">- card selector</text><polygon fill="#181818" points="1018.1665,1417.7734,1028.1665,1421.7734,1018.1665,1425.7734,1022.1665,1421.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="1421.7734" y2="1421.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0859" x="778.519" y="1417.0313">open card channel</text><polygon fill="#181818" points="782.519,1431.7734,772.519,1435.7734,782.519,1439.7734,778.519,1435.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="1435.7734" y2="1435.7734"/><polygon fill="#181818" points="1018.1665,1461.084,1028.1665,1465.084,1018.1665,1469.084,1022.1665,1465.084" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="1465.084" y2="1465.084"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.7622" x="778.519" y="1460.3418">select application (aid)</text><polygon fill="#181818" points="782.519,1490.3945,772.519,1494.3945,782.519,1498.3945,778.519,1494.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="1494.3945" y2="1494.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.6172" x="788.519" y="1489.6523">[card FCI]</text><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="813.519" y1="1523.7051" y2="1523.7051"/><line style="stroke:#181818;stroke-width:1.0;" x1="813.519" x2="813.519" y1="1523.7051" y2="1536.7051"/><line style="stroke:#181818;stroke-width:1.0;" x1="772.519" x2="813.519" y1="1536.7051" y2="1536.7051"/><polygon fill="#181818" points="782.519,1532.7051,772.519,1536.7051,782.519,1540.7051,778.519,1536.7051" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.5889" x="778.519" y="1518.9629">checks invalidation status</text><polygon fill="#0000FF" points="424.7148,1562.0156,414.7148,1566.0156,424.7148,1570.0156,420.7148,1566.0156" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.7148" x2="765.519" y1="1566.0156" y2="1566.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.915" x="430.7148" y="1561.2734">receive selection response</text><polygon fill="#181818" points="96.0166,1591.3262,86.0166,1595.3262,96.0166,1599.3262,92.0166,1595.3262" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.7148" y1="1595.3262" y2="1595.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.3047" x="102.0166" y="1590.584">notify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.0737" x="145.4346" y="1590.584">scheduled card selections responsee</text><polygon fill="#181818" points="391.7148,1620.6367,401.7148,1624.6367,391.7148,1628.6367,395.7148,1624.6367" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.7148" y1="1624.6367" y2="1624.6367"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="37.1338" x="92.0166" y="1619.8945">parse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.8311" x="133.2637" y="1619.8945">scheduled card selections response</text><polygon fill="#181818" points="96.0166,1649.9473,86.0166,1653.9473,96.0166,1657.9473,92.0166,1653.9473" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.7148" y1="1653.9473" y2="1653.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.1816" x="102.0166" y="1649.2051">selected active SmartCard image</text><polygon fill="#181818" points="480.916,1679.2578,490.916,1683.2578,480.916,1687.2578,484.916,1683.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="1683.2578" y2="1683.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.1807" x="92.0166" y="1678.5156">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.9707" x="123.3105" y="1678.5156">Calypso card</text><polygon fill="#181818" points="96.0166,1739.1895,86.0166,1743.1895,96.0166,1747.1895,92.0166,1743.1895" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="1743.1895" y2="1743.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="1707.8262">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="1723.1367">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.4854" x="134.9229" y="1738.4473">- invalidation status]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1538.9785" x="0" y="1771.8447"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="1771.8447" y2="1771.8447"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="1774.8447" y2="1774.8447"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="177.8394" x="680.5696" y="1761.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="159.5547" x="686.5696" y="1777.7578">Card secure transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="1846.4316" y2="1846.4316"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="1846.4316" y2="1859.4316"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="1859.4316" y2="1859.4316"/><polygon fill="#181818" points="96.0166,1855.4316,86.0166,1859.4316,96.0166,1863.4316,92.0166,1859.4316" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71.5889" x="92.0166" y="1811.0684">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.7642" x="167.7188" y="1811.0684">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1821" x="124.9229" y="1826.3789">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.0107" x="124.9229" y="1841.6895">- Calypso SAM resource</text><path d="M377,1872.4316 L377,1897.4316 L618,1897.4316 L618,1882.4316 L608,1872.4316 L377,1872.4316 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M608,1872.4316 L608,1882.4316 L618,1882.4316 L608,1872.4316 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.0923" x="383" y="1890">Only reads data inside the session.</text><polygon fill="#181818" points="480.916,1950.6738,490.916,1954.6738,480.916,1958.6738,484.916,1954.6738" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="1954.6738" y2="1954.6738"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="1919.3105">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="1919.3105">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.1763" x="124.9229" y="1934.6211">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8022" x="124.9229" y="1949.9316">- read environment file</text><polygon fill="#181818" points="96.0166,1964.6738,86.0166,1968.6738,96.0166,1972.6738,92.0166,1968.6738" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="1968.6738" y2="1968.6738"/><polygon fill="#181818" points="480.916,1993.9844,490.916,1997.9844,480.916,2001.9844,484.916,1997.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="1997.9844" y2="1997.9844"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="1993.2422">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="1993.2422">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="1993.2422">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="1993.2422">channel open)</text><line style="stroke:#00FF00;stroke-width:1.0;" x1="502.916" x2="544.916" y1="2063.7305" y2="2063.7305"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="544.916" x2="544.916" y1="2063.7305" y2="2076.7305"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="503.916" x2="544.916" y1="2076.7305" y2="2076.7305"/><polygon fill="#00FF00" points="513.916,2072.7305,503.916,2076.7305,513.916,2080.7305,509.916,2076.7305" style="stroke:#00FF00;stroke-width:1.0;"/><path d="M529.416,2019.7344 C529.416,2025.1191 525.0507,2029.4844 519.666,2029.4844 C514.2813,2029.4844 509.916,2025.1191 509.916,2019.7344 C509.916,2014.3497 514.2813,2009.9844 519.666,2009.9844 C525.0507,2009.9844 529.416,2014.3497 529.416,2019.7344 " fill="#FFCC4D" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M510.5877,2015.9525 C510.7177,2016.0819 511.3666,2016.4708 511.4961,2016.8598 C511.6261,2017.2481 511.8861,2019.4511 512.665,2020.0995 C513.4683,2020.7668 516.4983,2020.5187 517.0785,2020.2295 C518.3768,2019.5822 518.5361,2017.7752 518.7658,2016.8598 C518.8952,2016.3414 519.6741,2016.3414 519.6741,2016.3414 C519.6741,2016.3414 520.4531,2016.3414 520.5831,2016.8592 C520.8127,2017.7752 520.9731,2019.5822 522.2703,2020.2289 C522.851,2020.5187 525.8811,2020.7673 526.6855,2020.1 C527.4633,2019.4516 527.7228,2017.2487 527.8528,2016.8598 C527.9817,2016.4714 528.6317,2016.0825 528.7611,2015.953 C528.8917,2015.8235 528.8917,2015.3052 528.7611,2015.1752 C528.5017,2014.9163 525.4386,2014.6855 522.1403,2015.0457 C521.4822,2015.1178 521.232,2015.3046 519.6736,2015.3046 C518.1163,2015.3046 517.865,2015.1172 517.2074,2015.0457 C513.9113,2014.685 510.8477,2014.9157 510.5877,2015.1746 C510.4582,2015.3041 510.4582,2015.823 510.5877,2015.9525 " fill="#292F33" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M524.7225,2022.7834 C524.6261,2022.6962 524.482,2022.6908 524.3785,2022.7677 C524.3574,2022.7834 522.2541,2024.3385 519.666,2024.3385 C517.0844,2024.3385 514.9741,2022.7834 514.9535,2022.7677 C514.8501,2022.6908 514.706,2022.6973 514.6096,2022.7834 C514.5137,2022.8701 514.492,2023.0131 514.5586,2023.1236 C514.6285,2023.24 516.3012,2025.9635 519.666,2025.9635 C523.0308,2025.9635 524.7041,2023.24 524.7734,2023.1236 C524.84,2023.0125 524.8189,2022.8701 524.7225,2022.7834 " fill="#664500" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.9766" x="533.5293" y="2028.3672">SAM challenge already known</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.8677" x="509.916" y="2043.6777">no need to request it during</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.3057" x="509.916" y="2058.9883">the card transaction</text><polygon fill="#0000FF" points="749.519,2132.6621,759.519,2136.6621,749.519,2140.6621,753.519,2136.6621" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="502.916" x2="755.519" y1="2136.6621" y2="2136.6621"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="509.916" y="2101.2988">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="2116.6094">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="2131.9199">- APDU list</text><path d="M526,2151.6621 L820.8818,2151.6621 L820.8818,2158.9727 L810.8818,2168.9727 L526,2168.9727 L526,2151.6621 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="147.6777" style="stroke:#000000;stroke-width:1.5;" width="543.6665" x="526" y="2151.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="541" y="2165.2305">Card APDU commands inside session</text><path d="M536,2173.9727 L536,2204.9727 L995,2204.9727 L995,2183.9727 L985,2173.9727 L536,2173.9727 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M985,2173.9727 L985,2183.9727 L995,2183.9727 L985,2173.9727 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M561.5,2188.7227 C561.5,2194.1074 557.1347,2198.4727 551.75,2198.4727 C546.3653,2198.4727 542,2194.1074 542,2188.7227 C542,2183.3379 546.3653,2178.9727 551.75,2178.9727 C557.1347,2178.9727 561.5,2183.3379 561.5,2188.7227 " fill="#FFCC4D" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M542.6717,2184.9407 C542.8017,2185.0702 543.4506,2185.4591 543.58,2185.848 C543.71,2186.2364 543.97,2188.4394 544.749,2189.0877 C545.5523,2189.7551 548.5823,2189.507 549.1625,2189.2177 C550.4608,2188.5704 550.6201,2186.7634 550.8498,2185.848 C550.9792,2185.3297 551.7581,2185.3297 551.7581,2185.3297 C551.7581,2185.3297 552.537,2185.3297 552.667,2185.8475 C552.8967,2186.7634 553.057,2188.5704 554.3543,2189.2172 C554.935,2189.507 557.9651,2189.7556 558.7695,2189.0883 C559.5473,2188.4399 559.8068,2186.2369 559.9368,2185.848 C560.0657,2185.4597 560.7157,2185.0707 560.8451,2184.9413 C560.9757,2184.8118 560.9757,2184.2934 560.8451,2184.1634 C560.5857,2183.9045 557.5225,2183.6738 554.2243,2184.034 C553.5662,2184.106 553.316,2184.2929 551.7576,2184.2929 C550.2003,2184.2929 549.949,2184.1055 549.2914,2184.034 C545.9953,2183.6732 542.9317,2183.904 542.6717,2184.1629 C542.5422,2184.2924 542.5422,2184.8113 542.6717,2184.9407 " fill="#292F33" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M556.8065,2191.7717 C556.71,2191.6845 556.566,2191.6791 556.4625,2191.756 C556.4414,2191.7717 554.3381,2193.3268 551.75,2193.3268 C549.1684,2193.3268 547.0581,2191.7717 547.0375,2191.756 C546.934,2191.6791 546.79,2191.6856 546.6935,2191.7717 C546.5977,2191.8584 546.576,2192.0014 546.6426,2192.1119 C546.7125,2192.2283 548.3852,2194.9518 551.75,2194.9518 C555.1148,2194.9518 556.788,2192.2283 556.8574,2192.1119 C556.924,2192.0008 556.9029,2191.8584 556.8065,2191.7717 " fill="#664500" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.0542" x="565.6133" y="2197.3555">Optimization: environment file read through the session opening.</text><polygon fill="#181818" points="1018.1665,2258.0293,1028.1665,2262.0293,1018.1665,2266.0293,1022.1665,2262.0293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="2262.0293" y2="2262.0293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.6772" x="778.519" y="2226.666">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4751" x="811.4253" y="2241.9766">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.5337" x="811.4253" y="2257.2871">SFI environment to read)</text><polygon fill="#181818" points="782.519,2287.3398,772.519,2291.3398,782.519,2295.3398,778.519,2291.3398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="2291.3398" y2="2291.3398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.2744" x="788.519" y="2286.5977">[card challenge &amp; environment data]</text><polygon fill="#0000FF" points="513.916,2323.6504,503.916,2327.6504,513.916,2331.6504,509.916,2327.6504" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="765.519" y1="2327.6504" y2="2327.6504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9883" x="519.916" y="2322.9082">[card challenge]</text><line style="stroke:#181818;stroke-width:1.0;" x1="502.916" x2="544.916" y1="2356.9609" y2="2356.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="544.916" x2="544.916" y1="2356.9609" y2="2369.9609"/><line style="stroke:#181818;stroke-width:1.0;" x1="503.916" x2="544.916" y1="2369.9609" y2="2369.9609"/><polygon fill="#181818" points="513.916,2365.9609,503.916,2369.9609,513.916,2373.9609,509.916,2369.9609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.4727" x="509.916" y="2352.2188">checks ratification status</text><polygon fill="#B0E0E6" points="992,2382.9609,1078,2382.9609,1088,2401.9609,1078,2420.9609,992,2420.9609,982,2401.9609,992,2382.9609" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2783" x="994" y="2399.5293">card in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.896" x="994" y="2414.8398">ratified</text><polygon fill="#181818" points="96.0166,2505.1348,86.0166,2509.1348,96.0166,2513.1348,92.0166,2509.1348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="2509.1348" y2="2509.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="2443.1504">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="2458.4609">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="2473.7715">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="2489.082">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.3691" x="134.9229" y="2504.3926">- ratification status]</text><polygon fill="#181818" points="480.916,2549.7559,490.916,2553.7559,480.916,2557.7559,484.916,2553.7559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="2553.7559" y2="2553.7559"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="2533.7031">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="2533.7031">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.3555" x="124.9229" y="2549.0137">- read last event</text><polygon fill="#181818" points="96.0166,2563.7559,86.0166,2567.7559,96.0166,2571.7559,92.0166,2567.7559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="2567.7559" y2="2567.7559"/><polygon fill="#181818" points="480.916,2593.0664,490.916,2597.0664,480.916,2601.0664,484.916,2597.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="2597.0664" y2="2597.0664"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="2592.3242">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="2592.3242">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="2592.3242">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="2592.3242">channel open)</text><polygon fill="#0000FF" points="749.519,2652.998,759.519,2656.998,749.519,2660.998,753.519,2656.998" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="502.916" x2="755.519" y1="2656.998" y2="2656.998"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="509.916" y="2621.6348">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="2636.9453">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="2652.2559">- APDU list</text><path d="M704.6616,2671.998 L999.5435,2671.998 L999.5435,2679.3086 L989.5435,2689.3086 L704.6616,2689.3086 L704.6616,2671.998 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="2671.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="719.6616" y="2685.5664">Card APDU commands inside session</text><polygon fill="#181818" points="1018.1665,2706.6191,1028.1665,2710.6191,1018.1665,2714.6191,1022.1665,2710.6191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="2710.6191" y2="2710.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.9961" x="778.519" y="2705.877">read record (last event)</text><polygon fill="#181818" points="782.519,2735.9297,772.519,2739.9297,782.519,2743.9297,778.519,2739.9297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="2739.9297" y2="2739.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6548" x="788.519" y="2735.1875">[last event data]</text><polygon fill="#0000FF" points="513.916,2772.2402,503.916,2776.2402,513.916,2780.2402,509.916,2776.2402" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="765.519" y1="2776.2402" y2="2776.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6548" x="519.916" y="2771.498">[last event data]</text><polygon fill="#181818" points="96.0166,2878.1035,86.0166,2882.1035,96.0166,2886.1035,92.0166,2882.1035" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="2882.1035" y2="2882.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="2800.8086">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="2816.1191">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="2831.4297">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="2846.7402">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="2862.0508">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0625" x="134.9229" y="2877.3613">- last event data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="2911.4141" y2="2911.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="2911.4141" y2="2924.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="2924.4141" y2="2924.4141"/><polygon fill="#181818" points="96.0166,2920.4141,86.0166,2924.4141,96.0166,2928.4141,92.0166,2924.4141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.2739" x="92.0166" y="2906.6719">checks transaction recovery status</text><polygon fill="#181818" points="480.916,2965.0352,490.916,2969.0352,480.916,2973.0352,484.916,2969.0352" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="2969.0352" y2="2969.0352"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="2948.9824">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="2948.9824">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.3838" x="124.9229" y="2964.293">- read contract list</text><polygon fill="#181818" points="96.0166,2979.0352,86.0166,2983.0352,96.0166,2987.0352,92.0166,2983.0352" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="2983.0352" y2="2983.0352"/><polygon fill="#181818" points="480.916,3008.3457,490.916,3012.3457,480.916,3016.3457,484.916,3012.3457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="3012.3457" y2="3012.3457"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="3007.6035">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="3007.6035">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="3007.6035">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="3007.6035">channel open)</text><polygon fill="#0000FF" points="749.519,3068.2773,759.519,3072.2773,749.519,3076.2773,753.519,3072.2773" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="502.916" x2="755.519" y1="3072.2773" y2="3072.2773"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="509.916" y="3036.9141">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="3052.2246">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="3067.5352">- APDU list</text><path d="M704.6616,3087.2773 L999.5435,3087.2773 L999.5435,3094.5879 L989.5435,3104.5879 L704.6616,3104.5879 L704.6616,3087.2773 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="3087.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="719.6616" y="3100.8457">Card APDU commands inside session</text><polygon fill="#181818" points="1018.1665,3121.8984,1028.1665,3125.8984,1018.1665,3129.8984,1022.1665,3125.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="3125.8984" y2="3125.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.0244" x="778.519" y="3121.1563">read record (contract list)</text><polygon fill="#181818" points="782.519,3151.209,772.519,3155.209,782.519,3159.209,778.519,3155.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="3155.209" y2="3155.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.6831" x="788.519" y="3150.4668">[contract list data]</text><polygon fill="#0000FF" points="513.916,3187.5195,503.916,3191.5195,513.916,3195.5195,509.916,3191.5195" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="765.519" y1="3191.5195" y2="3191.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.6831" x="519.916" y="3186.7773">[contract list data]</text><polygon fill="#181818" points="96.0166,3308.6934,86.0166,3312.6934,96.0166,3316.6934,92.0166,3312.6934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="3312.6934" y2="3312.6934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="3216.0879">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="3231.3984">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="3246.709">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="3262.0195">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="3277.3301">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.835" x="134.9229" y="3292.6406">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.0908" x="134.9229" y="3307.9512">- contract list data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="3342.0039" y2="3342.0039"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="3342.0039" y2="3355.0039"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="3355.0039" y2="3355.0039"/><polygon fill="#181818" points="96.0166,3351.0039,86.0166,3355.0039,96.0166,3359.0039,92.0166,3355.0039" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.9849" x="92.0166" y="3337.2617">identifies contract</text><polygon fill="#181818" points="480.916,3395.625,490.916,3399.625,480.916,3403.625,484.916,3399.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="3399.625" y2="3399.625"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="3379.5723">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="3379.5723">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.5718" x="124.9229" y="3394.8828">- read contract #x</text><polygon fill="#181818" points="96.0166,3409.625,86.0166,3413.625,96.0166,3417.625,92.0166,3413.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="3413.625" y2="3413.625"/><polygon fill="#181818" points="480.916,3438.9355,490.916,3442.9355,480.916,3446.9355,484.916,3442.9355" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="3442.9355" y2="3442.9355"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="3438.1934">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="3438.1934">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="3438.1934">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="3438.1934">channel open)</text><polygon fill="#0000FF" points="749.519,3498.8672,759.519,3502.8672,749.519,3506.8672,753.519,3502.8672" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="502.916" x2="755.519" y1="3502.8672" y2="3502.8672"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="509.916" y="3467.5039">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="3482.8145">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="3498.125">- APDU list</text><path d="M704.6616,3517.8672 L999.5435,3517.8672 L999.5435,3525.1777 L989.5435,3535.1777 L704.6616,3535.1777 L704.6616,3517.8672 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="3517.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="719.6616" y="3531.4355">Card APDU commands inside session</text><polygon fill="#181818" points="1018.1665,3552.4883,1028.1665,3556.4883,1018.1665,3560.4883,1022.1665,3556.4883" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="3556.4883" y2="3556.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.2124" x="778.519" y="3551.7461">read record (contract #x)</text><polygon fill="#181818" points="782.519,3581.7988,772.519,3585.7988,782.519,3589.7988,778.519,3585.7988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="3585.7988" y2="3585.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8711" x="788.519" y="3581.0566">[contract #x data]</text><polygon fill="#0000FF" points="513.916,3618.1094,503.916,3622.1094,513.916,3626.1094,509.916,3622.1094" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="765.519" y1="3622.1094" y2="3622.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8711" x="519.916" y="3617.3672">[contract #x data]</text><polygon fill="#181818" points="96.0166,3754.5938,86.0166,3758.5938,96.0166,3762.5938,92.0166,3758.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="3758.5938" y2="3758.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="3646.6777">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="3661.9883">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="3677.2988">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="3692.6094">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="3707.9199">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.835" x="134.9229" y="3723.2305">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="3738.541">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.2788" x="134.9229" y="3753.8516">- contract #x data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="3787.9043" y2="3787.9043"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="3787.9043" y2="3800.9043"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="3800.9043" y2="3800.9043"/><polygon fill="#181818" points="96.0166,3796.9043,86.0166,3800.9043,96.0166,3804.9043,92.0166,3800.9043" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.0098" x="92.0166" y="3783.1621">identifies associated counter</text><polygon fill="#181818" points="480.916,3841.5254,490.916,3845.5254,480.916,3849.5254,484.916,3845.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="3845.5254" y2="3845.5254"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="3825.4727">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="3825.4727">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.7441" x="124.9229" y="3840.7832">- reader counter #x</text><polygon fill="#181818" points="96.0166,3855.5254,86.0166,3859.5254,96.0166,3863.5254,92.0166,3859.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="3859.5254" y2="3859.5254"/><polygon fill="#181818" points="480.916,3884.8359,490.916,3888.8359,480.916,3892.8359,484.916,3888.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="3888.8359" y2="3888.8359"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="3884.0938">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="3884.0938">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.0747" x="225.5078" y="3884.0938">keep</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8608" x="261.6958" y="3884.0938">channel open)</text><polygon fill="#0000FF" points="749.519,3944.7676,759.519,3948.7676,749.519,3952.7676,753.519,3948.7676" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="502.916" x2="755.519" y1="3948.7676" y2="3948.7676"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="509.916" y="3913.4043">Card #6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="3928.7148">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="3944.0254">- APDU list</text><path d="M704.6616,3963.7676 L999.5435,3963.7676 L999.5435,3971.0781 L989.5435,3981.0781 L704.6616,3981.0781 L704.6616,3963.7676 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="3963.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="719.6616" y="3977.3359">Card APDU commands inside session</text><polygon fill="#181818" points="1018.1665,3998.3887,1028.1665,4002.3887,1018.1665,4006.3887,1022.1665,4002.3887" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="4002.3887" y2="4002.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.8228" x="778.519" y="3997.6465">read record (counter #x)</text><polygon fill="#181818" points="782.519,4027.6992,772.519,4031.6992,782.519,4035.6992,778.519,4031.6992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="4031.6992" y2="4031.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.729" x="788.519" y="4026.957">[counter #1 data]</text><polygon fill="#0000FF" points="513.916,4064.0098,503.916,4068.0098,513.916,4072.0098,509.916,4068.0098" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="765.519" y1="4068.0098" y2="4068.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9883" x="519.916" y="4063.2676">[card challenge]</text><polygon fill="#181818" points="96.0166,4215.8047,86.0166,4219.8047,96.0166,4223.8047,92.0166,4219.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="4219.8047" y2="4219.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="4092.5781">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="4107.8887">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="4123.1992">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="4138.5098">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1416" x="134.9229" y="4153.8203">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.835" x="134.9229" y="4169.1309">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="4184.4414">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0513" x="134.9229" y="4199.752">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.8892" x="134.9229" y="4215.0625">- counter #x data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="4249.1152" y2="4249.1152"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="4249.1152" y2="4262.1152"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="4262.1152" y2="4262.1152"/><polygon fill="#181818" points="96.0166,4258.1152,86.0166,4262.1152,96.0166,4266.1152,92.0166,4262.1152" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.2065" x="92.0166" y="4244.373">defines data to update</text><polygon fill="#181818" points="480.916,4333.3574,490.916,4337.3574,480.916,4341.3574,484.916,4337.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="4337.3574" y2="4337.3574"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="4286.6836">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="143.9404" y="4286.6836">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.938" x="124.9229" y="4301.9941">- decrease counter #x (new value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.9023" x="124.9229" y="4317.3047">- append event record (new event)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.9043" x="124.9229" y="4332.6152">- close secure session (not ratified)</text><polygon fill="#181818" points="96.0166,4347.3574,86.0166,4351.3574,96.0166,4355.3574,92.0166,4351.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="4351.3574" y2="4351.3574"/><polygon fill="#181818" points="480.916,4376.668,490.916,4380.668,480.916,4384.668,484.916,4380.668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="4380.668" y2="4380.668"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="4375.9258">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.3145" x="148.1934" y="4375.9258">commands (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="34.417" x="225.5078" y="4375.9258">close</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.7661" x="264.0381" y="4375.9258">channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="502.916" x2="544.916" y1="4409.9785" y2="4409.9785"/><line style="stroke:#181818;stroke-width:1.0;" x1="544.916" x2="544.916" y1="4409.9785" y2="4422.9785"/><line style="stroke:#181818;stroke-width:1.0;" x1="503.916" x2="544.916" y1="4422.9785" y2="4422.9785"/><polygon fill="#181818" points="513.916,4418.9785,503.916,4422.9785,513.916,4426.9785,509.916,4422.9785" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.603" x="509.916" y="4405.2363">anticipates the future card responses</text><path d="M140,4435.9785 L140,4475.9785 L854,4475.9785 L854,4445.9785 L844,4435.9785 L140,4435.9785 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M844,4435.9785 L844,4445.9785 L854,4445.9785 L844,4435.9785 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.2744" x="146" y="4453.5469">If the current value of the counter #x were</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="61.896" x="417.3877" y="4453.5469">unknown</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319.6108" x="479.2837" y="4453.5469">, then the transmission of an additional card APDU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="693.856" x="146" y="4468.8574">message would be necessary to operate the decrease counter in a different message than the session closing.</text><polygon fill="#00FF00" points="1214.1885,4529.5313,1224.1885,4533.5313,1214.1885,4537.5313,1218.1885,4533.5313" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="502.916" x2="1220.1885" y1="4533.5313" y2="4533.5313"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="509.916" y="4498.168">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="4513.4785">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="4528.7891">- APDU list</text><path d="M992,4546.5313 L992,4577.5313 L1468,4577.5313 L1468,4556.5313 L1458,4546.5313 L992,4546.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1458,4546.5313 L1458,4556.5313 L1468,4556.5313 L1458,4546.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1017.5,4561.2813 C1017.5,4566.666 1013.1347,4571.0313 1007.75,4571.0313 C1002.3653,4571.0313 998,4566.666 998,4561.2813 C998,4555.8965 1002.3653,4551.5313 1007.75,4551.5313 C1013.1347,4551.5313 1017.5,4555.8965 1017.5,4561.2813 " fill="#FFCC4D" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M998.6717,4557.4993 C998.8017,4557.6288 999.4506,4558.0177 999.58,4558.4066 C999.71,4558.795 999.97,4560.998 1000.749,4561.6463 C1001.5523,4562.3137 1004.5823,4562.0656 1005.1625,4561.7763 C1006.4608,4561.129 1006.6201,4559.322 1006.8498,4558.4066 C1006.9792,4557.8883 1007.7581,4557.8883 1007.7581,4557.8883 C1007.7581,4557.8883 1008.537,4557.8883 1008.667,4558.4061 C1008.8967,4559.322 1009.057,4561.129 1010.3543,4561.7758 C1010.935,4562.0656 1013.9651,4562.3142 1014.7695,4561.6469 C1015.5473,4560.9985 1015.8068,4558.7955 1015.9368,4558.4066 C1016.0657,4558.0183 1016.7157,4557.6293 1016.8451,4557.4999 C1016.9757,4557.3704 1016.9757,4556.852 1016.8451,4556.722 C1016.5857,4556.4631 1013.5225,4556.2324 1010.2243,4556.5926 C1009.5662,4556.6646 1009.316,4556.8515 1007.7576,4556.8515 C1006.2003,4556.8515 1005.949,4556.6641 1005.2914,4556.5926 C1001.9953,4556.2318 998.9317,4556.4626 998.6717,4556.7215 C998.5422,4556.851 998.5422,4557.3699 998.6717,4557.4993 " fill="#292F33" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M1012.8065,4564.3303 C1012.71,4564.2431 1012.566,4564.2377 1012.4625,4564.3146 C1012.4414,4564.3303 1010.3381,4565.8854 1007.75,4565.8854 C1005.1684,4565.8854 1003.0581,4564.3303 1003.0375,4564.3146 C1002.934,4564.2377 1002.79,4564.2442 1002.6935,4564.3303 C1002.5977,4564.417 1002.576,4564.56 1002.6426,4564.6705 C1002.7125,4564.7869 1004.3852,4567.5104 1007.75,4567.5104 C1011.1148,4567.5104 1012.788,4564.7869 1012.8574,4564.6705 C1012.924,4564.5594 1012.9029,4564.417 1012.8065,4564.3303 " fill="#664500" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="431.9453" x="1021.6133" y="4569.9141">All card session data managed within a single SAM command group.</text><polygon fill="#181818" points="1477.4785,4599.9668,1487.4785,4603.9668,1477.4785,4607.9668,1481.4785,4603.9668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4603.9668" y2="4603.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.124" x="1243.1885" y="4599.2246">select diversifier (card serial)</text><polygon fill="#181818" points="1247.1885,4613.9668,1237.1885,4617.9668,1247.1885,4621.9668,1243.1885,4617.9668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4617.9668" y2="4617.9668"/><polygon fill="#181818" points="1477.4785,4643.2773,1487.4785,4647.2773,1477.4785,4651.2773,1481.4785,4647.2773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4647.2773" y2="4647.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="1243.1885" y="4642.5352">digest init (opening data)</text><polygon fill="#181818" points="1247.1885,4657.2773,1237.1885,4661.2773,1247.1885,4665.2773,1243.1885,4661.2773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4661.2773" y2="4661.2773"/><polygon fill="#181818" points="1477.4785,4686.5879,1487.4785,4690.5879,1477.4785,4694.5879,1481.4785,4690.5879" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4690.5879" y2="4690.5879"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.6914" x="1243.1885" y="4685.8457">digest update (read environment)</text><polygon fill="#181818" points="1247.1885,4700.5879,1237.1885,4704.5879,1247.1885,4708.5879,1243.1885,4704.5879" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4704.5879" y2="4704.5879"/><polygon fill="#181818" points="1477.4785,4729.8984,1487.4785,4733.8984,1477.4785,4737.8984,1481.4785,4733.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4733.8984" y2="4733.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.8594" x="1243.1885" y="4729.1563">digest update (last event)</text><polygon fill="#181818" points="1247.1885,4743.8984,1237.1885,4747.8984,1247.1885,4751.8984,1243.1885,4747.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4747.8984" y2="4747.8984"/><polygon fill="#181818" points="1477.4785,4773.209,1487.4785,4777.209,1477.4785,4781.209,1481.4785,4777.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4777.209" y2="4777.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.9243" x="1243.1885" y="4772.4668">digest update (read contract list)</text><polygon fill="#181818" points="1247.1885,4787.209,1237.1885,4791.209,1247.1885,4795.209,1243.1885,4791.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4791.209" y2="4791.209"/><polygon fill="#181818" points="1477.4785,4816.5195,1487.4785,4820.5195,1477.4785,4824.5195,1481.4785,4820.5195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4820.5195" y2="4820.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.1123" x="1243.1885" y="4815.7773">digest update (read contract #x)</text><polygon fill="#181818" points="1247.1885,4830.5195,1237.1885,4834.5195,1247.1885,4838.5195,1243.1885,4834.5195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4834.5195" y2="4834.5195"/><polygon fill="#181818" points="1477.4785,4859.8301,1487.4785,4863.8301,1477.4785,4867.8301,1481.4785,4863.8301" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4863.8301" y2="4863.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.0435" x="1243.1885" y="4859.0879">digest update (read counters)</text><polygon fill="#181818" points="1247.1885,4873.8301,1237.1885,4877.8301,1247.1885,4881.8301,1243.1885,4877.8301" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4877.8301" y2="4877.8301"/><path d="M1170.6812,4892.8301 L1464.4014,4892.8301 L1464.4014,4905.9551 L1454.4014,4915.9551 L1170.6812,4915.9551 L1170.6812,4892.8301 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.7461" style="stroke:#000000;stroke-width:1.5;" width="358.2974" x="1170.6812" y="4892.8301"/><path d="M1205.1812,4903.5801 C1205.1812,4908.9648 1200.8159,4913.3301 1195.4312,4913.3301 C1190.0464,4913.3301 1185.6812,4908.9648 1185.6812,4903.5801 C1185.6812,4898.1954 1190.0464,4893.8301 1195.4312,4893.8301 C1200.8159,4893.8301 1205.1812,4898.1954 1205.1812,4903.5801 " fill="#FFCC4D" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M1186.3528,4899.7982 C1186.4828,4899.9276 1187.1317,4900.3165 1187.2612,4900.7055 C1187.3912,4901.0938 1187.6512,4903.2968 1188.4301,4903.9452 C1189.2334,4904.6125 1192.2635,4904.3644 1192.8436,4904.0752 C1194.142,4903.4279 1194.3012,4901.6209 1194.5309,4900.7055 C1194.6604,4900.1871 1195.4393,4900.1871 1195.4393,4900.1871 C1195.4393,4900.1871 1196.2182,4900.1871 1196.3482,4900.7049 C1196.5779,4901.6209 1196.7382,4903.4279 1198.0355,4904.0746 C1198.6162,4904.3644 1201.6462,4904.613 1202.4506,4903.9457 C1203.2284,4903.2973 1203.4879,4901.0944 1203.6179,4900.7055 C1203.7468,4900.3171 1204.3968,4899.9282 1204.5263,4899.7987 C1204.6568,4899.6692 1204.6568,4899.1509 1204.5263,4899.0209 C1204.2668,4898.762 1201.2037,4898.5312 1197.9055,4898.8914 C1197.2474,4898.9635 1196.9971,4899.1503 1195.4387,4899.1503 C1193.8814,4899.1503 1193.6301,4898.9629 1192.9725,4898.8914 C1189.6765,4898.5307 1186.6128,4898.7614 1186.3528,4899.0203 C1186.2234,4899.1498 1186.2234,4899.6687 1186.3528,4899.7982 " fill="#292F33" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M1200.4876,4906.6291 C1200.3912,4906.5419 1200.2471,4906.5365 1200.1437,4906.6134 C1200.1225,4906.6291 1198.0192,4908.1842 1195.4312,4908.1842 C1192.8496,4908.1842 1190.7392,4906.6291 1190.7187,4906.6134 C1190.6152,4906.5365 1190.4711,4906.543 1190.3747,4906.6291 C1190.2788,4906.7158 1190.2572,4906.8588 1190.3238,4906.9693 C1190.3937,4907.0857 1192.0663,4909.8092 1195.4312,4909.8092 C1198.796,4909.8092 1200.4692,4907.0857 1200.5385,4906.9693 C1200.6052,4906.8582 1200.584,4906.7158 1200.4876,4906.6291 " fill="#664500" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4.2847" x="1205.1812" y="4912.2129">&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="74.5786" x="1209.4658" y="4912.2129">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.0723" x="1288.3291" y="4912.2129">Card APDU responses</text><polygon fill="#181818" points="1477.4785,4933.2656,1487.4785,4937.2656,1477.4785,4941.2656,1481.4785,4937.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4937.2656" y2="4937.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.1875" x="1243.1885" y="4932.5234">digest update (decrease counter)</text><polygon fill="#181818" points="1247.1885,4947.2656,1237.1885,4951.2656,1247.1885,4955.2656,1243.1885,4951.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4951.2656" y2="4951.2656"/><polygon fill="#181818" points="1477.4785,4976.5762,1487.4785,4980.5762,1477.4785,4984.5762,1481.4785,4980.5762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="4980.5762" y2="4980.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.29" x="1243.1885" y="4975.834">digest update (append event record)</text><polygon fill="#181818" points="1247.1885,4990.5762,1237.1885,4994.5762,1247.1885,4998.5762,1243.1885,4994.5762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="4994.5762" y2="4994.5762"/><polygon fill="#181818" points="1477.4785,5026.8867,1487.4785,5030.8867,1477.4785,5034.8867,1481.4785,5030.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="5030.8867" y2="5030.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1626" x="1243.1885" y="5026.1445">digest close</text><polygon fill="#181818" points="1247.1885,5056.1973,1237.1885,5060.1973,1247.1885,5064.1973,1243.1885,5060.1973" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="5060.1973" y2="5060.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="1253.1885" y="5055.4551">[SAM certificate]</text><polygon fill="#00FF00" points="513.916,5085.5078,503.916,5089.5078,513.916,5093.5078,509.916,5089.5078" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="1230.1885" y1="5089.5078" y2="5089.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="519.916" y="5084.7656">[SAM certificate]</text><polygon fill="#0000FF" points="749.519,5145.4395,759.519,5149.4395,749.519,5153.4395,753.519,5149.4395" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="502.916" x2="755.519" y1="5149.4395" y2="5149.4395"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="509.916" y="5114.0762">Card #7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="5129.3867">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="5144.6973">- APDU list</text><path d="M704.6616,5164.4395 L999.5435,5164.4395 L999.5435,5171.75 L989.5435,5181.75 L704.6616,5181.75 L704.6616,5164.4395 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.2422" style="stroke:#000000;stroke-width:1.5;" width="365.0049" x="704.6616" y="5164.4395"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="719.6616" y="5178.0078">Card APDU commands inside session</text><polygon fill="#181818" points="1018.1665,5199.0605,1028.1665,5203.0605,1018.1665,5207.0605,1022.1665,5203.0605" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="5203.0605" y2="5203.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.5405" x="778.519" y="5198.3184">decrease counter (counter #1, value)</text><polygon fill="#181818" points="782.519,5228.3711,772.519,5232.3711,782.519,5236.3711,778.519,5232.3711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="5232.3711" y2="5232.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.189" x="788.519" y="5227.6289">[new counter value]</text><polygon fill="#181818" points="1018.1665,5257.6816,1028.1665,5261.6816,1018.1665,5265.6816,1022.1665,5261.6816" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="5261.6816" y2="5261.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1987" x="778.519" y="5256.9395">append record (event, data)</text><polygon fill="#181818" points="782.519,5271.6816,772.519,5275.6816,782.519,5279.6816,778.519,5275.6816" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="5275.6816" y2="5275.6816"/><polygon fill="#181818" points="1018.1665,5323.3027,1028.1665,5327.3027,1018.1665,5331.3027,1022.1665,5327.3027" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="5327.3027" y2="5327.3027"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.6475" x="778.519" y="5307.25">close secure session (SAM certificate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13.8062" x="782.6323" y="5322.5605">as</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.5767" x="800.5518" y="5322.5605">non-ratified</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.2275" x="883.1284" y="5322.5605">)</text><polygon fill="#181818" points="782.519,5352.6133,772.519,5356.6133,782.519,5360.6133,778.519,5356.6133" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="5356.6133" y2="5356.6133"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="788.519" y="5351.8711">[card certificate]</text><polygon fill="#B0E0E6" points="991,5369.6133,1077,5369.6133,1087,5388.6133,1077,5407.6133,991,5407.6133,981,5388.6133,991,5369.6133" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2783" x="993" y="5386.1816">card in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.5767" x="993" y="5401.4922">non-ratified</text><path d="M534,5418.2344 L534,5449.2344 L998,5449.2344 L998,5428.2344 L988,5418.2344 L534,5418.2344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M988,5418.2344 L988,5428.2344 L998,5428.2344 L988,5418.2344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M559.5,5432.9844 C559.5,5438.3691 555.1347,5442.7344 549.75,5442.7344 C544.3653,5442.7344 540,5438.3691 540,5432.9844 C540,5427.5997 544.3653,5423.2344 549.75,5423.2344 C555.1347,5423.2344 559.5,5427.5997 559.5,5432.9844 " fill="#FFCC4D" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M540.6717,5429.2025 C540.8017,5429.3319 541.4506,5429.7208 541.58,5430.1098 C541.71,5430.4981 541.97,5432.7011 542.749,5433.3495 C543.5523,5434.0168 546.5823,5433.7687 547.1625,5433.4795 C548.4608,5432.8322 548.6201,5431.0252 548.8498,5430.1098 C548.9792,5429.5914 549.7581,5429.5914 549.7581,5429.5914 C549.7581,5429.5914 550.537,5429.5914 550.667,5430.1092 C550.8967,5431.0252 551.057,5432.8322 552.3543,5433.4789 C552.935,5433.7687 555.9651,5434.0173 556.7695,5433.35 C557.5473,5432.7016 557.8068,5430.4987 557.9368,5430.1098 C558.0657,5429.7214 558.7157,5429.3325 558.8451,5429.203 C558.9757,5429.0735 558.9757,5428.5552 558.8451,5428.4252 C558.5857,5428.1663 555.5225,5427.9355 552.2243,5428.2957 C551.5662,5428.3678 551.316,5428.5546 549.7576,5428.5546 C548.2003,5428.5546 547.949,5428.3672 547.2914,5428.2957 C543.9953,5427.935 540.9317,5428.1657 540.6717,5428.4246 C540.5422,5428.5541 540.5422,5429.073 540.6717,5429.2025 " fill="#292F33" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M554.8065,5436.0334 C554.71,5435.9462 554.566,5435.9408 554.4625,5436.0177 C554.4414,5436.0334 552.3381,5437.5885 549.75,5437.5885 C547.1684,5437.5885 545.0581,5436.0334 545.0375,5436.0177 C544.934,5435.9408 544.79,5435.9473 544.6935,5436.0334 C544.5977,5436.1201 544.576,5436.2631 544.6426,5436.3736 C544.7125,5436.49 546.3852,5439.2135 549.75,5439.2135 C553.1148,5439.2135 554.788,5436.49 554.8574,5436.3736 C554.924,5436.2625 554.9029,5436.1201 554.8065,5436.0334 " fill="#664500" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419.9102" x="563.6133" y="5441.6172">ratification command immediately performed after session closing</text><polygon fill="#181818" points="1018.1665,5471.6699,1028.1665,5475.6699,1018.1665,5479.6699,1022.1665,5475.6699" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="771.519" x2="1024.1665" y1="5475.6699" y2="5475.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.6274" x="778.519" y="5470.9277">ratification command</text><polygon fill="#181818" points="782.519,5485.6699,772.519,5489.6699,782.519,5493.6699,778.519,5489.6699" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="776.519" x2="1029.1665" y1="5489.6699" y2="5489.6699"/><polygon fill="#B0E0E6" points="992,5502.6699,1078,5502.6699,1088,5521.6699,1078,5540.6699,992,5540.6699,982,5521.6699,992,5502.6699" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2783" x="994" y="5519.2383">card in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.896" x="994" y="5534.5488">ratified</text><polygon fill="#FFA500" points="688,5551.291,843,5551.291,853,5570.291,843,5589.291,688,5589.291,678,5570.291,688,5551.291" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="690" y="5567.8594">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.9248" x="690" y="5583.1699">Wait For Card Removal</text><polygon fill="#0000FF" points="513.916,5612.2227,503.916,5616.2227,513.916,5620.2227,509.916,5616.2227" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="765.519" y1="5616.2227" y2="5616.2227"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="519.916" y="5611.4805">[card certificate]</text><polygon fill="#00FF00" points="1214.1885,5672.1543,1224.1885,5676.1543,1214.1885,5680.1543,1218.1885,5676.1543" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="502.916" x2="1220.1885" y1="5676.1543" y2="5676.1543"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="509.916" y="5640.791">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="5656.1016">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="5671.4121">- APDU list</text><polygon fill="#181818" points="1477.4785,5701.4648,1487.4785,5705.4648,1477.4785,5709.4648,1481.4785,5705.4648" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="5705.4648" y2="5705.4648"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.2842" x="1243.1885" y="5700.7227">digest authenticate (card certificate)</text><polygon fill="#181818" points="1247.1885,5730.7754,1237.1885,5734.7754,1247.1885,5738.7754,1243.1885,5734.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="5734.7754" y2="5734.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4131" x="1253.1885" y="5730.0332">[authentication status]</text><polygon fill="#00FF00" points="513.916,5760.0859,503.916,5764.0859,513.916,5768.0859,509.916,5764.0859" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="1230.1885" y1="5764.0859" y2="5764.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9507" x="519.916" y="5759.3438">[authentification status]</text><polygon fill="#181818" points="96.0166,5927.1914,86.0166,5931.1914,96.0166,5935.1914,92.0166,5931.1914" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="5931.1914" y2="5931.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="5788.6543">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="5803.9648">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2578" x="134.9229" y="5819.2754">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="5834.5859">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="134.9229" y="5849.8965">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="line-through" textLength="110.5063" x="146.5581" y="5849.8965">ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.3018" x="134.9229" y="5865.207">- last event data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="5880.5176">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0513" x="134.9229" y="5895.8281">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.356" x="134.9229" y="5911.1387">- counter #x data (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4956" x="102.0166" y="5926.4492">authentification status</text><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="5966.3164" y2="5966.3164"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="5966.3164" y2="5979.3164"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="5979.3164" y2="5979.3164"/><polygon fill="#181818" points="96.0166,5975.3164,86.0166,5979.3164,96.0166,5983.3164,92.0166,5979.3164" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.4629" x="92.0166" y="5961.5742">card successfully authenticated</text><ellipse cx="297.4868" cy="5958.0872" fill="#CCD6DD" rx="0.8125" ry="0.8125" style="stroke:#CCD6DD;stroke-width:1.0;"/><path d="M298.7976,5950.3598 C298.8253,5950.2314 298.841,5950.0987 298.841,5949.9622 C298.841,5948.9152 297.9922,5948.0664 296.9451,5948.0664 C295.9896,5948.0664 295.2075,5948.7749 295.0764,5949.6941 C295.0672,5949.6941 295.0585,5949.6914 295.0493,5949.6914 C294.4513,5949.6914 293.966,5950.1767 293.966,5950.7747 C293.966,5951.3727 294.4513,5951.8581 295.0493,5951.8581 C295.0672,5951.8581 295.0834,5951.8537 295.1008,5951.8527 C295.0694,5951.9393 295.0493,5952.0314 295.0493,5952.1289 C295.0493,5952.3781 295.1641,5952.5985 295.3413,5952.748 C295.1614,5952.9414 295.0493,5953.1982 295.0493,5953.4831 C295.0493,5954.0811 295.5346,5954.5664 296.1326,5954.5664 C296.1326,5954.7695 296.1922,5954.9569 296.2892,5955.1194 C295.8954,5955.1752 295.591,5955.5111 295.591,5955.9206 C295.591,5956.3691 295.955,5956.7331 296.4035,5956.7331 C296.852,5956.7331 297.216,5956.3691 297.216,5955.9206 C297.216,5955.8231 297.1959,5955.731 297.1645,5955.6443 C297.1819,5955.6454 297.1981,5955.6497 297.216,5955.6497 C297.814,5955.6497 298.2993,5955.1644 298.2993,5954.5664 C298.2993,5954.2409 298.1531,5953.9527 297.9256,5953.7539 C298.1525,5953.5551 298.2993,5953.2669 298.2993,5952.9414 C298.2993,5952.7367 298.2392,5952.5471 298.1401,5952.3835 C298.1926,5952.3916 298.2446,5952.3997 298.2993,5952.3997 C298.8973,5952.3997 299.3826,5951.9144 299.3826,5951.3164 C299.3826,5950.8988 299.1438,5950.5407 298.7976,5950.3598 " fill="#CCD6DD" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><ellipse cx="296.6743" cy="5953.4831" fill="#E4EBEF" rx="0.5417" ry="0.5417" style="stroke:#E4EBEF;stroke-width:1.0;"/><path d="M298.2993,5950.2331 C298.2993,5949.6345 297.8145,5949.1497 297.216,5949.1497 C296.6174,5949.1497 296.1326,5949.6345 296.1326,5950.2331 C296.1326,5950.2504 296.137,5950.2672 296.1381,5950.2845 C296.0514,5950.2531 295.9593,5950.2331 295.8618,5950.2331 C295.4128,5950.2331 295.0493,5950.5965 295.0493,5951.0456 C295.0493,5951.4946 295.4128,5951.8581 295.8618,5951.8581 C295.9691,5951.8581 296.0704,5951.8364 296.1641,5951.7985 C296.2572,5952.1441 296.5698,5952.3997 296.9451,5952.3997 C297.3942,5952.3997 297.7576,5952.0363 297.7576,5951.5872 C297.7576,5951.4529 297.7219,5951.3283 297.6645,5951.2167 C298.0382,5951.0461 298.2993,5950.6713 298.2993,5950.2331 " fill="#E4EBEF" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M297.5475,5944.8576 C297.1049,5944.4253 297.1049,5944.4253 297.0746,5944.4015 C297.2008,5944.0667 297.1634,5943.7141 296.9392,5943.485 C296.5996,5943.1513 295.9869,5943.2207 295.5655,5943.6421 L294.4166,5944.7909 C293.9958,5945.2118 293.9259,5945.825 294.2596,5946.1646 C294.4887,5946.3883 294.8408,5946.4262 295.1761,5946.3 C295.2004,5946.3298 295.6321,5946.7729 295.6321,5946.7729 C296.0552,5947.1954 296.7409,5947.1954 297.164,5946.7729 L297.5469,5946.3894 C297.97,5945.9664 297.97,5945.2806 297.5475,5944.8576 " fill="#C1694F" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M297.2366,5945.3499 C297.2886,5945.2979 297.4505,5945.1268 297.6174,5944.9437 C297.5941,5944.915 297.574,5944.8847 297.5469,5944.8576 C297.5469,5944.8576 297.1044,5944.4253 297.0741,5944.4015 C297.0134,5944.5629 296.9175,5944.7211 296.7805,5944.8576 L295.6327,5946.0064 C295.4956,5946.1435 295.3375,5946.2394 295.1761,5946.3 C295.2004,5946.3298 295.6321,5946.7729 295.6321,5946.7729 C295.6587,5946.7994 295.6896,5946.8195 295.7183,5946.8433 C295.8759,5946.7019 296.0346,5946.5524 296.0877,5946.4999 L297.2366,5945.3499 " fill="#A95233" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M312.4969,5956.076 L309.7523,5953.3314 C307.7676,5951.3467 305.7862,5951.0889 301.9751,5949.5695 L300.2694,5951.2752 C302.0195,5954.8557 302.0222,5957.0922 304.0069,5959.0769 L306.752,5961.822 C307.2899,5962.3599 307.72,5962.8024 308.2589,5962.264 L312.8138,5957.7075 C313.3533,5957.168 313.0348,5956.6139 312.4969,5956.076 " fill="#264612" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M302.3705,5949.7802 C303.3124,5950.1291 303.3124,5950.1291 302.0671,5951.3744 C300.9177,5952.5238 300.4871,5951.727 300.4871,5951.727 L298.62,5949.8599 L300.5353,5947.9445 L302.3705,5949.7802 " fill="#FFE8B6" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M300.7016,5948.1114 L300.1524,5947.5616 L298.237,5949.4764 L298.7863,5950.0262 C299.3247,5950.564 299.2299,5950.5976 300.2184,5949.6091 L300.5391,5949.2879 C301.3202,5948.5062 301.2395,5948.6492 300.7016,5948.1114 " fill="#FFD983" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M300.3436,5946.9869 C300.661,5947.3043 300.661,5947.8189 300.343,5948.1363 L298.8117,5949.6676 C298.4943,5949.9855 297.9797,5949.9855 297.6623,5949.6676 C297.3449,5949.3507 297.3449,5948.8356 297.6623,5948.5182 L299.1936,5946.9869 C299.5116,5946.67 300.0261,5946.6694 300.3436,5946.9869 " fill="#264612" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><path d="M308.9615,5954.0729 C308.5384,5953.6504 307.8521,5953.6504 307.4291,5954.0729 L304.7484,5956.7542 C304.3254,5957.1767 304.3254,5957.863 304.7484,5958.286 L307.0461,5960.5838 C307.4692,5961.0068 308.1555,5961.0068 308.5785,5960.5838 L311.2592,5957.9031 C311.6823,5957.48 311.6823,5956.7937 311.2592,5956.3712 L308.9615,5954.0729 " fill="#FFE8B6" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><polygon fill="#181818" points="331.9106,6010.5156,341.9106,6014.5156,331.9106,6018.5156,335.9106,6014.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="337.9106" y1="6014.5156" y2="6014.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.8999" x="92.0166" y="6009.7734">notification &amp;</text><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="145.8809" x="181.0298" y="6008.7188">access granting</text><polygon fill="#181818" points="480.916,6039.8262,490.916,6043.8262,480.916,6047.8262,484.916,6043.8262" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="486.916" y1="6043.8262" y2="6043.8262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.2612" x="92.0166" y="6039.084">init</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.7017" x="118.3911" y="6039.084">crypto context for next transaction</text><polygon fill="#00FF00" points="1214.1885,6099.7578,1224.1885,6103.7578,1214.1885,6107.7578,1218.1885,6103.7578" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="502.916" x2="1220.1885" y1="6103.7578" y2="6103.7578"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.5522" x="509.916" y="6068.3945">SAM #x'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="509.916" y="6083.7051">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="542.8223" y="6099.0156">- APDU list</text><polygon fill="#181818" points="1477.4785,6129.0684,1487.4785,6133.0684,1477.4785,6137.0684,1481.4785,6133.0684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1236.1885" x2="1483.4785" y1="6133.0684" y2="6133.0684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4048" x="1243.1885" y="6128.3262">get challenge</text><polygon fill="#181818" points="1247.1885,6158.3789,1237.1885,6162.3789,1247.1885,6166.3789,1243.1885,6162.3789" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1241.1885" x2="1488.4785" y1="6162.3789" y2="6162.3789"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="1253.1885" y="6157.6367">[SAM challenge]</text><polygon fill="#00FF00" points="513.916,6187.6895,503.916,6191.6895,513.916,6195.6895,509.916,6191.6895" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="507.916" x2="1230.1885" y1="6191.6895" y2="6191.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="519.916" y="6186.9473">[SAM challenge]</text><polygon fill="#181818" points="96.0166,6201.6895,86.0166,6205.6895,96.0166,6209.6895,92.0166,6205.6895" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="496.916" y1="6205.6895" y2="6205.6895"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="6235" y2="6235"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="6235" y2="6248"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="6248" y2="6248"/><polygon fill="#181818" points="96.0166,6244,86.0166,6248,96.0166,6252,92.0166,6248" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.355" x="92.0166" y="6230.2578">wait</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="124.4849" y="6230.2578">for card removal</text><line style="stroke:#A80036;stroke-width:2.0;" x1="1026.1665" x2="1044.1665" y1="6239" y2="6257"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1026.1665" x2="1044.1665" y1="6257" y2="6239"/><polygon fill="#FFA500" points="777.519,6273.3105,767.519,6277.3105,777.519,6281.3105,773.519,6277.3105" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;" x1="771.519" x2="936.6895" y1="6277.3105" y2="6277.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.3394" x="783.519" y="6272.5684">card</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.0186" x="814.9717" y="6272.5684">removal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4727" x="877.2168" y="6272.5684">.  .  .  .  .</text><polygon fill="#FFA500" points="687,6290.3105,845,6290.3105,855,6309.3105,845,6328.3105,687,6328.3105,677,6309.3105,687,6290.3105" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4243" x="689" y="6306.8789">reader in state:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154.9082" x="689" y="6322.1895">Wait For Card Insertion</text><polygon fill="#FFA500" points="419.7148,6351.2422,409.7148,6355.2422,419.7148,6359.2422,415.7148,6355.2422" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;" x1="413.7148" x2="765.519" y1="6355.2422" y2="6355.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.0186" x="425.7148" y="6350.5">removal</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1538.9785" x="0" y="6383.8975"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="6383.8975" y2="6383.8975"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1538.9785" y1="6386.8975" y2="6386.8975"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="226.1831" x="656.3977" y="6373.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="207.8984" x="662.3977" y="6389.8105">ready for next card transaction</text><!--SRC=[xLhTRziu4d_tNq4qG9i8yMwIfflMI7Dm_B78mw51juTxQFp0IBHDHAPqf9pK-zVV34b9f2JBTkAzTeiBWY2IXlF5-SqCFzwe1ovIAkc236Agr7KY8oO7IPn8SZ0-7PoVZ3jj9CFp_k1aw92eZ4cMPAkKzJt2_eVXO3Xk9Bpn2A_F-nUZTus40v_ZS7XwVTP8EF88HzSVtlgYvpHAdhYOaIcD5Uiud_x8QCRQBUo76N_asQg9glE6V6PHpMCqV9Z9P2aYJNrvALbqTGN-7Ow6eq6BVmlAqSNvuEsWC-SH8_dBqboGUhkKQSms2aurcPPzFXgCBrfbbyJlH-Vd_M4kldZlQN0VBpVBHo9jp_NutVYwLNfE-lRym_lXTIxRllKa_ouP4nj5pv1Ao-wF- -FJLja5xTbeCBWupONdhntf8FwJf6AssVH4avbf7v-DFhGgK1AFVhiOdPtb6XJlVHN00wjj7B0ozey6ez4c-pNfsU3jwDs9O_wg8fg66KJ_goyyV60P0ggVfZ4FQSOJyOfGHMYQaeDP4aSTa9NnaATKPEJLPqP16kdVtcWgILDE3b8k7doo0OrNgKhkn83AgA0EDNNCP_Fi6eEkQGZ14NV2oB6ZP6J5EcFlqK5KhiYh8C0XGL0GRnJnH_-VTo9NIfLAcNXSFyHHIj65fvCPwYe58wnEGEjHeVFv8wGhnyblYdSrweyV8NE5J2aoI4GcavYmnJsB8XQHBqmkkA0nKIp3MLJauqTWdwRTA_ZJ8q407uA0E5QGcDzR4hIyHowdm9M463yVCJy5GIeP-805mUMl-EtAE5Mnc8KO7hqxSPTroPJ744_aVaLkaoSckvy4YMX6EuuXu5ZF57pJrQfr8kRHMOtaypGYAcI2IfvOrM8se-5AMrlGb7f9evSEMjceaTGQRL8fmJafLL8h4Svb8fAbMgTUYmvV3qvEnkEJaybL4Lc-L9F2T5YHWs-5s3k822hKWcUEFCd-isGgCyvmT4caEpjD0GmLDN-FyR7eaIHbml08vrG85dVMHYeyTxkb_YulnpxZKCb2nX-PfxHA4m55tGkDWfT8u3bv17rrl13u-J9dUeubMr0k54a13LGmaSKhonSWSi-o9vQRe7r5jJprIuU9Y21RiBgCWruvLAi18XQG47GUumiwO_L0SS0K125LY3ZK2qLk1uSU-Uh4h1PZGnaIkCZur6PcZR197JmDpkbZ6YDJcImqpqKIBMF7tSU4maEubCnr2ddYsLmFfqNEq8xZYe1hGItuLqGCOY8oVawc9BFJ00dLzQdsIcYzmWL7huHobMR04YANVGFje0G9_CTHeNHOw3XCv_9E-0oal6c2YhR9Gqd_TlWlI8qgsuIGAZvcB4Dan37JlOGF0PXN7GZvzuaplB0ZzrALj1a7OMF62fsC5UufhQkKXHXvf7ypzBvnyKXZ3g48qM1uGE-zL2qprwRqFXE_5xClIFsjEgbmpX1CfLBqPRdVAE4AfL44e4dk5PC0wY1mwHmoq2L3b4SiCz80Obs8wvHHtTC1w04ryp8xkAsKxNwbUUH2poBhTOBWtnGWCWPiwgHt0pbP6kQ8xhb1jwjui_ji0_94DV8HwjepCAEAYP3flcRW- -frDTrXDrFgVFdLAZtf_eFq33jCBOL-XFpY_hxOz5jJuy6LdkqbgswXKJ4ZZZgT3VKUyJ-vAhdvmQONJAQt9GUdBo_upMsqQunMfRNYLxjhVEvs7HCQs1bDiDNDrnVaaFBeg3uOKg0MC1xSJ6gCSX80N_YWoXoaCMRoZpl6SV0k3OTZYTSJ105CFP-k8CPo-4SLfAk28TkvbwHIEUbaiuHDoUIvJKpeDp5kEjqgkyCC-cr3UoTZFzIdSjAfruaoNTIwbkgY1p2OmUgDm-2A5Uwmffe13awMCcJ-9zDacYzkinNcpTOd0QqGfXEbxGAJ5AwyiJDIc40IuNMRpoZJTRqrJAqph11oE1nTtto1ETVBnPWzilZ8KADoX8b73bLg0HE1jPozf6A7swwBmcG1hIDuvZ087XXBiGqqUKMRSBH3msTbzjHIp73hWwdU5V6w9a9Zj7H57aJo9Ew4IA3111H0qsbp98746Iqbv7J8f7DMysx7aRf3WZvxTfkv9Y_Z3b1AxFO932hSQ6FBJdcdgSBfcAouwLEQyGN_KwEiLui44nyPz33BsToDMpr7u2mtVf7xch9HZKVjWOZTWpCUsEeOdU3Dbtapll4KqfD5eKBaWXghH3ddhxtHPea4sgwh1xRRzfbCrbG17GjsY2qzaZffB2yzbKw37DmcJp2-g99Ubs4uiAZILUmxYveFLT_OV50tOh8pqhTBL3gq80up0lb8P7-VfBC3_Dz-B_WtOr6x73gU18OVbgvVZwYIPclyr8QiQQE-UrpRFS5MTVrLYmMwssAWCm7SgmBm-uC6xeP8U5qBZ9y67US_C3eyxxUK79Ti-nhJCEfl1HExejnaXW-VN4ccYf5_2LuEllsKQ7dtTq3BmRSji7BmRNUa56D-2fnKtZSRjnOzqBid8JVxhCbIP6Z_td24dQfX-hC2wRSV6aYvwzjmP6bEzxoe-Ib0bB_D_RWPMH6RSi7i5WqiCfSfdc7i22dhcuY5C9-AkGeS2lP4m3DBPZTTW36kces5-SmZaUd6hGLnebXjuGnhGf8l4pS3O-_mr4ev-AHJiF5eKvQmid3h3UzFPE1ht4gOBZEqBTzWqpkOgcaRxSOS9e8d97fCkp8_ONJy_CI0Mn0iXTxa2O9Z912QoiBSRbrCGHKyI-4OUJGs6Y1ojRG5M0_1JfwIPOpdn4GmT0XUtu3WW8maqLBaMfjiMCnJ4l7fb6b5SquPUClRF44tLZPFdd66URhd8qplk7YnVike7yVv3hGnHmCdFmV6esBj1xGmDaV0DeI8JfIkrTLJKtie475GGc6GIxjNf9ZaD3wgtIMeCeZuJ6_c2N35eTsZqlfjFTIWdnnMTqPtPk2khvyZkx82UH4BB2VFOw03MzL7cvfNYOnwDYan7vKPfQoK9UmnpZPeL8NRKJx8KsmBHWtvjvaN5jOrl7GcN7UkZoTzkh91gTryjEzIjnpkxzZbNFnONKujLvQjpkcnhOvhEnwiZJcv9fsiaM9dDg-fUeQFBVuRcTTw9ykekVfMfkluJk0zFZm45DroyxRb2DEFZ9qsXtqPpWRnjZlzNhkLPsI-MB08bnBn2kz9JHEvmCD1BElLQkKLgreJsy2yuHXu3_lXBpox_ymM2OJG-eDx2xAktpglmMYjUTwjWf_znPUGRAwYIso4Cgs-hQUEGKSDMSmPuPs-jkMoV4pRyK7ZXQN_nLgZssrORNIxZUiDScWAHNIqXvL7oMno9zQug7NFMNS_ItroErt605DtDYC0EVJYYvJE1EjTcN5u2KPVIyYbl2QNYl_9UgVliIARG-2PnDACDrWkVyMFL_-_cVSTRkQrtOYI9bDrgla6dbKcavLvs7GDIkRvRj-Ne9hlVxNUWIfqqRSsp85y4L7LBIcylV5V]--></g></svg>