<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="992px" preserveAspectRatio="none" style="width:3279px;height:992px;background:#FFFFFF;" version="1.1" viewBox="0 0 3279 992" width="3279px" zoomAndPan="magnify"><defs><filter height="1" id="b1rr7v7ett0ai0" width="1" x="0" y="0"><feFlood flood-color="#FFFF00" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><!--MD5=[f25ff1fa8fa59bbc0543eaadeb7d653a]
class CalypsoSam--><g id="elem_CalypsoSam"><rect codeLine="50" fill="#FEFECE" height="58.9766" id="CalypsoSam" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="160" x="1035.5" y="62.5"/><ellipse cx="1050.5" cy="83.9883" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1046.4277,79.7534 L1046.4277,77.5952 L1053.8071,77.5952 L1053.8071,79.7534 L1051.3418,79.7534 L1051.3418,87.8301 L1053.8071,87.8301 L1053.8071,89.9883 L1046.4277,89.9883 L1046.4277,87.8301 L1048.8931,87.8301 L1048.8931,79.7534 Z " fill="#000000"/><ellipse cx="1069.5" cy="83.4883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="22" x="1075.5" y="81.0352">&lt;&lt;</text><text fill="#000000" filter="url(#b1rr7v7ett0ai0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="73" x="1097.5" y="81.0352">SmartCard</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="22" x="1170.5" y="81.0352">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="83" x="1092.5" y="97.5234">CalypsoSam</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1036.5" x2="1194.5" y1="105.4766" y2="105.4766"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1036.5" x2="1194.5" y1="113.4766" y2="113.4766"/></g><!--MD5=[756cbdb2eeffdcd67180b97f5e83c8e0]
class LegacySam--><g id="elem_LegacySam"><rect codeLine="54" fill="#FEFECE" height="306.3008" id="LegacySam" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="498" x="496.5" y="235"/><ellipse cx="672.25" cy="256.4883" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M668.1777,252.2534 L668.1777,250.0952 L675.5571,250.0952 L675.5571,252.2534 L673.0918,252.2534 L673.0918,260.3301 L675.5571,260.3301 L675.5571,262.4883 L668.1777,262.4883 L668.1777,260.3301 L670.6431,260.3301 L670.6431,252.2534 Z " fill="#000000"/><ellipse cx="697.75" cy="255.9883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="22" x="703.75" y="253.5352">&lt;&lt;</text><text fill="#000000" filter="url(#b1rr7v7ett0ai0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="83" x="725.75" y="253.5352">CalypsoSam</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="22" x="808.75" y="253.5352">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="75" x="729.75" y="270.0234">LegacySam</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="497.5" x2="993.5" y1="277.9766" y2="277.9766"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="497.5" x2="993.5" y1="285.9766" y2="285.9766"/><ellipse cx="507.5" cy="299.7207" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212" x="516.5" y="303.5117">ProductType getProductType ()</text><ellipse cx="507.5" cy="316.209" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="161" x="516.5" y="320">String getProductInfo ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="516.5" y="336.4883"> </text><ellipse cx="507.5" cy="349.1855" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="516.5" y="352.9766">byte[] getSerialNumber ()</text><ellipse cx="507.5" cy="365.6738" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="516.5" y="369.4648">byte getPlatform ()</text><ellipse cx="507.5" cy="382.1621" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="180" x="516.5" y="385.9531">byte getApplicationType ()</text><ellipse cx="507.5" cy="398.6504" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206" x="516.5" y="402.4414">byte getApplicationSubType ()</text><ellipse cx="507.5" cy="415.1387" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="516.5" y="418.9297">byte getSoftwareIssuer ()</text><ellipse cx="507.5" cy="431.627" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="516.5" y="435.418">byte getSoftwareVersion ()</text><ellipse cx="507.5" cy="448.1152" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186" x="516.5" y="451.9063">byte getSoftwareRevision ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="516.5" y="468.3945"> </text><ellipse cx="507.5" cy="481.0918" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="324" x="516.5" y="484.8828">int getEventCounterValue(int numCounter 0..8)</text><ellipse cx="507.5" cy="497.5801" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="316" x="516.5" y="501.3711">int getEventCeilingValue(int numCounter 0..8)</text><ellipse cx="507.5" cy="514.0684" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="472" x="516.5" y="517.8594">byte[] getSystemKeyParameters(LegacySytemKey systemKeyRefeence)</text><ellipse cx="507.5" cy="530.5566" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="516.5" y="534.3477">byte[] getWorkKeyParameters(int numWorkKey 1..126)</text></g><!--MD5=[64db2d10778acf6b7b903aeb76cb16f8]
class SamProductType--><g id="elem_SamProductType"><rect codeLine="73" fill="#FEFECE" height="146.9297" id="SamProductType" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="129" x="681" y="634.5"/><ellipse cx="696" cy="650.5" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M700.1143,656.5 L692.3945,656.5 L692.3945,644.1069 L700.1143,644.1069 L700.1143,646.2651 L694.8433,646.2651 L694.8433,648.938 L699.6162,648.938 L699.6162,651.0962 L694.8433,651.0962 L694.8433,654.3418 L700.1143,654.3418 Z " fill="#000000"/><ellipse cx="715" cy="650" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="721" y="655.791">ProductType</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="682" x2="809" y1="666.5" y2="666.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="687" y="684.0352">SAM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="687" y="700.5234">HSM_C1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="687" y="717.0117">SAM_S1E1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="687" y="733.5">SAM_S1Dx</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="687" y="749.9883">CSAM_F</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="687" y="766.4766">UNKNOWN</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="682" x2="809" y1="773.4297" y2="773.4297"/></g><!--MD5=[b5c118e7fe264918e4eac19314f60ee8]
class OpenSam--><g id="elem_OpenSam"><rect codeLine="85" fill="#FEFECE" height="75.4648" id="OpenSam" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="170" x="1255.5" y="350.5"/><ellipse cx="1270.5" cy="371.9883" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1266.4277,367.7534 L1266.4277,365.5952 L1273.8071,365.5952 L1273.8071,367.7534 L1271.3418,367.7534 L1271.3418,375.8301 L1273.8071,375.8301 L1273.8071,377.9883 L1266.4277,377.9883 L1266.4277,375.8301 L1268.8931,375.8301 L1268.8931,367.7534 Z " fill="#000000"/><ellipse cx="1289.5" cy="371.4883" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="22" x="1295.5" y="369.0352">&lt;&lt;</text><text fill="#000000" filter="url(#b1rr7v7ett0ai0)" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="83" x="1317.5" y="369.0352">CalypsoSam</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="22" x="1400.5" y="369.0352">&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="66" x="1326" y="385.5234">OpenSam</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1256.5" x2="1424.5" y1="393.4766" y2="393.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="1261.5" y="411.0117">????</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1256.5" x2="1424.5" y1="417.9648" y2="417.9648"/></g><!--MD5=[693a13ab3a6cdba6037243dfcb574254]
class SamTransactionManager--><g id="elem_SamTransactionManager"><rect codeLine="90" fill="#FEFECE" height="80.9766" id="SamTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="232" x="1536.5" y="347.5"/><ellipse cx="1560.05" cy="363.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1555.9777,359.2651 L1555.9777,357.1069 L1563.3571,357.1069 L1563.3571,359.2651 L1560.8918,359.2651 L1560.8918,367.3418 L1563.3571,367.3418 L1563.3571,369.5 L1555.9777,369.5 L1555.9777,367.3418 L1558.4431,367.3418 L1558.4431,359.2651 Z " fill="#000000"/><ellipse cx="1580.95" cy="363" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="170" x="1586.95" y="368.791">SamTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1537.5" x2="1767.5" y1="379.5" y2="379.5"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1537.5" x2="1767.5" y1="387.5" y2="387.5"/><ellipse cx="1547.5" cy="401.2441" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" filter="url(#b1rr7v7ett0ai0)" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="1556.5" y="405.0352">CardReader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="1641.5" y="405.0352">getSamReader ()</text><ellipse cx="1547.5" cy="417.7324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="206" x="1556.5" y="421.5234">CalypsoSam getCalypsoSam ()</text></g><!--MD5=[da61a391893b692be16caea6f1f8a515]
class CommonTransactionManager--><g id="elem_CommonTransactionManager"><rect codeLine="189" fill="#FEFECE" height="163.6836" id="CommonTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="548" x="1378.5" y="10"/><ellipse cx="1402.95" cy="26.1328" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1398.8777,21.8979 L1398.8777,19.7397 L1406.2571,19.7397 L1406.2571,21.8979 L1403.7918,21.8979 L1403.7918,29.9746 L1406.2571,29.9746 L1406.2571,32.1328 L1398.8777,32.1328 L1398.8777,29.9746 L1401.3431,29.9746 L1401.3431,21.8979 Z " fill="#000000"/><ellipse cx="1424.05" cy="25.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="204" x="1430.05" y="31.4238">CommonTransactionManager</text><rect fill="#FFFFFF" height="30.2656" style="stroke:#D4AC0D;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="278" x="1651.5" y="7"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="276" x="1652.5" y="19.6016">T extends CommonTransactionManager&lt;T, S&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="219" x="1681" y="33.7344">S extends CommonSecuritySetting&lt;S&gt;</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1379.5" x2="1925.5" y1="42.2656" y2="42.2656"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1379.5" x2="1925.5" y1="50.2656" y2="50.2656"/><ellipse cx="1389.5" cy="64.0098" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1398.5" y="67.8008">S getSecuritySetting ()</text><ellipse cx="1389.5" cy="80.498" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="273" x="1398.5" y="84.2891">List&lt;byte[]&gt; getTransactionAuditData ()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1398.5" y="100.7773"> </text><ellipse cx="1389.5" cy="113.4746" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="522" x="1398.5" y="117.2656">T prepareComputeSignature (CommonSignatureComputationData&lt;?&gt; data)</text><ellipse cx="1389.5" cy="129.9629" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="486" x="1398.5" y="133.7539">T prepareVerifySignature (CommonSignatureVerificationData&lt;?&gt; data)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1398.5" y="150.2422"> </text><ellipse cx="1389.5" cy="162.9395" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="1398.5" y="166.7305">T processCommands ()</text></g><!--MD5=[0ca469eb9daf2ada2044bbaaac3ba003]
class LegacySamTransactionManager--><g id="elem_LegacySamTransactionManager"><rect codeLine="95" fill="#FEFECE" height="64.4883" id="LegacySamTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="259" x="1378" y="676"/><ellipse cx="1393" cy="692" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1388.9277,687.7651 L1388.9277,685.6069 L1396.3071,685.6069 L1396.3071,687.7651 L1393.8418,687.7651 L1393.8418,695.8418 L1396.3071,695.8418 L1396.3071,698 L1388.9277,698 L1388.9277,695.8418 L1391.3931,695.8418 L1391.3931,687.7651 Z " fill="#000000"/><ellipse cx="1412" cy="691.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="216" x="1418" y="697.291">LegacySamTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1379" x2="1636" y1="708" y2="708"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="1384" y="725.5352">????</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1379" x2="1636" y1="732.4883" y2="732.4883"/></g><!--MD5=[5743aa8f286bac7328c3941397ef116d]
class LegacySamOperations--><g id="elem_LegacySamOperations"><rect codeLine="101" fill="#FEFECE" height="48" id="LegacySamOperations" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="194" x="2148.5" y="68"/><ellipse cx="2163.5" cy="84" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2159.4277,79.7651 L2159.4277,77.6069 L2166.8071,77.6069 L2166.8071,79.7651 L2164.3418,79.7651 L2164.3418,87.8418 L2166.8071,87.8418 L2166.8071,90 L2159.4277,90 L2159.4277,87.8418 L2161.8931,87.8418 L2161.8931,79.7651 Z " fill="#000000"/><ellipse cx="2182.5" cy="83.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="151" x="2188.5" y="89.291">LegacySamOperations</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2149.5" x2="2341.5" y1="100" y2="100"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2149.5" x2="2341.5" y1="108" y2="108"/></g><!--MD5=[6ccf9a54dcc3b6bb8d1a99666175e2cd]
class LegacyReadOperations--><g id="elem_LegacyReadOperations"><rect codeLine="104" fill="#FEFECE" height="196.3945" id="LegacyReadOperations" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="512" x="1803.5" y="290"/><ellipse cx="1971.75" cy="306" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1967.6777,301.7651 L1967.6777,299.6069 L1975.0571,299.6069 L1975.0571,301.7651 L1972.5918,301.7651 L1972.5918,309.8418 L1975.0571,309.8418 L1975.0571,312 L1967.6777,312 L1967.6777,309.8418 L1970.1431,309.8418 L1970.1431,301.7651 Z " fill="#000000"/><ellipse cx="1997.25" cy="305.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="156" x="2003.25" y="311.291">LegacyReadOperations</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1804.5" x2="2314.5" y1="322" y2="322"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1804.5" x2="2314.5" y1="330" y2="330"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196" x="1809.5" y="347.5352">prepareReadSamParamters()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="381" x="1809.5" y="364.0234">prepareReadCaadRecord(int caadRecordReference 1..7)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1809.5" y="380.5117"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="500" x="1809.5" y="397">prepareReadSystemKeyParamters(LegacySystemKey systemKeyReference)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="457" x="1809.5" y="413.4883">prepareReadWorkKeyParamters(int workKeyRecordNumber 1..126)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="457" x="1809.5" y="429.9766">prepareReadWorkKeyParamters(byte workKeyKif, byte workKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="1809.5" y="446.4648"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="374" x="1809.5" y="462.9531">prepareReadCounterValue(int counterReference 0..26)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="384" x="1809.5" y="479.4414">prepareReadCounterCeiling(int counterReference 0..26)</text></g><!--MD5=[35945c1f608db6546c9608c4fb37ab0f]
class LegacyFreeWriteOperations--><g id="elem_LegacyFreeWriteOperations"><rect codeLine="117" fill="#FEFECE" height="80.9766" id="LegacyFreeWriteOperations" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="824" x="2350.5" y="347.5"/><ellipse cx="2659.25" cy="363.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2655.1777,359.2651 L2655.1777,357.1069 L2662.5571,357.1069 L2662.5571,359.2651 L2660.0918,359.2651 L2660.0918,367.3418 L2662.5571,367.3418 L2662.5571,369.5 L2655.1777,369.5 L2655.1777,367.3418 L2657.6431,367.3418 L2657.6431,359.2651 Z " fill="#000000"/><ellipse cx="2684.75" cy="363" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="187" x="2690.75" y="368.791">LegacyFreeWriteOperations</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2351.5" x2="3173.5" y1="379.5" y2="379.5"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2351.5" x2="3173.5" y1="387.5" y2="387.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="812" x="2356.5" y="405.0352">prepareWriteExternalPlainWorkKey(byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="714" x="2356.5" y="421.5234">prepareWriteRandomlyGeneratedWorkKey(byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)</text></g><!--MD5=[76fafb399eea6b00ebdd143404acac07]
class LegacyControlledWriteOperations--><g id="elem_LegacyControlledWriteOperations"><rect codeLine="122" fill="#FEFECE" height="179.9063" id="LegacyControlledWriteOperations" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="1019" x="2253" y="618"/><ellipse cx="2637.75" cy="634" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2633.6777,629.7651 L2633.6777,627.6069 L2641.0571,627.6069 L2641.0571,629.7651 L2638.5918,629.7651 L2638.5918,637.8418 L2641.0571,637.8418 L2641.0571,640 L2633.6777,640 L2633.6777,637.8418 L2636.1431,637.8418 L2636.1431,629.7651 Z " fill="#000000"/><ellipse cx="2663.25" cy="633.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="230" x="2669.25" y="639.291">LegacyControlledWriteOperations</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2254" x2="3271" y1="650" y2="650"/><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2254" x2="3271" y1="658" y2="658"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="349" x="2259" y="675.5352">prepareWriteSamParamters(byte[] parametersData)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="496" x="2259" y="692.0234">prepareWriteCaadRecord(int caadRecordReference 1..7, byte[] caadData)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2259" y="708.5117"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="923" x="2259" y="725">prepareWriteTransferredCipheredSystemKey(LegacySystemKey sourceWorkKeyKif, byte sourceWorkKeyKvc, byte cipheringSytemKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="783" x="2259" y="741.4883">prepareWriteTransferredPlainWorkKey(byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1007" x="2259" y="757.9766">prepareWriteTransferredCipheredWorkKey(byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSytemKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2259" y="774.4648"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="498" x="2259" y="790.9531">prepareWriteCounterCeiling(int counterReference 0..26, int ceilingValue)</text></g><!--MD5=[3f3ee671e4428f6d159120a04fa4b917]
class LegacyFreeSamTransaction--><g id="elem_LegacyFreeSamTransaction"><rect codeLine="134" fill="#FEFECE" height="64.4883" id="LegacyFreeSamTransaction" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="617" x="7" y="890"/><ellipse cx="212.75" cy="906" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M208.6777,901.7651 L208.6777,899.6069 L216.0571,899.6069 L216.0571,901.7651 L213.5918,901.7651 L213.5918,909.8418 L216.0571,909.8418 L216.0571,912 L208.6777,912 L208.6777,909.8418 L211.1431,909.8418 L211.1431,901.7651 Z " fill="#000000"/><ellipse cx="238.25" cy="905.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="186" x="244.25" y="911.291">LegacyFreeSamTransaction</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="8" x2="623" y1="922" y2="922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="605" x="13" y="939.5352">-- processCommand of 'prepared' LegacyReadOperations or LegacyFreeWriteOperations</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="8" x2="623" y1="946.4883" y2="946.4883"/></g><!--MD5=[06bce2fd609623e6109174927b842c22]
class LegacySecureReadTransaction--><g id="elem_LegacySecureReadTransaction"><rect codeLine="138" fill="#FEFECE" height="97.4648" id="LegacySecureReadTransaction" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="572" x="659.5" y="873.5"/><ellipse cx="832.25" cy="889.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M828.1777,885.2651 L828.1777,883.1069 L835.5571,883.1069 L835.5571,885.2651 L833.0918,885.2651 L833.0918,893.3418 L835.5571,893.3418 L835.5571,895.5 L828.1777,895.5 L828.1777,893.3418 L830.6431,893.3418 L830.6431,885.2651 Z " fill="#000000"/><ellipse cx="857.75" cy="889" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="207" x="863.75" y="894.791">LegacySecureReadTransaction</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="660.5" x2="1230.5" y1="905.5" y2="905.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="560" x="665.5" y="923.0352">-- setting of transaction challenge provided by the terminal or by the control SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="395" x="665.5" y="939.5234">-- processCommand of 'prepared' LegacyReadOperations</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="497" x="665.5" y="956.0117">-- for each read in the target SAM, the control SAM checks the certificate</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="660.5" x2="1230.5" y1="962.9648" y2="962.9648"/></g><!--MD5=[7be646112f0640912a7e9060a9bcdacf]
class LegacySecureSynchronousWriteTransaction--><g id="elem_LegacySecureSynchronousWriteTransaction"><rect codeLine="144" fill="#FEFECE" height="64.4883" id="LegacySecureSynchronousWriteTransaction" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="481" x="1267" y="890"/><ellipse cx="1349.25" cy="906" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1345.1777,901.7651 L1345.1777,899.6069 L1352.5571,899.6069 L1352.5571,901.7651 L1350.0918,901.7651 L1350.0918,909.8418 L1352.5571,909.8418 L1352.5571,912 L1345.1777,912 L1345.1777,909.8418 L1347.6431,909.8418 L1347.6431,901.7651 Z " fill="#000000"/><ellipse cx="1374.75" cy="905.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="297" x="1380.75" y="911.291">LegacySecureSynchronousWriteTransaction</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1268" x2="1747" y1="922" y2="922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="469" x="1273" y="939.5352">-- processCommand of 'prepared' LegacyControlledWriteOperations</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1268" x2="1747" y1="946.4883" y2="946.4883"/></g><!--MD5=[0094765b657ca55dd4fb55719fea01f2]
class LegacySecureAsynchronousWriteTransaction--><g id="elem_LegacySecureAsynchronousWriteTransaction"><rect codeLine="151" fill="#FEFECE" height="80.9766" id="LegacySecureAsynchronousWriteTransaction" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="552" x="1783.5" y="881.5"/><ellipse cx="1896.75" cy="897.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1892.6777,893.2651 L1892.6777,891.1069 L1900.0571,891.1069 L1900.0571,893.2651 L1897.5918,893.2651 L1897.5918,901.3418 L1900.0571,901.3418 L1900.0571,903.5 L1892.6777,903.5 L1892.6777,901.3418 L1895.1431,901.3418 L1895.1431,893.2651 Z " fill="#000000"/><ellipse cx="1922.25" cy="897" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="306" x="1928.25" y="902.791">LegacySecureAsynchronousWriteTransaction</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1784.5" x2="2334.5" y1="913.5" y2="913.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="540" x="1789.5" y="931.0352">-- processCommand of 'exported' cipheredSamOperations from a control SAM</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1784.5" x2="2334.5" y1="937.9883" y2="937.9883"/><ellipse cx="1794.5" cy="951.7324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="504" x="1803.5" y="955.5234">prepareImportCipheredDataToStaticWrite(String cipheredSamOperations)</text></g><!--MD5=[877f89e94ddd403ea137eeaf4f94efc0]
class LegacyControlAsynchronousWriteTransaction--><g id="elem_LegacyControlAsynchronousWriteTransaction"><rect codeLine="157" fill="#FEFECE" height="126.4414" id="LegacyControlAsynchronousWriteTransaction" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="393" x="2371" y="859"/><ellipse cx="2403.1" cy="875" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M2399.0277,870.7651 L2399.0277,868.6069 L2406.4071,868.6069 L2406.4071,870.7651 L2403.9418,870.7651 L2403.9418,878.8418 L2406.4071,878.8418 L2406.4071,881 L2399.0277,881 L2399.0277,878.8418 L2401.4931,878.8418 L2401.4931,870.7651 Z " fill="#000000"/><ellipse cx="2425.9" cy="874.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="312" x="2431.9" y="880.291">LegacyControlAsynchronousWriteTransaction</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="2372" x2="2763" y1="891" y2="891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="244" x="2391" y="908.5352">-- with Pseudo Random OR without</text><ellipse cx="2382" cy="921.2324" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="367" x="2391" y="925.0234">prepareGiveTargetSamPseudoRandom(statisRandom)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="2391" y="941.5117"> </text><ellipse cx="2382" cy="974.6973" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="359" x="2391" y="978.4883">String processExportSamCipheredDataToSamWrite()</text><line style="stroke:#D4AC0D;stroke-width:1.0;" x1="2372" x2="2407" y1="956.709" y2="956.709"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="321" x="2407" y="961.5">of 'prepared' LegacyControlledWriteOperations</text><line style="stroke:#D4AC0D;stroke-width:1.0;" x1="2728" x2="2763" y1="956.709" y2="956.709"/></g><!--MD5=[e03f89a752fbdcb3c3f445d1b9b91b82]
class OpenSamTransactionManager--><g id="elem_OpenSamTransactionManager"><rect codeLine="165" fill="#FEFECE" height="64.4883" id="OpenSamTransactionManager" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="250" x="1672.5" y="676"/><ellipse cx="1687.5" cy="692" fill="#B4A7E5" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1683.4277,687.7651 L1683.4277,685.6069 L1690.8071,685.6069 L1690.8071,687.7651 L1688.3418,687.7651 L1688.3418,695.8418 L1690.8071,695.8418 L1690.8071,698 L1683.4277,698 L1683.4277,695.8418 L1685.8931,695.8418 L1685.8931,687.7651 Z " fill="#000000"/><ellipse cx="1706.5" cy="691.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="207" x="1712.5" y="697.291">OpenSamTransactionManager</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1673.5" x2="1921.5" y1="708" y2="708"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="1678.5" y="725.5352">????</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1673.5" x2="1921.5" y1="732.4883" y2="732.4883"/></g><!--MD5=[f8fcf97036e110e8fdaf2cc17508308c]
class LegacySytemKey--><g id="elem_LegacySytemKey"><rect codeLine="180" fill="#FEFECE" height="113.9531" id="LegacySytemKey" rx="2.5" ry="2.5" style="stroke:#D4AC0D;stroke-width:2.0;" width="154" x="1066.5" y="331"/><ellipse cx="1081.5" cy="347" fill="#EB937F" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1085.6143,353 L1077.8945,353 L1077.8945,340.6069 L1085.6143,340.6069 L1085.6143,342.7651 L1080.3433,342.7651 L1080.3433,345.438 L1085.1162,345.438 L1085.1162,347.5962 L1080.3433,347.5962 L1080.3433,350.8418 L1085.6143,350.8418 Z " fill="#000000"/><ellipse cx="1100.5" cy="346.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1106.5" y="352.291">LegacySytemKey</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1067.5" x2="1219.5" y1="363" y2="363"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="1072.5" y="380.5352">PERSONALIZATION</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="1072.5" y="397.0234">WORK_FILE</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1072.5" y="413.5117">RELOADING</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="1072.5" y="430">AUTHENTICATION</text><line style="stroke:#D4AC0D;stroke-width:2.0;" x1="1067.5" x2="1219.5" y1="436.9531" y2="436.9531"/></g><!--MD5=[da768b3c975bb565e6088b349ae89e2a]
reverse link CalypsoSam to LegacySam--><g id="link_CalypsoSam_LegacySam"><path d="M1063.43,134.38 C1029.81,161.09 983.77,197.67 937.17,234.7 " fill="none" id="CalypsoSam-backto-LegacySam" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1059.34,128.69,1079.35,121.73,1068.05,139.65,1059.34,128.69" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[3c9b475e2700f2e5f333b2777b638756]
reverse link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="82" d="M738.05,556.31 C738.06,567.03 738.2,577.67 738.5,588 C738.94,603 739.69,619.04 740.55,634.34 " fill="none" id="LegacySam-backto-SamProductType" style="stroke:#181818;stroke-width:2.0;"/><ellipse cx="738.0919" cy="549.0999" fill="#FFFFFF" rx="8" ry="8" style="stroke:#181818;stroke-width:2.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="738.0538" x2="738.13" y1="557.0998" y2="541.1"/><line style="stroke:#181818;stroke-width:2.0;" x1="730.092" x2="746.0918" y1="549.0618" y2="549.138"/></g><!--MD5=[5ecd342ac4874d804146f75452da1973]
link LegacySam to SamProductType--><g id="link_LegacySam_SamProductType"><path codeLine="83" d="M745.5,541.01 C745.5,571.55 745.5,602.44 745.5,629.15 " fill="none" id="LegacySam-to-SamProductType" style="stroke:#3498DB;stroke-width:2.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="745.5,634.43,749.5,625.43,745.5,629.43,741.5,625.43,745.5,634.43" style="stroke:#3498DB;stroke-width:2.0;"/><polygon fill="#000000" points="750.5,584.6553,753.4389,575.6102,747.5611,575.6102,750.5,584.6553" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="759.5" y="584.5684">provide</text></g><!--MD5=[a2e087694e4122078e4d56adf538d41e]
reverse link CalypsoSam to OpenSam--><g id="link_CalypsoSam_OpenSam"><path d="M1155.26,136.63 C1179.79,164.18 1211.43,200.9 1237.5,235 C1266.64,273.11 1297.11,318.95 1317.28,350.25 " fill="none" id="CalypsoSam-backto-OpenSam" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1149.88,141.12,1141.74,121.56,1160.3,131.77,1149.88,141.12" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[d797ff1dc764dc8d6ac7a284e740df54]
reverse link CommonTransactionManager to SamTransactionManager--><g id="link_CommonTransactionManager_SamTransactionManager"><path d="M1652.5,194.2 C1652.5,246.93 1652.5,308.39 1652.5,347.49 " fill="none" id="CommonTransactionManager-backto-SamTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1645.5,194.12,1652.5,174.12,1659.5,194.12,1645.5,194.12" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[220e8a0b061c8bca5ed98fff8a9626e6]
reverse link SamTransactionManager to LegacySamTransactionManager--><g id="link_SamTransactionManager_LegacySamTransactionManager"><path d="M1626.12,446.86 C1595.41,514.21 1545.83,622.94 1521.66,675.95 " fill="none" id="SamTransactionManager-backto-LegacySamTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1619.76,443.93,1634.43,428.63,1632.5,449.73,1619.76,443.93" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[b46b2752ac07c172f8018ed5476dc11e]
reverse link LegacySamOperations to LegacyReadOperations--><g id="link_LegacySamOperations_LegacyReadOperations"><path d="M2220.19,133 C2194.81,173.13 2154.74,236.46 2120.97,289.84 " fill="none" id="LegacySamOperations-backto-LegacyReadOperations" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2214.3,129.23,2230.9,116.07,2226.13,136.71,2214.3,129.23" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[f2da51dc3dd5d3373a402c2a4731bbcd]
reverse link LegacySamOperations to LegacyFreeWriteOperations--><g id="link_LegacySamOperations_LegacyFreeWriteOperations"><path d="M2303.63,126.05 C2399.38,180.51 2589.91,288.85 2692.77,347.35 " fill="none" id="LegacySamOperations-backto-LegacyFreeWriteOperations" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2299.99,132.04,2286.07,116.07,2306.91,119.87,2299.99,132.04" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[3062e0bfdcd5432071ab2c973cc620ff]
reverse link LegacyFreeWriteOperations to LegacyControlledWriteOperations--><g id="link_LegacyFreeWriteOperations_LegacyControlledWriteOperations"><path d="M2762.5,448.67 C2762.5,496.27 2762.5,563.68 2762.5,617.7 " fill="none" id="LegacyFreeWriteOperations-backto-LegacyControlledWriteOperations" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="2755.5,448.63,2762.5,428.63,2769.5,448.63,2755.5,448.63" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[1ffd2cf5744e967b1e08588e9429d5ff]
reverse link LegacySamTransactionManager to LegacyFreeSamTransaction--><g id="link_LegacySamTransactionManager_LegacyFreeSamTransaction"><path d="M1357.96,734.13 C1185.24,763.34 892.59,813.38 641.5,859 C587.51,868.81 528.56,879.9 475.83,889.97 " fill="none" id="LegacySamTransactionManager-backto-LegacyFreeSamTransaction" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1357.02,727.19,1377.9,730.76,1359.35,741,1357.02,727.19" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[2af003dd7eeb41a0b753ba997070de31]
reverse link LegacySamTransactionManager to LegacySecureReadTransaction--><g id="link_LegacySamTransactionManager_LegacySecureReadTransaction"><path d="M1406.18,747.22 C1312.33,782.62 1172.45,835.39 1071.46,873.49 " fill="none" id="LegacySamTransactionManager-backto-LegacySecureReadTransaction" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1403.99,740.56,1425.18,740.05,1408.94,753.66,1403.99,740.56" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[01323dece8ff84fbded4cdd876a65f9d]
reverse link LegacySamTransactionManager to LegacySecureSynchronousWriteTransaction--><g id="link_LegacySamTransactionManager_LegacySecureSynchronousWriteTransaction"><path d="M1507.5,760.48 C1507.5,800.93 1507.5,855.95 1507.5,889.94 " fill="none" id="LegacySamTransactionManager-backto-LegacySecureSynchronousWriteTransaction" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1500.5,760.28,1507.5,740.28,1514.5,760.28,1500.5,760.28" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[029452c1f2bdb91cb082488dcef73305]
reverse link LegacySamTransactionManager to LegacySecureAsynchronousWriteTransaction--><g id="link_LegacySamTransactionManager_LegacySecureAsynchronousWriteTransaction"><path d="M1569.12,751.02 C1594.74,767.23 1625.28,784.96 1654.5,798 C1731.67,832.43 1821.24,860.75 1896.49,881.5 " fill="none" id="LegacySamTransactionManager-backto-LegacySecureAsynchronousWriteTransaction" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1565.24,756.85,1552.24,740.12,1572.84,745.09,1565.24,756.85" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[cac2056cc6e228a5033a5e2a7130824e]
reverse link LegacySamTransactionManager to LegacyControlAsynchronousWriteTransaction--><g id="link_LegacySamTransactionManager_LegacyControlAsynchronousWriteTransaction"><path d="M1564.1,751.64 C1590.25,769.07 1622.55,787.56 1654.5,798 C1950.51,894.71 2046.35,802.04 2352.5,859 C2358.52,860.12 2364.6,861.34 2370.73,862.63 " fill="none" id="LegacySamTransactionManager-backto-LegacyControlAsynchronousWriteTransaction" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1559.94,757.27,1547.46,740.15,1567.89,745.76,1559.94,757.27" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[7367849fb3c240a0687fb0808b49b7b0]
reverse link SamTransactionManager to OpenSamTransactionManager--><g id="link_SamTransactionManager_OpenSamTransactionManager"><path d="M1678.88,446.86 C1709.59,514.21 1759.17,622.94 1783.34,675.95 " fill="none" id="SamTransactionManager-backto-OpenSamTransactionManager" style="stroke:#181818;stroke-width:2.0;"/><polygon fill="none" points="1672.5,449.73,1670.57,428.63,1685.24,443.93,1672.5,449.73" style="stroke:#181818;stroke-width:2.0;"/></g><!--MD5=[29070a166398ad0c3b0f0af50e112d61]
reverse link LegacySam to LegacySytemKey--><g id="link_LegacySam_LegacySytemKey"><path codeLine="187" d="M1009.93,388 C1030.06,388 1049.19,388 1066.35,388 " fill="none" id="LegacySam-backto-LegacySytemKey" style="stroke:#27AE60;stroke-width:2.0;"/><ellipse cx="1002.73" cy="388" fill="#FFFFFF" rx="8" ry="8" style="stroke:#27AE60;stroke-width:2.0;"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="1010.73" x2="994.73" y1="388" y2="388"/><line style="stroke:#27AE60;stroke-width:2.0;" x1="1002.73" x2="1002.73" y1="396" y2="380"/><polygon fill="#000000" points="1022,376.6553,1012.9549,373.7163,1012.9549,379.5942,1022,376.6553" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="1026" y="381.5684">use</text></g><!--MD5=[9f733bd88bba69dd5a504b714ed56d32]
@startuml

' == THEME ==

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_GREY1 F8F9F9
!define C_GREY2 F2F3F4
!define C_GREY3 E5E7E9
!define C_GREY4 D7DBDD
!define C_GREY5 CACFD2
!define C_GREY6 BDC3C7
!define C_LINK 3498DB
!define C_USE 27AE60

' - - Styles that don't work with new version of plantuml - -
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
' - - END - -

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

' Yellow
skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

' == CONTENT ==

        +interface "<<<back:yellow>SmartCard</back>>>\nCalypsoSam" as CalypsoSam {

        }

        +interface "<<<back:yellow>CalypsoSam</back>>>\nLegacySam" as LegacySam extends CalypsoSam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

           +int getEventCounterValue(int numCounter 0..8)
           +int getEventCeilingValue(int numCounter 0..8)
           +byte[] getSystemKeyParameters(LegacySytemKey systemKeyRefeence)
           +byte[] getWorkKeyParameters(int numWorkKey 1..126)

        }

        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            CSAM_F
            UNKNOWN
        }

        LegacySam +- - SamProductType
        LegacySam ..> SamProductType #C_LINK : provide >

        +interface "<<<back:yellow>CalypsoSam</back>>>\nOpenSam" as OpenSam  extends CalypsoSam {
            ????

        }

        +interface SamTransactionManager extends CommonTransactionManager {
            +<back:yellow>CardReader</back> getSamReader ()
            +CalypsoSam getCalypsoSam ()
        }

        +interface LegacySamTransactionManager extends SamTransactionManager {
            ????

        }


        +interface LegacySamOperations {
        }

        +interface LegacyReadOperations extends LegacySamOperations {
            prepareReadSamParamters()
            prepareReadCaadRecord(int caadRecordReference 1..7)

            prepareReadSystemKeyParamters(LegacySystemKey systemKeyReference)
            prepareReadWorkKeyParamters(int workKeyRecordNumber 1..126)
            prepareReadWorkKeyParamters(byte workKeyKif, byte workKeyKvc)

            prepareReadCounterValue(int counterReference 0..26)
            prepareReadCounterCeiling(int counterReference 0..26)
        }


        +interface LegacyFreeWriteOperations extends LegacySamOperations {
            prepareWriteExternalPlainWorkKey(byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            prepareWriteRandomlyGeneratedWorkKey(byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }

        +interface LegacyControlledWriteOperations extends LegacyFreeWriteOperations {
            prepareWriteSamParamters(byte[] parametersData)
            prepareWriteCaadRecord(int caadRecordReference 1..7, byte[] caadData)

            prepareWriteTransferredCipheredSystemKey(LegacySystemKey sourceWorkKeyKif, byte sourceWorkKeyKvc, byte cipheringSytemKeyKvc)
            prepareWriteTransferredPlainWorkKey(byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            prepareWriteTransferredCipheredWorkKey(byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSytemKeyKvc)

            prepareWriteCounterCeiling(int counterReference 0..26, int ceilingValue)
        }


        +interface LegacyFreeSamTransaction extends LegacySamTransactionManager {
        - - processCommand of 'prepared' LegacyReadOperations or LegacyFreeWriteOperations
        }

        +interface LegacySecureReadTransaction extends LegacySamTransactionManager {
        - - setting of transaction challenge provided by the terminal or by the control SAM
        - - processCommand of 'prepared' LegacyReadOperations
        - - for each read in the target SAM, the control SAM checks the certificate
        }

        +interface LegacySecureSynchronousWriteTransaction extends LegacySamTransactionManager {
'            +prepareManageSecureWrite(flag dynamic/static)
'            +prepareWriteCeiling()
'            +prepareImportCipheredDataToStaticWrite(String ciphereData)
        - - processCommand of 'prepared' LegacyControlledWriteOperations
        }

        +interface LegacySecureAsynchronousWriteTransaction extends LegacySamTransactionManager {
        +prepareImportCipheredDataToStaticWrite(String cipheredSamOperations)
        - - processCommand of 'exported' cipheredSamOperations from a control SAM
        }


        +interface LegacyControlAsynchronousWriteTransaction extends LegacySamTransactionManager {
            - - with Pseudo Random OR without
            +prepareGiveTargetSamPseudoRandom(statisRandom)

            - - of 'prepared' LegacyControlledWriteOperations - -
            +String processExportSamCipheredDataToSamWrite()
        }

        +interface OpenSamTransactionManager extends SamTransactionManager {
            ????

        }

'        +interface LegacySamReadOperation {
'            LegacySamReadOperation +prepareReadSystemKeyParameters(LegacySytemKey keyUsage)
'            LegacySamReadOperation +prepareReadWorkKeyParameters(byte kif, byte kvc)
'            LegacySamReadOperation +prepareReadWorkKeyParameters(int keyRecord 1..126)
'
'            LegacySamReadOperation +prepareReadEventCounter(int counterNumber 0..26)
'            LegacySamReadOperation +prepareReadCounterLimit(int counterNumber 0..26)
'
'        }

        +enum LegacySytemKey {
            PERSONALIZATION
            WORK_FILE
            RELOADING
            AUTHENTICATION
        }

        LegacySam +- LegacySytemKey #C_USE : use >

        +interface CommonTransactionManager<T extends CommonTransactionManager<T, S>,\nS extends CommonSecuritySetting<S>> {
            +S getSecuritySetting ()
            +List<byte[]> getTransactionAuditData ()

            +T prepareComputeSignature (CommonSignatureComputationData<?> data)
            +T prepareVerifySignature (CommonSignatureVerificationData<?> data)

            +T processCommands ()
        }

@enduml

@startuml



skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype


        +interface "<<<back:yellow>SmartCard</back>>>\nCalypsoSam" as CalypsoSam {

        }

        +interface "<<<back:yellow>CalypsoSam</back>>>\nLegacySam" as LegacySam extends CalypsoSam {
            +ProductType getProductType ()
            +String getProductInfo ()

            +byte[] getSerialNumber ()
            +byte getPlatform ()
            +byte getApplicationType ()
            +byte getApplicationSubType ()
            +byte getSoftwareIssuer ()
            +byte getSoftwareVersion ()
            +byte getSoftwareRevision ()

           +int getEventCounterValue(int numCounter 0..8)
           +int getEventCeilingValue(int numCounter 0..8)
           +byte[] getSystemKeyParameters(LegacySytemKey systemKeyRefeence)
           +byte[] getWorkKeyParameters(int numWorkKey 1..126)

        }

        +enum "ProductType" as SamProductType {
            SAM_C1
            HSM_C1
            SAM_S1E1
            SAM_S1Dx
            CSAM_F
            UNKNOWN
        }

        LegacySam +- - SamProductType
        LegacySam ..> SamProductType #3498DB : provide >

        +interface "<<<back:yellow>CalypsoSam</back>>>\nOpenSam" as OpenSam  extends CalypsoSam {
            ????

        }

        +interface SamTransactionManager extends CommonTransactionManager {
            +<back:yellow>CardReader</back> getSamReader ()
            +CalypsoSam getCalypsoSam ()
        }

        +interface LegacySamTransactionManager extends SamTransactionManager {
            ????

        }


        +interface LegacySamOperations {
        }

        +interface LegacyReadOperations extends LegacySamOperations {
            prepareReadSamParamters()
            prepareReadCaadRecord(int caadRecordReference 1..7)

            prepareReadSystemKeyParamters(LegacySystemKey systemKeyReference)
            prepareReadWorkKeyParamters(int workKeyRecordNumber 1..126)
            prepareReadWorkKeyParamters(byte workKeyKif, byte workKeyKvc)

            prepareReadCounterValue(int counterReference 0..26)
            prepareReadCounterCeiling(int counterReference 0..26)
        }


        +interface LegacyFreeWriteOperations extends LegacySamOperations {
            prepareWriteExternalPlainWorkKey(byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters, byte[] workKeyValue)
            prepareWriteRandomlyGeneratedWorkKey(byte workKeyKif, byte workKeyKvc, byte[] workKeyParameters)
        }

        +interface LegacyControlledWriteOperations extends LegacyFreeWriteOperations {
            prepareWriteSamParamters(byte[] parametersData)
            prepareWriteCaadRecord(int caadRecordReference 1..7, byte[] caadData)

            prepareWriteTransferredCipheredSystemKey(LegacySystemKey sourceWorkKeyKif, byte sourceWorkKeyKvc, byte cipheringSytemKeyKvc)
            prepareWriteTransferredPlainWorkKey(byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters)
            prepareWriteTransferredCipheredWorkKey(byte sourceWorkKeyKif, byte sourceWorkKeyKvc, byte[] workKeyParameters, byte cipheringSytemKeyKvc)

            prepareWriteCounterCeiling(int counterReference 0..26, int ceilingValue)
        }


        +interface LegacyFreeSamTransaction extends LegacySamTransactionManager {
        - - processCommand of 'prepared' LegacyReadOperations or LegacyFreeWriteOperations
        }

        +interface LegacySecureReadTransaction extends LegacySamTransactionManager {
        - - setting of transaction challenge provided by the terminal or by the control SAM
        - - processCommand of 'prepared' LegacyReadOperations
        - - for each read in the target SAM, the control SAM checks the certificate
        }

        +interface LegacySecureSynchronousWriteTransaction extends LegacySamTransactionManager {
        - - processCommand of 'prepared' LegacyControlledWriteOperations
        }

        +interface LegacySecureAsynchronousWriteTransaction extends LegacySamTransactionManager {
        +prepareImportCipheredDataToStaticWrite(String cipheredSamOperations)
        - - processCommand of 'exported' cipheredSamOperations from a control SAM
        }


        +interface LegacyControlAsynchronousWriteTransaction extends LegacySamTransactionManager {
            - - with Pseudo Random OR without
            +prepareGiveTargetSamPseudoRandom(statisRandom)

            - - of 'prepared' LegacyControlledWriteOperations - -
            +String processExportSamCipheredDataToSamWrite()
        }

        +interface OpenSamTransactionManager extends SamTransactionManager {
            ????

        }


        +enum LegacySytemKey {
            PERSONALIZATION
            WORK_FILE
            RELOADING
            AUTHENTICATION
        }

        LegacySam +- LegacySytemKey #27AE60 : use >

        +interface CommonTransactionManager<T extends CommonTransactionManager<T, S>,\nS extends CommonSecuritySetting<S>> {
            +S getSecuritySetting ()
            +List<byte[]> getTransactionAuditData ()

            +T prepareComputeSignature (CommonSignatureComputationData<?> data)
            +T prepareVerifySignature (CommonSignatureVerificationData<?> data)

            +T processCommands ()
        }

@enduml

PlantUML version 1.2022.7(Mon Aug 22 21:01:30 RET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>