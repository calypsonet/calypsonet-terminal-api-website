<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3677px" preserveAspectRatio="none" style="width:1450px;height:3677px;background:#FFFFFF;" version="1.1" viewBox="0 0 1450 3677" width="1450px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="268.6582"/><rect fill="#FFC0CB" height="100.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="801.6055"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1198.5527"/><rect fill="#FFC0CB" height="855.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1243.8438"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2199.6113"/><rect fill="#FFC0CB" height="1331.2227" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2244.9023"/><rect fill="#FFC0CB" height="456.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="313.9492"/><rect fill="#ADD8E6" height="341.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="397.1133"/><rect fill="#ADD8E6" height="449.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1514.7539"/><rect fill="#ADD8E6" height="308.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2955.7227"/><rect fill="#ADD8E6" height="2804.3555" style="stroke:#181818;stroke-width:1.0;" width="10" x="1064" y="428.4043"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1147.5" y="1309.7168"/><rect fill="#90EE90" height="534.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="1147.5" y="2355.0664"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1147.5" y="3329.9238"/><rect fill="#90EE90" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="1388.5" y="93.6211"/><rect fill="none" height="144.4551" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="751" y="564.2773"/><rect fill="none" height="404.0742" style="stroke:#000000;stroke-width:1.5;" width="498.5" x="605" y="1529.7539"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="339.5" x="1093.5" y="2641.8125"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="751" y="2970.7227"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="386" x2="386" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624" x2="624" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="811" x2="811" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1068.5" x2="1068.5" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1152.5" x2="1152.5" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1393" x2="1393" y1="83.6211" y2="3594.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="3608.2324">Ticketing Application</text><ellipse cx="73" cy="3620.2461" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,3628.2461 L73,3655.2461 M60,3636.2461 L86,3636.2461 M73,3655.2461 L60,3670.2461 M73,3655.2461 L86,3670.2461 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="3615.2324">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="581" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="588" y="72.1074">Reader API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="581" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="588" y="3615.2324">Reader API</text><rect fill="#ADD8E6" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="761" y="12.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="784" y="34.8652">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="768" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="787.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="761" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="784" y="3615.2324">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="768" y="3633.8535">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="787.5" y="3652.4746">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1049.5" y="80.1074">Card</text><path d="M1048.5,37 L1048.5,61 M1048.5,49 L1065.5,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1077.5" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1049.5" y="3608.2324">Card</text><path d="M1048.5,3615.7461 L1048.5,3639.7461 M1048.5,3627.7461 L1065.5,3627.7461 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1077.5" cy="3627.7461" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1103.5" y="12.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1125.5" y="34.8652">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1110.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1129" y="72.1074">Reader</text><rect fill="#90EE90" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1103.5" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1125.5" y="3615.2324">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1110.5" y="3633.8535">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1129" y="3652.4746">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1364" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1375" y="80.1074">SAM</text><path d="M1373,18.3789 L1373,42.3789 M1373,30.3789 L1390,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1402" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1364" y="3608.2324">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1375" y="3626.8535">SAM</text><path d="M1373,3634.3672 L1373,3658.3672 M1373,3646.3672 L1390,3646.3672 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1402" cy="3646.3672" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="268.6582"/><rect fill="#FFC0CB" height="100.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="801.6055"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1198.5527"/><rect fill="#FFC0CB" height="855.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1243.8438"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2199.6113"/><rect fill="#FFC0CB" height="1331.2227" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2244.9023"/><rect fill="#FFC0CB" height="456.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="313.9492"/><rect fill="#ADD8E6" height="341.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="397.1133"/><rect fill="#ADD8E6" height="449.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1514.7539"/><rect fill="#ADD8E6" height="308.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2955.7227"/><rect fill="#ADD8E6" height="2804.3555" style="stroke:#181818;stroke-width:1.0;" width="10" x="1064" y="428.4043"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1147.5" y="1309.7168"/><rect fill="#90EE90" height="534.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="1147.5" y="2355.0664"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1147.5" y="3329.9238"/><rect fill="#90EE90" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="1388.5" y="93.6211"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1443" x="0" y="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1443" y1="115.2666" y2="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1443" y1="118.2666" y2="118.2666"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="209" x="617" y="103.6211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="191" x="623" y="121.6494">Card selection &amp; identification</text><path d="M188,143.9121 L188,170.9121 L584,170.9121 L584,153.9121 L574,143.9121 L188,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M574,143.9121 L574,153.9121 L584,153.9121 L574,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375" x="194" y="162.9404">Reads the data present in all the cards targeted for the selection.</text><polygon fill="#181818" points="369,264.6582,379,268.6582,369,272.6582,373,268.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="268.6582" y2="268.6582"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="194.2314">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="139" y="194.2314">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="117" y="211.5225">- filter by specific AID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="117" y="228.8135">- filter invalidated card status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="246.1045">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="117" y="263.3955">- read contract list</text><polygon fill="#181818" points="89,278.6582,79,282.6582,89,286.6582,85,282.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="282.6582" y2="282.6582"/><polygon fill="#181818" points="607,309.9492,617,313.9492,607,317.9492,611,313.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="613" y1="313.9492" y2="313.9492"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="308.6865">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="137" y="308.6865">explicit card selection scenario</text><polygon fill="#0000FF" points="794,393.1133,804,397.1133,794,401.1133,798,397.1133" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="629" x2="800" y1="397.1133" y2="397.1133"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="636" y="339.9775">Card #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="636" y="357.2686">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="668" y="374.5596">- card selector</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="668" y="391.8506">- APDU list</text><polygon fill="#181818" points="1052,424.4043,1062,428.4043,1052,432.4043,1056,428.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="428.4043" y2="428.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="823" y="423.1416">open card channel</text><polygon fill="#181818" points="827,438.4043,817,442.4043,827,446.4043,823,442.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="442.4043" y2="442.4043"/><polygon fill="#181818" points="1052,469.6953,1062,473.6953,1052,477.6953,1056,473.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="473.6953" y2="473.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="823" y="468.4326">select application (aid)</text><polygon fill="#181818" points="827,500.9863,817,504.9863,827,508.9863,823,504.9863" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="504.9863" y2="504.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="833" y="499.7236">[card FCI]</text><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="858" y1="536.2773" y2="536.2773"/><line style="stroke:#181818;stroke-width:1.0;" x1="858" x2="858" y1="536.2773" y2="549.2773"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="858" y1="549.2773" y2="549.2773"/><polygon fill="#181818" points="827,545.2773,817,549.2773,827,553.2773,823,549.2773" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="823" y="531.0146">checks invalidation status</text><path d="M751,564.2773 L1085,564.2773 L1085,573.5684 L1075,583.5684 L751,583.5684 L751,564.2773 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="144.4551" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="751" y="564.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="289" x="766" y="579.3057">Card APDU commands outside secure session</text><polygon fill="#181818" points="1052,602.8594,1062,606.8594,1052,610.8594,1056,606.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="606.8594" y2="606.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="823" y="601.5967">read record (environment)</text><polygon fill="#181818" points="827,634.1504,817,638.1504,827,642.1504,823,638.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="638.1504" y2="638.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="833" y="632.8877">[environment data]</text><polygon fill="#181818" points="1052,665.4414,1062,669.4414,1052,673.4414,1056,669.4414" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="669.4414" y2="669.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="823" y="664.1787">read record (contract list)</text><polygon fill="#181818" points="827,696.7324,817,700.7324,827,704.7324,823,700.7324" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="700.7324" y2="700.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="833" y="695.4697">[contract list data]</text><polygon fill="#0000FF" points="640,735.0234,630,739.0234,640,743.0234,636,739.0234" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="810" y1="739.0234" y2="739.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="646" y="733.7607">receive selection response</text><polygon fill="#181818" points="89,766.3145,79,770.3145,89,774.3145,85,770.3145" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="623" y1="770.3145" y2="770.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="95" y="765.0518">selected active SmartCard image</text><polygon fill="#181818" points="369,797.6055,379,801.6055,369,805.6055,373,801.6055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="801.6055" y2="801.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="85" y="796.3428">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="114" y="796.3428">Calypso card</text><polygon fill="#181818" points="89,898.0605,79,902.0605,89,906.0605,85,902.0605" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="902.0605" y2="902.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="827.6338">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="844.9248">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="862.2158">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="879.5068">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="896.7979">- contract list data]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1443" x="0" y="931.7061"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1443" y1="931.7061" y2="931.7061"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1443" y1="934.7061" y2="934.7061"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="168" x="637.5" y="920.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="643.5" y="938.0889">Card secure transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="1013.2246" y2="1013.2246"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="1013.2246" y2="1026.2246"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="1026.2246" y2="1026.2246"/><polygon fill="#181818" points="89,1022.2246,79,1026.2246,89,1030.2246,85,1026.2246" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="973.3799">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="973.3799">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="990.6709">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="1007.9619">- Calypso SAM resource</text><path d="M110,1039.2246 L110,1066.2246 L661,1066.2246 L661,1049.2246 L651,1039.2246 L110,1039.2246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M651,1039.2246 L651,1049.2246 L661,1049.2246 L651,1039.2246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="530" x="116" y="1058.2529">Reads again the environment file &amp; the contract list inside the session to authenticate them.</text><polygon fill="#181818" points="369,1194.5527,379,1198.5527,369,1202.5527,373,1198.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1198.5527" y2="1198.5527"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1089.5439">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="117" y="1106.835">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="1124.126">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="117" y="1141.417">- read contract list</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="1158.708">- read contract #x</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="1175.999">- read contract #y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="117" y="1193.29">- read counters</text><polygon fill="#181818" points="89,1208.5527,79,1212.5527,89,1216.5527,85,1212.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1212.5527" y2="1212.5527"/><polygon fill="#181818" points="369,1239.8438,379,1243.8438,369,1247.8438,373,1243.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1243.8438" y2="1243.8438"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1238.5811">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1238.5811">commands (keep channel open)</text><polygon fill="#00FF00" points="1135.5,1305.7168,1145.5,1309.7168,1135.5,1313.7168,1139.5,1309.7168" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1141.5" y1="1309.7168" y2="1309.7168"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="1269.8721">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1287.1631">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1304.4541">- APDU list</text><polygon fill="#181818" points="1376.5,1337.0078,1386.5,1341.0078,1376.5,1345.0078,1380.5,1341.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="1341.0078" y2="1341.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1164.5" y="1335.7451">select diversifier (card serial)</text><polygon fill="#181818" points="1168.5,1351.0078,1158.5,1355.0078,1168.5,1359.0078,1164.5,1355.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="1355.0078" y2="1355.0078"/><polygon fill="#181818" points="1376.5,1382.2988,1386.5,1386.2988,1376.5,1390.2988,1380.5,1386.2988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="1386.2988" y2="1386.2988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1164.5" y="1381.0361">get challenge</text><polygon fill="#181818" points="1168.5,1413.5898,1158.5,1417.5898,1168.5,1421.5898,1164.5,1417.5898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="1417.5898" y2="1417.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1174.5" y="1412.3271">[SAM challenge]</text><polygon fill="#00FF00" points="402,1444.8809,392,1448.8809,402,1452.8809,398,1448.8809" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1151.5" y1="1448.8809" y2="1448.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="408" y="1443.6182">[SAM challenge]</text><polygon fill="#0000FF" points="794,1510.7539,804,1514.7539,794,1518.7539,798,1514.7539" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="1514.7539" y2="1514.7539"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1474.9092">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1492.2002">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1509.4912">- APDU list</text><path d="M605,1529.7539 L885,1529.7539 L885,1539.0449 L875,1549.0449 L605,1549.0449 L605,1529.7539 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="404.0742" style="stroke:#000000;stroke-width:1.5;" width="498.5" x="605" y="1529.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="620" y="1544.7822">Card APDU commands inside session</text><path d="M615,1554.0449 L615,1581.0449 L1006,1581.0449 L1006,1564.0449 L996,1554.0449 L615,1554.0449 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M996,1554.0449 L996,1564.0449 L1006,1564.0449 L996,1554.0449 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370" x="621" y="1573.0732">Optimization: environment file read through the session opening.</text><polygon fill="#181818" points="1052,1640.209,1062,1644.209,1052,1648.209,1056,1644.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="1644.209" y2="1644.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="823" y="1604.3643">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="855" y="1621.6553">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="855" y="1638.9463">SFI environment to read)</text><polygon fill="#181818" points="827,1671.5,817,1675.5,827,1679.5,823,1675.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="1675.5" y2="1675.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="833" y="1670.2373">[card challenge &amp; environment data]</text><polygon fill="#181818" points="1052,1702.791,1062,1706.791,1052,1710.791,1056,1706.791" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="1706.791" y2="1706.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="823" y="1701.5283">read record (contract list)</text><polygon fill="#181818" points="827,1734.082,817,1738.082,827,1742.082,823,1738.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="1738.082" y2="1738.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="833" y="1732.8193">[contract list data]</text><polygon fill="#181818" points="1052,1765.373,1062,1769.373,1052,1773.373,1056,1769.373" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="1769.373" y2="1769.373"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="823" y="1764.1104">read record (contract #x)</text><polygon fill="#181818" points="827,1796.6641,817,1800.6641,827,1804.6641,823,1800.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="1800.6641" y2="1800.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="833" y="1795.4014">[contract #x data]</text><polygon fill="#181818" points="1052,1827.9551,1062,1831.9551,1052,1835.9551,1056,1831.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="1831.9551" y2="1831.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="823" y="1826.6924">read record (contract #y)</text><polygon fill="#181818" points="827,1859.2461,817,1863.2461,827,1867.2461,823,1863.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="1863.2461" y2="1863.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="833" y="1857.9834">[contract #y data]</text><polygon fill="#181818" points="1052,1890.5371,1062,1894.5371,1052,1898.5371,1056,1894.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="1894.5371" y2="1894.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="823" y="1889.2744">read record (counters)</text><polygon fill="#181818" points="827,1921.8281,817,1925.8281,827,1929.8281,823,1925.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="1925.8281" y2="1925.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="833" y="1920.5654">[counters data]</text><polygon fill="#0000FF" points="402,1960.1191,392,1964.1191,402,1968.1191,398,1964.1191" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="1964.1191" y2="1964.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="1958.8564">[card challenge]</text><polygon fill="#181818" points="89,2095.1563,79,2099.1563,89,2103.1563,85,2099.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2099.1563" y2="2099.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1990.1475">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2007.4385">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="127" y="2024.7295">- environment data (verified)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="127" y="2042.0205">- contract list data (verified)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="2059.3115">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="2076.6025">- contract #y data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="127" y="2093.8936">- counters data]</text><polygon fill="#181818" points="369,2195.6113,379,2199.6113,369,2203.6113,373,2199.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2199.6113" y2="2199.6113"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2125.1846">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="2125.1846">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="117" y="2142.4756">- update contract list (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="117" y="2159.7666">- update contract #x (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="2177.0576">- update counters (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="117" y="2194.3486">- close secure session (as ratified)</text><polygon fill="#181818" points="89,2209.6113,79,2213.6113,89,2217.6113,85,2213.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2213.6113" y2="2213.6113"/><polygon fill="#181818" points="369,2240.9023,379,2244.9023,369,2248.9023,373,2244.9023" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2244.9023" y2="2244.9023"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2239.6396">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2239.6396">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="2276.1934" y2="2276.1934"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="2276.1934" y2="2289.1934"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="2289.1934" y2="2289.1934"/><polygon fill="#181818" points="402,2285.1934,392,2289.1934,402,2293.1934,398,2289.1934" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="398" y="2270.9307">anticipates the future card responses</text><polygon fill="#00FF00" points="1135.5,2351.0664,1145.5,2355.0664,1135.5,2359.0664,1139.5,2355.0664" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1141.5" y1="2355.0664" y2="2355.0664"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2315.2217">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2332.5127">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2349.8037">- APDU list</text><polygon fill="#181818" points="1376.5,2382.3574,1386.5,2386.3574,1376.5,2390.3574,1380.5,2386.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2386.3574" y2="2386.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1164.5" y="2381.0947">digest init (opening data)</text><polygon fill="#181818" points="1168.5,2396.3574,1158.5,2400.3574,1168.5,2404.3574,1164.5,2400.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2400.3574" y2="2400.3574"/><polygon fill="#181818" points="1376.5,2427.6484,1386.5,2431.6484,1376.5,2435.6484,1380.5,2431.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2431.6484" y2="2431.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="1164.5" y="2426.3857">digest update (read environment)</text><polygon fill="#181818" points="1168.5,2441.6484,1158.5,2445.6484,1168.5,2449.6484,1164.5,2445.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2445.6484" y2="2445.6484"/><polygon fill="#181818" points="1376.5,2472.9395,1386.5,2476.9395,1376.5,2480.9395,1380.5,2476.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2476.9395" y2="2476.9395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="1164.5" y="2471.6768">digest update (read contract list)</text><polygon fill="#181818" points="1168.5,2486.9395,1158.5,2490.9395,1168.5,2494.9395,1164.5,2490.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2490.9395" y2="2490.9395"/><polygon fill="#181818" points="1376.5,2518.2305,1386.5,2522.2305,1376.5,2526.2305,1380.5,2522.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2522.2305" y2="2522.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1164.5" y="2516.9678">digest update (read contract #x)</text><polygon fill="#181818" points="1168.5,2532.2305,1158.5,2536.2305,1168.5,2540.2305,1164.5,2536.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2536.2305" y2="2536.2305"/><polygon fill="#181818" points="1376.5,2563.5215,1386.5,2567.5215,1376.5,2571.5215,1380.5,2567.5215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2567.5215" y2="2567.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1164.5" y="2562.2588">digest update (read contract #y)</text><polygon fill="#181818" points="1168.5,2577.5215,1158.5,2581.5215,1168.5,2585.5215,1164.5,2581.5215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2581.5215" y2="2581.5215"/><polygon fill="#181818" points="1376.5,2608.8125,1386.5,2612.8125,1376.5,2616.8125,1380.5,2612.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2612.8125" y2="2612.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1164.5" y="2607.5498">digest update (read counters)</text><polygon fill="#181818" points="1168.5,2622.8125,1158.5,2626.8125,1168.5,2630.8125,1164.5,2626.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2626.8125" y2="2626.8125"/><path d="M1093.5,2641.8125 L1350.5,2641.8125 L1350.5,2651.1035 L1340.5,2661.1035 L1093.5,2661.1035 L1093.5,2641.8125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="339.5" x="1093.5" y="2641.8125"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="1108.5" y="2656.8408">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1183.5" y="2656.8408">Card APDU responses</text><polygon fill="#181818" points="1376.5,2680.3945,1386.5,2684.3945,1376.5,2688.3945,1380.5,2684.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2684.3945" y2="2684.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="1164.5" y="2679.1318">digest update (update contract list)</text><polygon fill="#181818" points="1168.5,2694.3945,1158.5,2698.3945,1168.5,2702.3945,1164.5,2698.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2698.3945" y2="2698.3945"/><polygon fill="#181818" points="1376.5,2725.6855,1386.5,2729.6855,1376.5,2733.6855,1380.5,2729.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2729.6855" y2="2729.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1164.5" y="2724.4229">digest update (update contract #x)</text><polygon fill="#181818" points="1168.5,2739.6855,1158.5,2743.6855,1168.5,2747.6855,1164.5,2743.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2743.6855" y2="2743.6855"/><polygon fill="#181818" points="1376.5,2770.9766,1386.5,2774.9766,1376.5,2778.9766,1380.5,2774.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2774.9766" y2="2774.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="1164.5" y="2769.7139">digest update (update counters)</text><polygon fill="#181818" points="1168.5,2784.9766,1158.5,2788.9766,1168.5,2792.9766,1164.5,2788.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2788.9766" y2="2788.9766"/><polygon fill="#181818" points="1376.5,2823.2676,1386.5,2827.2676,1376.5,2831.2676,1380.5,2827.2676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="2827.2676" y2="2827.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1164.5" y="2822.0049">digest close</text><polygon fill="#181818" points="1168.5,2854.5586,1158.5,2858.5586,1168.5,2862.5586,1164.5,2858.5586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="2858.5586" y2="2858.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1174.5" y="2853.2959">[SAM certificate]</text><polygon fill="#00FF00" points="402,2885.8496,392,2889.8496,402,2893.8496,398,2889.8496" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1151.5" y1="2889.8496" y2="2889.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="408" y="2884.5869">[SAM certificate]</text><polygon fill="#0000FF" points="794,2951.7227,804,2955.7227,794,2959.7227,798,2955.7227" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="2955.7227" y2="2955.7227"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2915.8779">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2933.1689">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2950.46">- APDU list</text><path d="M751,2970.7227 L1031,2970.7227 L1031,2980.0137 L1021,2990.0137 L751,2990.0137 L751,2970.7227 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="751" y="2970.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="2985.751">Card APDU commands inside session</text><polygon fill="#181818" points="1052,3009.3047,1062,3013.3047,1052,3017.3047,1056,3013.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="3013.3047" y2="3013.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="823" y="3008.042">update contract list (data)</text><polygon fill="#181818" points="827,3023.3047,817,3027.3047,827,3031.3047,823,3027.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="3027.3047" y2="3027.3047"/><polygon fill="#181818" points="1052,3054.5957,1062,3058.5957,1052,3062.5957,1056,3058.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="3058.5957" y2="3058.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="823" y="3053.333">update contract #x (data)</text><polygon fill="#181818" points="827,3068.5957,817,3072.5957,827,3076.5957,823,3072.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="3072.5957" y2="3072.5957"/><polygon fill="#181818" points="1052,3099.8867,1062,3103.8867,1052,3107.8867,1056,3103.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="3103.8867" y2="3103.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="823" y="3098.624">update counters (data)</text><polygon fill="#181818" points="827,3113.8867,817,3117.8867,827,3121.8867,823,3117.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="3117.8867" y2="3117.8867"/><polygon fill="#181818" points="1052,3152.1777,1062,3156.1777,1052,3160.1777,1056,3156.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="3156.1777" y2="3156.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="823" y="3150.915">close secure session (SAM certificate)</text><polygon fill="#181818" points="827,3183.4688,817,3187.4688,827,3191.4688,823,3187.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1063" y1="3187.4688" y2="3187.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="833" y="3182.2061">[card certificate]</text><polygon fill="#181818" points="1052,3214.7598,1062,3218.7598,1052,3222.7598,1056,3218.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1058" y1="3218.7598" y2="3218.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="823" y="3213.4971">close card channel</text><polygon fill="#181818" points="827,3228.7598,817,3232.7598,827,3236.7598,823,3232.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1068" y1="3232.7598" y2="3232.7598"/><polygon fill="#0000FF" points="402,3260.0508,392,3264.0508,402,3268.0508,398,3264.0508" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="3264.0508" y2="3264.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="408" y="3258.7881">[card certificate]</text><polygon fill="#00FF00" points="1135.5,3325.9238,1145.5,3329.9238,1135.5,3333.9238,1139.5,3329.9238" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1141.5" y1="3329.9238" y2="3329.9238"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="3290.0791">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="3307.3701">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3324.6611">- APDU list</text><polygon fill="#181818" points="1376.5,3357.2148,1386.5,3361.2148,1376.5,3365.2148,1380.5,3361.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1157.5" x2="1382.5" y1="3361.2148" y2="3361.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="1164.5" y="3355.9521">digest authenticate (card certificate)</text><polygon fill="#181818" points="1168.5,3388.5059,1158.5,3392.5059,1168.5,3396.5059,1164.5,3392.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1162.5" x2="1387.5" y1="3392.5059" y2="3392.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1174.5" y="3387.2432">[authentication status]</text><polygon fill="#00FF00" points="402,3419.7969,392,3423.7969,402,3427.7969,398,3423.7969" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1151.5" y1="3423.7969" y2="3423.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="408" y="3418.5342">[authentification status]</text><polygon fill="#181818" points="89,3572.125,79,3576.125,89,3580.125,85,3576.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3576.125" y2="3576.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3449.8252">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3467.1162">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3484.4072">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="127" y="3501.6982">- contract list data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="127" y="3518.9893">- contract #x data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3536.2803">- contract #y data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="127" y="3553.5713">- counters data (#x updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="3570.8623">authentification status</text><!--SRC=[nLZTS-8s47_dhz24cHvuIfiGhhba4cR0s9qyTExcxlfquK6n1MWmjYi96lUlxqhob_m58PasByT9k_lRNUt-Tk43tz8mnWpla1rWpkSHymcpeo1YgEzUsPDBjzSbifZCxCj5IOGBmaWaafZC3C7PxS9Uk8s2ZuRWV3AxSJus2jgcnSNYQZvk57GCGMT-Usr2Rx0V_Kt3DLhXW9DUwUgRm89qHpZp13rGaJH9zJwWhyIlPGnxspMBzg6lfE_l6V6dKyZlmbauTaT-SqddPc9VsxqDzGdA3ejm0VNBdiK1EGeSAp65FN5izwOJkn3-v4mciqK6dvyR7Zm7- -FuKaZ5CtS_klDEz4pqUdBxQJ7FiDDJ0_btHaXu57ejfHJsp9svLvtOkUpOiUsRgmmyEowX0_ndXiFryT0Z9QQVtHqxjvqE5CBERpVEU9nva9-RBa06abCIaEZu7TjnZiMlHCVsjVFniXH-Ke76de3gl_XElIqHig5cSHnG3miQXHS8SuJZ6FNNKU3t04jGZyOu5EZ2na4IymZDlZmgCG_75FLZ6cvDkQy4WrUv66iH6p2oYmGPFeMPOHip_odKwYa2yrDh_O2kDs8kw_LPvWUp15rObbInh5ouB7O4xDli3mEBuvq1fGkqmE8a89uWuA1bWMuA2bg6l4mkFG0TbPAO7zM47nvKp4ZRXlIZdn0yMoZeAdqFzF3GwuNWEOeEu9fCUG_1dtIL8x4XoCS2evWH3cg8XWW7WJgNwG09pDO4l4OhU79vd4FzqYEXZwHfS3gEHrDf-mxThoAmuycIUf2KPLbW6r99BEl-LtatrOakNEOU2J6ZqTrJ-2H6Q4K3g3Nqd20U4qy6WcQF2-EEXWSSK70S_DB6WC3tNCimY0oHy41P5EvaJA14IbSU-C0WfIYWN1IvLSMObfdyF1fD8QgUJmo9D5JM6cha4SwBKCcBx0mgsc8ky5a9NtuU_UXVmf_hBgT55PkOYXPr2QF-LGxw9ECB-GvG2q16_jeJBdGUIiv4J1_DlYp-h6MagNbwnV58UNQ7efY4sgQtmM580jD6MLl-VpGgHTHWJZicwpyZ5JJ0r1_MbU_G3mNWse_Bcg5CnDiGRykBcb7fL_NIwqcgZ7KBgGHuqMw7GoZxQ2-uv3zEl3sJ_t0EUgfpwWwhicB40p95WrBb3NFvgjVbyfJzjpp5ib6uxRODiTGwTAhnSANYqgKC68GUY54mF8v2s9EC3iYVJTUewf7inQ0PbIH1ttP0dIghT8VNXWbMD97c2yloC1UMXJ9UbI37sXB2B8jhc9G_Almd4v1Ur2j0NrHV8ssIXZpMwQ1WO5KeglEmbpEl2bGvR5aq151m3PGhuPRLqYYCQtYBQCyyObx14CblEZWUhp6mkgJkAYd2i514RmGANih2rrIlgXw92E4z783ldemSFkxEPdyTWw8CixdGOE7C7xz33KaAHG4va61u1gKtdVTV6ayJutGVmcpXPqu4xzI9a5FCO4j8d36cIiYm6Lk3ouvrtSlBvJHVD4mylQUgtK9FWuelfR6G5bLf8ZJGV_C-av-Ef1yvMVlGzen3ru7u81qlZE9WA1L6eyBdcW7OBcGIWe2eVTgKXZwNuUJtov9wdf0i-LNHqaCLy4KoNp5RnqspzQGajipGrhcJTbysRyfDdLElREtFiQ0x-e_YihjwOwkA5Xj0MM-CLfPb1XjxkNkR9qzZWwgGVV8CqMz9yhECsiYvFd4V3OU0FQGx7GChtHoq3I2b_tewliPw_-K4s_sNSomdfrXENcDPCrgNMIrnV4j8EynygcNRRl36GLrzVpI03f3SuW_RHdExIFeMrTF4E3NIy5g2D-TR6jm-zfK1mzE111Ws2u2VZTUfQmFONVOa2ow8EAbrf_ggB7GIkYR9EuynxKmsn_0At1rs3D4KGYv2yhkr8FfRw6elP33PkgDMJtxMw3kVh9idNcrY-NHDrA84TWSfeQhIEJxiKjNqSGVLlUOy0nNcUvC9IMzlCv2SQo0ZgwgsdfNraYmgo2_AiXYfHH59zZlYGbEt3ZD5mvipZ6KZuoscoanUjIDfkyMEwissfOgmb7s1o8_lLMNfzzkihl-lpQfvVdQmTlCGFT5EJkxdMSbcG9U9wl1ERJIFYigBTloqOhnxctdZjv-wQvKjmN0phvUHkMEqb5jjotZTRBX-vzdGqdR6j-L1DQ1XGqEMD8fV9uwqPQQpgcfrjEVxBMNjcvWksxP5hFs-TIL30z3Dj9PFOKlWrPNcNm00]--></g></svg>