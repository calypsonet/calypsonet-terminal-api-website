<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5028px" preserveAspectRatio="none" style="width:1539px;height:5028px;background:#FFFFFF;" version="1.1" viewBox="0 0 1539 5028" width="1539px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="234.0762"/><rect fill="#FFC0CB" height="65.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="591.2773"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="847.1875"/><rect fill="#FFC0CB" height="614.6934" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="892.4785"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1555.7539"/><rect fill="#FFC0CB" height="310.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1601.0449"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2004.7012"/><rect fill="#FFC0CB" height="328.0742" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2049.9922"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2470.9395"/><rect fill="#FFC0CB" height="345.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2516.2305"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2954.4688"/><rect fill="#FFC0CB" height="362.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2999.7598"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3489.8711"/><rect fill="#FFC0CB" height="1392.3867" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3535.1621"/><rect fill="#FFC0CB" height="280.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="279.3672"/><rect fill="#ADD8E6" height="183.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="345.2402"/><rect fill="#ADD8E6" height="199.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1163.3887"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1666.918"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2115.8652"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2582.1035"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="3065.6328"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="4255.2734"/><rect fill="#ADD8E6" height="4173.0703" style="stroke:#181818;stroke-width:1.0;" width="10" x="1153" y="376.5313"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="958.3516"/><rect fill="#90EE90" height="489.4922" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="3699.9082"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="4646.7656"/><rect fill="#90EE90" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="1477.5" y="93.6211"/><rect fill="none" height="153.7461" style="stroke:#000000;stroke-width:1.5;" width="587.5" x="605" y="1178.3887"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="1681.918"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2130.8652"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2597.1035"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="3080.6328"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="339.5" x="1182.5" y="3986.6543"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="4270.2734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="386" x2="386" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624" x2="624" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="811" x2="811" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1157.5" x2="1157.5" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1241.5" x2="1241.5" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1482" x2="1482" y1="83.6211" y2="4945.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="4959.6563">Ticketing Application</text><ellipse cx="73" cy="4971.6699" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,4979.6699 L73,5006.6699 M60,4987.6699 L86,4987.6699 M73,5006.6699 L60,5021.6699 M73,5006.6699 L86,5021.6699 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="4966.6563">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="581" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="588" y="72.1074">Reader API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="581" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="588" y="4966.6563">Reader API</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="761" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="768" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="787.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="761" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="768" y="4966.6563">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="787.5" y="4985.2773">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1138.5" y="80.1074">Card</text><path d="M1137.5,37 L1137.5,61 M1137.5,49 L1154.5,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1166.5" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1138.5" y="4959.6563">Card</text><path d="M1137.5,4967.1699 L1137.5,4991.1699 M1137.5,4979.1699 L1154.5,4979.1699 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1166.5" cy="4979.1699" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1192.5" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1199.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1218" y="72.1074">Reader</text><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1192.5" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1199.5" y="4966.6563">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1218" y="4985.2773">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1453" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1464" y="80.1074">SAM</text><path d="M1462,18.3789 L1462,42.3789 M1462,30.3789 L1479,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1491" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1453" y="4959.6563">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1464" y="4978.2773">SAM</text><path d="M1462,4985.791 L1462,5009.791 M1462,4997.791 L1479,4997.791 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1491" cy="4997.791" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="234.0762"/><rect fill="#FFC0CB" height="65.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="591.2773"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="847.1875"/><rect fill="#FFC0CB" height="614.6934" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="892.4785"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1555.7539"/><rect fill="#FFC0CB" height="310.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1601.0449"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2004.7012"/><rect fill="#FFC0CB" height="328.0742" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2049.9922"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2470.9395"/><rect fill="#FFC0CB" height="345.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2516.2305"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2954.4688"/><rect fill="#FFC0CB" height="362.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2999.7598"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3489.8711"/><rect fill="#FFC0CB" height="1392.3867" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3535.1621"/><rect fill="#FFC0CB" height="280.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="279.3672"/><rect fill="#ADD8E6" height="183.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="345.2402"/><rect fill="#ADD8E6" height="199.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1163.3887"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1666.918"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2115.8652"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2582.1035"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="3065.6328"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="4255.2734"/><rect fill="#ADD8E6" height="4173.0703" style="stroke:#181818;stroke-width:1.0;" width="10" x="1153" y="376.5313"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="958.3516"/><rect fill="#90EE90" height="489.4922" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="3699.9082"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="4646.7656"/><rect fill="#90EE90" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="1477.5" y="93.6211"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1532" x="0" y="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="115.2666" y2="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="118.2666" y2="118.2666"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="209" x="661.5" y="103.6211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="191" x="667.5" y="121.6494">Card selection &amp; identification</text><path d="M273,143.9121 L273,170.9121 L499,170.9121 L499,153.9121 L489,143.9121 L273,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M489,143.9121 L489,153.9121 L499,153.9121 L489,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="279" y="162.9404">Only reads data inside the session.</text><polygon fill="#181818" points="369,230.0762,379,234.0762,369,238.0762,373,234.0762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="234.0762" y2="234.0762"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="194.2314">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="139" y="194.2314">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="117" y="211.5225">- filter by specific AID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="117" y="228.8135">- filter invalidated card status</text><polygon fill="#181818" points="89,244.0762,79,248.0762,89,252.0762,85,248.0762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="248.0762" y2="248.0762"/><polygon fill="#181818" points="607,275.3672,617,279.3672,607,283.3672,611,279.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="613" y1="279.3672" y2="279.3672"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="274.1045">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="137" y="274.1045">explicit card selection scenario</text><polygon fill="#0000FF" points="794,341.2402,804,345.2402,794,349.2402,798,345.2402" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="629" x2="800" y1="345.2402" y2="345.2402"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="636" y="305.3955">Card #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="636" y="322.6865">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="668" y="339.9775">- card selector</text><polygon fill="#181818" points="1141,372.5313,1151,376.5313,1141,380.5313,1145,376.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="376.5313" y2="376.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="823" y="371.2686">open card channel</text><polygon fill="#181818" points="827,386.5313,817,390.5313,827,394.5313,823,390.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="390.5313" y2="390.5313"/><polygon fill="#181818" points="1141,417.8223,1151,421.8223,1141,425.8223,1145,421.8223" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="421.8223" y2="421.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="823" y="416.5596">select application (aid)</text><polygon fill="#181818" points="827,449.1133,817,453.1133,827,457.1133,823,453.1133" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="453.1133" y2="453.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="833" y="447.8506">[card FCI]</text><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="858" y1="484.4043" y2="484.4043"/><line style="stroke:#181818;stroke-width:1.0;" x1="858" x2="858" y1="484.4043" y2="497.4043"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="858" y1="497.4043" y2="497.4043"/><polygon fill="#181818" points="827,493.4043,817,497.4043,827,501.4043,823,497.4043" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="823" y="479.1416">checks invalidation status</text><polygon fill="#0000FF" points="640,524.6953,630,528.6953,640,532.6953,636,528.6953" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="810" y1="528.6953" y2="528.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="646" y="523.4326">receive selection response</text><polygon fill="#181818" points="89,555.9863,79,559.9863,89,563.9863,85,559.9863" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="623" y1="559.9863" y2="559.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="95" y="554.7236">selected active SmartCard image</text><polygon fill="#181818" points="369,587.2773,379,591.2773,369,595.2773,373,591.2773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="591.2773" y2="591.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="85" y="586.0146">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="114" y="586.0146">Calypso card</text><polygon fill="#181818" points="89,653.1504,79,657.1504,89,661.1504,85,657.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="657.1504" y2="657.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="617.3057">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="634.5967">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="127" y="651.8877">- invalidation status]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1532" x="0" y="686.7959"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="686.7959" y2="686.7959"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="689.7959" y2="689.7959"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="168" x="682" y="675.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="688" y="693.1787">Card secure transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="768.3145" y2="768.3145"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="768.3145" y2="781.3145"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="781.3145" y2="781.3145"/><polygon fill="#181818" points="89,777.3145,79,781.3145,89,785.3145,85,781.3145" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="728.4697">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="728.4697">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="745.7607">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="763.0518">- Calypso SAM resource</text><polygon fill="#181818" points="369,843.1875,379,847.1875,369,851.1875,373,847.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="847.1875" y2="847.1875"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="807.3428">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="807.3428">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="117" y="824.6338">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="841.9248">- read environment file</text><polygon fill="#181818" points="89,857.1875,79,861.1875,89,865.1875,85,861.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="861.1875" y2="861.1875"/><polygon fill="#181818" points="369,888.4785,379,892.4785,369,896.4785,373,892.4785" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="892.4785" y2="892.4785"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="887.2158">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="887.2158">commands (keep channel open)</text><polygon fill="#00FF00" points="1224.5,954.3516,1234.5,958.3516,1224.5,962.3516,1228.5,958.3516" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1230.5" y1="958.3516" y2="958.3516"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="918.5068">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="935.7979">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="953.0889">- APDU list</text><polygon fill="#181818" points="1465.5,985.6426,1475.5,989.6426,1465.5,993.6426,1469.5,989.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="989.6426" y2="989.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1253.5" y="984.3799">select diversifier (card serial)</text><polygon fill="#181818" points="1257.5,999.6426,1247.5,1003.6426,1257.5,1007.6426,1253.5,1003.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="1003.6426" y2="1003.6426"/><polygon fill="#181818" points="1465.5,1030.9336,1475.5,1034.9336,1465.5,1038.9336,1469.5,1034.9336" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="1034.9336" y2="1034.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1253.5" y="1029.6709">get challenge</text><polygon fill="#181818" points="1257.5,1062.2246,1247.5,1066.2246,1257.5,1070.2246,1253.5,1066.2246" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="1066.2246" y2="1066.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1263.5" y="1060.9619">[SAM challenge]</text><polygon fill="#00FF00" points="402,1093.5156,392,1097.5156,402,1101.5156,398,1097.5156" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1240.5" y1="1097.5156" y2="1097.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="408" y="1092.2529">[SAM challenge]</text><polygon fill="#0000FF" points="794,1159.3887,804,1163.3887,794,1167.3887,798,1163.3887" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="1163.3887" y2="1163.3887"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1123.5439">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1140.835">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1158.126">- APDU list</text><path d="M605,1178.3887 L885,1178.3887 L885,1187.6797 L875,1197.6797 L605,1197.6797 L605,1178.3887 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="153.7461" style="stroke:#000000;stroke-width:1.5;" width="587.5" x="605" y="1178.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="620" y="1193.417">Card APDU commands inside session</text><path d="M615,1202.6797 L615,1229.6797 L1006,1229.6797 L1006,1212.6797 L996,1202.6797 L615,1202.6797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M996,1202.6797 L996,1212.6797 L1006,1212.6797 L996,1202.6797 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370" x="621" y="1221.708">Optimization: environment file read through the session opening.</text><polygon fill="#181818" points="1141,1288.8438,1151,1292.8438,1141,1296.8438,1145,1292.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="1292.8438" y2="1292.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="823" y="1252.999">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="855" y="1270.29">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="855" y="1287.5811">SFI environment to read)</text><polygon fill="#181818" points="827,1320.1348,817,1324.1348,827,1328.1348,823,1324.1348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="1324.1348" y2="1324.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="833" y="1318.8721">[card challenge &amp; environment data]</text><polygon fill="#0000FF" points="402,1358.4258,392,1362.4258,402,1366.4258,398,1362.4258" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="1362.4258" y2="1362.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="1357.1631">[card challenge]</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="1393.7168" y2="1393.7168"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="1393.7168" y2="1406.7168"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="1406.7168" y2="1406.7168"/><polygon fill="#181818" points="402,1402.7168,392,1406.7168,402,1410.7168,398,1406.7168" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="398" y="1388.4541">checks ratification status</text><polygon fill="#181818" points="89,1503.1719,79,1507.1719,89,1511.1719,85,1507.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1507.1719" y2="1507.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1432.7451">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="1450.0361">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="1467.3271">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="1484.6182">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="1501.9092">- ratification status]</text><polygon fill="#181818" points="369,1551.7539,379,1555.7539,369,1559.7539,373,1555.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1555.7539" y2="1555.7539"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1533.2002">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="1533.2002">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="117" y="1550.4912">- read last event</text><polygon fill="#181818" points="89,1565.7539,79,1569.7539,89,1573.7539,85,1569.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1569.7539" y2="1569.7539"/><polygon fill="#181818" points="369,1597.0449,379,1601.0449,369,1605.0449,373,1601.0449" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1601.0449" y2="1601.0449"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1595.7822">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1595.7822">commands (keep channel open)</text><polygon fill="#0000FF" points="794,1662.918,804,1666.918,794,1670.918,798,1666.918" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="1666.918" y2="1666.918"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1627.0732">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1644.3643">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1661.6553">- APDU list</text><path d="M751,1681.918 L1031,1681.918 L1031,1691.209 L1021,1701.209 L751,1701.209 L751,1681.918 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="1681.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="1696.9463">Card APDU commands inside session</text><polygon fill="#181818" points="1141,1720.5,1151,1724.5,1141,1728.5,1145,1724.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="1724.5" y2="1724.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="823" y="1719.2373">read record (last event)</text><polygon fill="#181818" points="827,1751.791,817,1755.791,827,1759.791,823,1755.791" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="1755.791" y2="1755.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="833" y="1750.5283">[last event data]</text><polygon fill="#0000FF" points="402,1790.082,392,1794.082,402,1798.082,398,1794.082" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="1794.082" y2="1794.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="1788.8193">[last event data]</text><polygon fill="#181818" points="89,1907.8281,79,1911.8281,89,1915.8281,85,1911.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1911.8281" y2="1911.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1820.1104">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="1837.4014">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="1854.6924">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="1871.9834">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="1889.2744">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="127" y="1906.5654">- last event data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="1943.1191" y2="1943.1191"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="1943.1191" y2="1956.1191"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="1956.1191" y2="1956.1191"/><polygon fill="#181818" points="89,1952.1191,79,1956.1191,89,1960.1191,85,1956.1191" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="85" y="1937.8564">checks transaction recovery status</text><polygon fill="#181818" points="369,2000.7012,379,2004.7012,369,2008.7012,373,2004.7012" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2004.7012" y2="2004.7012"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1982.1475">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="1982.1475">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="117" y="1999.4385">- read contract list</text><polygon fill="#181818" points="89,2014.7012,79,2018.7012,89,2022.7012,85,2018.7012" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2018.7012" y2="2018.7012"/><polygon fill="#181818" points="369,2045.9922,379,2049.9922,369,2053.9922,373,2049.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2049.9922" y2="2049.9922"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2044.7295">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2044.7295">commands (keep channel open)</text><polygon fill="#0000FF" points="794,2111.8652,804,2115.8652,794,2119.8652,798,2115.8652" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="2115.8652" y2="2115.8652"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2076.0205">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2093.3115">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2110.6025">- APDU list</text><path d="M751,2130.8652 L1031,2130.8652 L1031,2140.1563 L1021,2150.1563 L751,2150.1563 L751,2130.8652 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2130.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="2145.8936">Card APDU commands inside session</text><polygon fill="#181818" points="1141,2169.4473,1151,2173.4473,1141,2177.4473,1145,2173.4473" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="2173.4473" y2="2173.4473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="823" y="2168.1846">read record (contract list)</text><polygon fill="#181818" points="827,2200.7383,817,2204.7383,827,2208.7383,823,2204.7383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="2204.7383" y2="2204.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="833" y="2199.4756">[contract list data]</text><polygon fill="#0000FF" points="402,2239.0293,392,2243.0293,402,2247.0293,398,2243.0293" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="2243.0293" y2="2243.0293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="408" y="2237.7666">[contract list data]</text><polygon fill="#181818" points="89,2374.0664,79,2378.0664,89,2382.0664,85,2378.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2378.0664" y2="2378.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="2269.0576">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2286.3486">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="2303.6396">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="2320.9307">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="2338.2217">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="127" y="2355.5127">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2372.8037">- contract list data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="2409.3574" y2="2409.3574"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="2409.3574" y2="2422.3574"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="2422.3574" y2="2422.3574"/><polygon fill="#181818" points="89,2418.3574,79,2422.3574,89,2426.3574,85,2422.3574" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="85" y="2404.0947">identifies contract</text><polygon fill="#181818" points="369,2466.9395,379,2470.9395,369,2474.9395,373,2470.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2470.9395" y2="2470.9395"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2448.3857">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="2448.3857">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="2465.6768">- read contract #x</text><polygon fill="#181818" points="89,2480.9395,79,2484.9395,89,2488.9395,85,2484.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2484.9395" y2="2484.9395"/><polygon fill="#181818" points="369,2512.2305,379,2516.2305,369,2520.2305,373,2516.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2516.2305" y2="2516.2305"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2510.9678">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2510.9678">commands (keep channel open)</text><polygon fill="#0000FF" points="794,2578.1035,804,2582.1035,794,2586.1035,798,2582.1035" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="2582.1035" y2="2582.1035"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2542.2588">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2559.5498">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2576.8408">- APDU list</text><path d="M751,2597.1035 L1031,2597.1035 L1031,2606.3945 L1021,2616.3945 L751,2616.3945 L751,2597.1035 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2597.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="2612.1318">Card APDU commands inside session</text><polygon fill="#181818" points="1141,2635.6855,1151,2639.6855,1141,2643.6855,1145,2639.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="2639.6855" y2="2639.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="823" y="2634.4229">read record (contract #x)</text><polygon fill="#181818" points="827,2666.9766,817,2670.9766,827,2674.9766,823,2670.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="2670.9766" y2="2670.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="833" y="2665.7139">[contract #x data]</text><polygon fill="#0000FF" points="402,2705.2676,392,2709.2676,402,2713.2676,398,2709.2676" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="2709.2676" y2="2709.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="408" y="2704.0049">[contract #x data]</text><polygon fill="#181818" points="89,2857.5957,79,2861.5957,89,2865.5957,85,2861.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2861.5957" y2="2861.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="2735.2959">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2752.5869">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="2769.8779">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="2787.1689">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="2804.46">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="127" y="2821.751">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="2839.042">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="2856.333">- contract #x data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="2892.8867" y2="2892.8867"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="2892.8867" y2="2905.8867"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="2905.8867" y2="2905.8867"/><polygon fill="#181818" points="89,2901.8867,79,2905.8867,89,2909.8867,85,2905.8867" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="85" y="2887.624">identifies associated counter</text><polygon fill="#181818" points="369,2950.4688,379,2954.4688,369,2958.4688,373,2954.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2954.4688" y2="2954.4688"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2931.915">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="2931.915">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="117" y="2949.2061">- reader counter #x</text><polygon fill="#181818" points="89,2964.4688,79,2968.4688,89,2972.4688,85,2968.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2968.4688" y2="2968.4688"/><polygon fill="#181818" points="369,2995.7598,379,2999.7598,369,3003.7598,373,2999.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2999.7598" y2="2999.7598"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2994.4971">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2994.4971">commands (keep channel open)</text><polygon fill="#0000FF" points="794,3061.6328,804,3065.6328,794,3069.6328,798,3065.6328" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="3065.6328" y2="3065.6328"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="3025.7881">Card #6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="3043.0791">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3060.3701">- APDU list</text><path d="M751,3080.6328 L1031,3080.6328 L1031,3089.9238 L1021,3099.9238 L751,3099.9238 L751,3080.6328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="3080.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="3095.6611">Card APDU commands inside session</text><polygon fill="#181818" points="1141,3119.2148,1151,3123.2148,1141,3127.2148,1145,3123.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="3123.2148" y2="3123.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="823" y="3117.9521">read record (counter #x)</text><polygon fill="#181818" points="827,3150.5059,817,3154.5059,827,3158.5059,823,3154.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="3154.5059" y2="3154.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="833" y="3149.2432">[counter #1 data]</text><polygon fill="#0000FF" points="402,3188.7969,392,3192.7969,402,3196.7969,398,3192.7969" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="3192.7969" y2="3192.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="3187.5342">[card challenge]</text><polygon fill="#181818" points="89,3358.416,79,3362.416,89,3366.416,85,3362.416" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3362.416" y2="3362.416"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3218.8252">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3236.1162">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="3253.4072">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3270.6982">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="3287.9893">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="127" y="3305.2803">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="3322.5713">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3339.8623">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3357.1533">- counter #x data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="3393.707" y2="3393.707"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="3393.707" y2="3406.707"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="3406.707" y2="3406.707"/><polygon fill="#181818" points="89,3402.707,79,3406.707,89,3410.707,85,3406.707" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="85" y="3388.4443">defines data to update</text><polygon fill="#181818" points="369,3485.8711,379,3489.8711,369,3493.8711,373,3489.8711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="3489.8711" y2="3489.8711"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="3432.7354">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="3432.7354">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="117" y="3450.0264">- decrease counter #x (new value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="117" y="3467.3174">- append event record (new event)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="117" y="3484.6084">- close secure session (not ratified)</text><polygon fill="#181818" points="89,3499.8711,79,3503.8711,89,3507.8711,85,3503.8711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3503.8711" y2="3503.8711"/><polygon fill="#181818" points="369,3531.1621,379,3535.1621,369,3539.1621,373,3535.1621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="3535.1621" y2="3535.1621"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="3529.8994">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="3529.8994">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="3566.4531" y2="3566.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="3566.4531" y2="3579.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="3579.4531" y2="3579.4531"/><polygon fill="#181818" points="402,3575.4531,392,3579.4531,402,3583.4531,398,3579.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="398" y="3561.1904">anticipates the future card responses</text><path d="M55,3592.4531 L55,3636.4531 L716,3636.4531 L716,3602.4531 L706,3592.4531 L55,3592.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M706,3592.4531 L706,3602.4531 L716,3602.4531 L706,3592.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="61" y="3611.4814">If the current value of the counter #x were</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="58" x="302" y="3611.4814">unknown</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="360" y="3611.4814">, then the transmission of an additional card APDU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640" x="61" y="3628.7725">message would be necessary to operate the decrease counter in a different message than the session closing.</text><polygon fill="#00FF00" points="1224.5,3695.9082,1234.5,3699.9082,1224.5,3703.9082,1228.5,3699.9082" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1230.5" y1="3699.9082" y2="3699.9082"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="3660.0635">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="3677.3545">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3694.6455">- APDU list</text><polygon fill="#181818" points="1465.5,3727.1992,1475.5,3731.1992,1465.5,3735.1992,1469.5,3731.1992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3731.1992" y2="3731.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1253.5" y="3725.9365">digest init (opening data)</text><polygon fill="#181818" points="1257.5,3741.1992,1247.5,3745.1992,1257.5,3749.1992,1253.5,3745.1992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3745.1992" y2="3745.1992"/><polygon fill="#181818" points="1465.5,3772.4902,1475.5,3776.4902,1465.5,3780.4902,1469.5,3776.4902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3776.4902" y2="3776.4902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="1253.5" y="3771.2275">digest update (read environment)</text><polygon fill="#181818" points="1257.5,3786.4902,1247.5,3790.4902,1257.5,3794.4902,1253.5,3790.4902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3790.4902" y2="3790.4902"/><polygon fill="#181818" points="1465.5,3817.7813,1475.5,3821.7813,1465.5,3825.7813,1469.5,3821.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3821.7813" y2="3821.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="1253.5" y="3816.5186">digest update (last event)</text><polygon fill="#181818" points="1257.5,3831.7813,1247.5,3835.7813,1257.5,3839.7813,1253.5,3835.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3835.7813" y2="3835.7813"/><polygon fill="#181818" points="1465.5,3863.0723,1475.5,3867.0723,1465.5,3871.0723,1469.5,3867.0723" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3867.0723" y2="3867.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="1253.5" y="3861.8096">digest update (read contract list)</text><polygon fill="#181818" points="1257.5,3877.0723,1247.5,3881.0723,1257.5,3885.0723,1253.5,3881.0723" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3881.0723" y2="3881.0723"/><polygon fill="#181818" points="1465.5,3908.3633,1475.5,3912.3633,1465.5,3916.3633,1469.5,3912.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3912.3633" y2="3912.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1253.5" y="3907.1006">digest update (read contract #x)</text><polygon fill="#181818" points="1257.5,3922.3633,1247.5,3926.3633,1257.5,3930.3633,1253.5,3926.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3926.3633" y2="3926.3633"/><polygon fill="#181818" points="1465.5,3953.6543,1475.5,3957.6543,1465.5,3961.6543,1469.5,3957.6543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3957.6543" y2="3957.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1253.5" y="3952.3916">digest update (read counters)</text><polygon fill="#181818" points="1257.5,3967.6543,1247.5,3971.6543,1257.5,3975.6543,1253.5,3971.6543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3971.6543" y2="3971.6543"/><path d="M1182.5,3986.6543 L1439.5,3986.6543 L1439.5,3995.9453 L1429.5,4005.9453 L1182.5,4005.9453 L1182.5,3986.6543 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="339.5" x="1182.5" y="3986.6543"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="1197.5" y="4001.6826">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1272.5" y="4001.6826">Card APDU responses</text><polygon fill="#181818" points="1465.5,4025.2363,1475.5,4029.2363,1465.5,4033.2363,1469.5,4029.2363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4029.2363" y2="4029.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="1253.5" y="4023.9736">digest update (decrease counter)</text><polygon fill="#181818" points="1257.5,4039.2363,1247.5,4043.2363,1257.5,4047.2363,1253.5,4043.2363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4043.2363" y2="4043.2363"/><polygon fill="#181818" points="1465.5,4070.5273,1475.5,4074.5273,1465.5,4078.5273,1469.5,4074.5273" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4074.5273" y2="4074.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="1253.5" y="4069.2646">digest update (append event record)</text><polygon fill="#181818" points="1257.5,4084.5273,1247.5,4088.5273,1257.5,4092.5273,1253.5,4088.5273" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4088.5273" y2="4088.5273"/><polygon fill="#181818" points="1465.5,4122.8184,1475.5,4126.8184,1465.5,4130.8184,1469.5,4126.8184" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4126.8184" y2="4126.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1253.5" y="4121.5557">digest close</text><polygon fill="#181818" points="1257.5,4154.1094,1247.5,4158.1094,1257.5,4162.1094,1253.5,4158.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4158.1094" y2="4158.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1263.5" y="4152.8467">[SAM certificate]</text><polygon fill="#00FF00" points="402,4185.4004,392,4189.4004,402,4193.4004,398,4189.4004" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1240.5" y1="4189.4004" y2="4189.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="408" y="4184.1377">[SAM certificate]</text><polygon fill="#0000FF" points="794,4251.2734,804,4255.2734,794,4259.2734,798,4255.2734" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="4255.2734" y2="4255.2734"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="4215.4287">Card #7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="4232.7197">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="4250.0107">- APDU list</text><path d="M751,4270.2734 L1031,4270.2734 L1031,4279.5645 L1021,4289.5645 L751,4289.5645 L751,4270.2734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="4270.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="4285.3018">Card APDU commands inside session</text><polygon fill="#181818" points="1141,4308.8555,1151,4312.8555,1141,4316.8555,1145,4312.8555" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4312.8555" y2="4312.8555"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="823" y="4307.5928">decrease counter (counter #1, value)</text><polygon fill="#181818" points="827,4340.1465,817,4344.1465,827,4348.1465,823,4344.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4344.1465" y2="4344.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="833" y="4338.8838">[new counter value]</text><polygon fill="#181818" points="1141,4371.4375,1151,4375.4375,1141,4379.4375,1145,4375.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4375.4375" y2="4375.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="823" y="4370.1748">append record (event, data)</text><polygon fill="#181818" points="827,4385.4375,817,4389.4375,827,4393.4375,823,4389.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4389.4375" y2="4389.4375"/><polygon fill="#181818" points="1141,4423.7285,1151,4427.7285,1141,4431.7285,1145,4427.7285" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4427.7285" y2="4427.7285"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313" x="823" y="4422.4658">close secure session (SAM certificate, as non ratified)</text><polygon fill="#181818" points="827,4455.0195,817,4459.0195,827,4463.0195,823,4459.0195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4459.0195" y2="4459.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="833" y="4453.7568">[card certificate]</text><polygon fill="#181818" points="1141,4486.3105,1151,4490.3105,1141,4494.3105,1145,4490.3105" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4490.3105" y2="4490.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="823" y="4485.0479">ratification command</text><polygon fill="#181818" points="827,4500.3105,817,4504.3105,827,4508.3105,823,4504.3105" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4504.3105" y2="4504.3105"/><polygon fill="#181818" points="1141,4531.6016,1151,4535.6016,1141,4539.6016,1145,4535.6016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4535.6016" y2="4535.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="823" y="4530.3389">close card channel</text><polygon fill="#181818" points="827,4545.6016,817,4549.6016,827,4553.6016,823,4549.6016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1157" y1="4549.6016" y2="4549.6016"/><polygon fill="#0000FF" points="402,4576.8926,392,4580.8926,402,4584.8926,398,4580.8926" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="4580.8926" y2="4580.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="408" y="4575.6299">[card certificate]</text><polygon fill="#00FF00" points="1224.5,4642.7656,1234.5,4646.7656,1224.5,4650.7656,1228.5,4646.7656" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1230.5" y1="4646.7656" y2="4646.7656"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="4606.9209">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="4624.2119">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="4641.5029">- APDU list</text><polygon fill="#181818" points="1465.5,4674.0566,1475.5,4678.0566,1465.5,4682.0566,1469.5,4678.0566" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4678.0566" y2="4678.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="1253.5" y="4672.7939">digest authenticate (card certificate)</text><polygon fill="#181818" points="1257.5,4705.3477,1247.5,4709.3477,1257.5,4713.3477,1253.5,4709.3477" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4709.3477" y2="4709.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1263.5" y="4704.085">[authentication status]</text><polygon fill="#00FF00" points="402,4736.6387,392,4740.6387,402,4744.6387,398,4740.6387" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1240.5" y1="4740.6387" y2="4740.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="408" y="4735.376">[authentification status]</text><polygon fill="#181818" points="89,4923.5488,79,4927.5488,89,4931.5488,85,4927.5488" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="4927.5488" y2="4927.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="4766.667">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="4783.958">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="4801.249">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="4818.54">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="127" y="4835.8311">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="line-through" textLength="99" x="135" y="4835.8311">ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="127" y="4853.1221">- last event data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="4870.4131">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="4887.7041">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="127" y="4904.9951">- counter #x data (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="4922.2861">authentification status</text><!--SRC=[tLbBSzis4BxhLs2YcKRYcAqVSXnxRCz85DNnePDCafvY7M0IaZ2cG9Q4RAk_lei7IO0FINRLnh5FChXlxBUxNBxFxYbBS8gNo8jmbetYD2If5qTnYhgJ8szmEEbi8XaFXjxXs239E4b9pDS96Lg4m_EnDvuq4jvOXAF1yCm_RIJqR8dZyT7ek97GjmZzqVc9hNg1m_YHiZcQuIWZ7UFHLuuvsUpXCE3qWV9r4rNdFVf2mbh4S70_J-CL2oNrvMLAmkjhYE_O7_lUXlWMbFxPm3lnEWiQ4fGVbkw2ri-hD8d8LiM999Ew1xutETkekoJ-w0y6mt6klZYtBBYBLjlr2oBfpsXoEXbjr9wJdWpEFuv7kMvzQcd-FIM4RLKz5rHIzt0od1njr5tG7lkUTtQKAy-F3UsW_bEAsNoxwx4aKzS-EVRFDnfG4liVplpZuzo2ujms0IAmtYK0Q-M_x_d-DlybwR5tufyU6kwlAwfnm27xttsZmJtX0b3398beW3cDsJk4CuIJ17NdSHHsG1Ud0Kqmu-YTXwDraiLe-Fb6aWKueQYRK7PlqtqX6AmgoD8MiboSXzFmbYacBJSDjOnkHESBFX9PUYUYWjCrUkSuWiLn2cAJh575r-4VbeOCBoq5AXbB3Hc9IC09cEKumAjL0PT5Bm997w3q604hZch4LrVIKwHaGwZHBmYkY74wqx57LrUT3ek1ENu0qqHuEmZ-Fh5eZLAmDqCXvXXHbecxvGlGGh8CE7_j41OYmGf69ObxBNWlqEKiXYW48ZskHFbnd2Gb423YE9U_YMVNAdobILb064vfV77BRhcBPZI2l45tQvGb9126ek7Ds7f6sGEEADX5GYqCYl4gAmCXiqJVl_ZjkjTWOYSa5eMsEssrEmx0rT9kyYHIbl8s1qhzgQ5V_7Q_Tm_XRpAPNfU9PkkKzKfb6UeU5Kfl6GSaPqlGMYfCoLyhad4L4yEOE3L3q9JGdVBObQPSe3WXJ0a95fWn4jaoJ6xnl-iQBZI8KvQ8xCpXZNgOXlqwymNwBXLCl9jfJL1E4Yn8S9-LDoxZhMxRv342hAup9G6X3yGAMfR439gubGM59-gUP9xaJa1sIKg2lYu1uV9gw1BFBH5fcKWA08uJu8mx3ieBWL2oBJKX5YQvKgC1KG6iWAD-K0_Aj5DFyh881AiK82po2GS5-ANfqWJ70PHpA68Kc2iEc6pQBkinH3TUfG6n7q4TAvwyg4hKjSfqrQxeIeHwOtzqymqkI-0LHUI1H7r5BIeO8ko1fZ5RGXX51I4lh1F1hdKYY9TBpA1ozku9IN9OISlxpRgLSf73aydXuVIww1MsFZLMoFQWQaJ55gDOw4inwiJmy_XF5D6CM_sYeIKLfwwmeq1q2418CyX38E_fefDI7FK5W-kMDjS4p0aNGOWY8iSVcneoNxXJF9yQx4L0yk1NIOsBAjMNmNn6nJrkghWx1R6bq8g9Ab70aqn5KkXEgdFNwhr5CP8TEE5qIV-MwBwevR3ARBu0BVE5sPPbci60PRPd8Qwby5UH95qEoHruVq_M1y9hA-RgP79Z6SHZQKw_KDHOvmiPC8IOtAAWJOMrRHLTtxqjPDfIn-NbQnRTF59ibC-oUUoxzge7LSzq7QgRC7rscTcjGCh4W46T8wY3ZB_cOlSCV9xyA7msOqS66MOCU1T2lJBOxGWeQNREznfBo-3ompDPFTXiRf5OqamDJ7CK4S64AhWk0Be_C0InI1beOTN4-8dnC7Z5UB3YlQ4fc6IxTu46hfyA6FgjRPiRDc1o8qbMSFud2Ea-lH5ydFuC-EW-xO2ExjFpiL7ml0baLCwRdMl52ywoEA1gLnIl61V-xmqvOcnNGjyET3wyQkZamTw474rpjETNYpS1c_mqZ-DsB8LaHXdHUs1urLibOlFwJ13fs8GaWFlCY6b0Zv57195P4Rsq0S7YtLLvcD-y858pjlOWYZDIUts5zrqTDn9knCIU0QcioH69P-1QVqCvq2h4garyDk0GNV4AFrjnuKs-K9FhognfEtypa_JWUofY98E7OdrOHlQHW3J7MR5x5ZyonpaG14nIQM3hbS4CJ44u3Ad8DHmf2mHMfRObE0tfZHxZLHIYEu8O4N4GNoqW7Q3yfC998RLslHJ4ef3EPaGQcalY42XhQI7YLrbQl60bzl8bJlCchBR92kaSf81N8BUd5oqI5zkNO9fLWGVrgel9PmimNpfVehiofFyh4Q8Qlqo0p9AipgrQHXs29MB24ePbPob18_9sYmdLPEtdJ9ObEmXgg5VDiaGZQf4b2qZRRfIakXD0Qzg-7ZMfzxSWFNjTKq6jqfIZmT61xYQj4uBe9Jcv99ssQD4tc_SWUSC76l2DmckpXXRKtAqgrtKWFlWoiGifEbZxCjMyvOQXoPmTT6Ht-dod6vdvER3ELXcFB8UBj7BjuQebAslZrVCg_icUAtuBEl5AD4ukpTSxSiEXVWDk3GxhwzmczEOycnR5LHJ_RzEewpRCewxRE96YdYgDONyFisafR7hBMa9K7UJ-0G00]--></g></svg>