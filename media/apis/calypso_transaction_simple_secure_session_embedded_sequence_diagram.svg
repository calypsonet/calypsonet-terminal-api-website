<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5028px" preserveAspectRatio="none" style="width:1539px;height:5028px;background:#FFFFFF;" version="1.1" viewBox="0 0 1539 5028" width="1539px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="234.0762"/><rect fill="#FFC0CB" height="65.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="591.2773"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="847.1875"/><rect fill="#FFC0CB" height="569.4023" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="892.4785"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1510.4629"/><rect fill="#FFC0CB" height="310.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1555.7539"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1959.4102"/><rect fill="#FFC0CB" height="328.0742" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2004.7012"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2425.6484"/><rect fill="#FFC0CB" height="345.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2470.9395"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2909.1777"/><rect fill="#FFC0CB" height="362.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2954.4688"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3444.5801"/><rect fill="#FFC0CB" height="1437.6777" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3489.8711"/><rect fill="#FFC0CB" height="280.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="279.3672"/><rect fill="#ADD8E6" height="183.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="345.2402"/><rect fill="#ADD8E6" height="199.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1118.0977"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1621.627"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2070.5742"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2536.8125"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="3020.3418"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="4255.2734"/><rect fill="#ADD8E6" height="4173.0703" style="stroke:#181818;stroke-width:1.0;" width="10" x="1153" y="376.5313"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="958.3516"/><rect fill="#90EE90" height="534.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="3654.6172"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="4646.7656"/><rect fill="#90EE90" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="1477.5" y="93.6211"/><rect fill="none" height="153.7461" style="stroke:#000000;stroke-width:1.5;" width="587.5" x="605" y="1133.0977"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="1636.627"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2085.5742"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2551.8125"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="3035.3418"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="339.5" x="1182.5" y="3986.6543"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="4270.2734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="386" x2="386" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624" x2="624" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="811" x2="811" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1157.5" x2="1157.5" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1241.5" x2="1241.5" y1="83.6211" y2="4945.5488"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1482" x2="1482" y1="83.6211" y2="4945.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="4959.6563">Ticketing Application</text><ellipse cx="73" cy="4971.6699" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,4979.6699 L73,5006.6699 M60,4987.6699 L86,4987.6699 M73,5006.6699 L60,5021.6699 M73,5006.6699 L86,5021.6699 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="4966.6563">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="581" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="588" y="72.1074">Reader API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="581" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="588" y="4966.6563">Reader API</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="761" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="768" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="787.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="761" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="768" y="4966.6563">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="787.5" y="4985.2773">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1138.5" y="80.1074">Card</text><path d="M1137.5,37 L1137.5,61 M1137.5,49 L1154.5,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1166.5" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1138.5" y="4959.6563">Card</text><path d="M1137.5,4967.1699 L1137.5,4991.1699 M1137.5,4979.1699 L1154.5,4979.1699 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1166.5" cy="4979.1699" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1192.5" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1199.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1218" y="72.1074">Reader</text><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1192.5" y="4944.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1199.5" y="4966.6563">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1218" y="4985.2773">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1453" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1464" y="80.1074">SAM</text><path d="M1462,18.3789 L1462,42.3789 M1462,30.3789 L1479,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1491" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1453" y="4959.6563">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1464" y="4978.2773">SAM</text><path d="M1462,4985.791 L1462,5009.791 M1462,4997.791 L1479,4997.791 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1491" cy="4997.791" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="234.0762"/><rect fill="#FFC0CB" height="65.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="591.2773"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="847.1875"/><rect fill="#FFC0CB" height="569.4023" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="892.4785"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1510.4629"/><rect fill="#FFC0CB" height="310.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1555.7539"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1959.4102"/><rect fill="#FFC0CB" height="328.0742" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2004.7012"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2425.6484"/><rect fill="#FFC0CB" height="345.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2470.9395"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2909.1777"/><rect fill="#FFC0CB" height="362.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2954.4688"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3444.5801"/><rect fill="#FFC0CB" height="1437.6777" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="3489.8711"/><rect fill="#FFC0CB" height="280.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="279.3672"/><rect fill="#ADD8E6" height="183.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="345.2402"/><rect fill="#ADD8E6" height="199.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1118.0977"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="1621.627"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2070.5742"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="2536.8125"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="3020.3418"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="806" y="4255.2734"/><rect fill="#ADD8E6" height="4173.0703" style="stroke:#181818;stroke-width:1.0;" width="10" x="1153" y="376.5313"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="958.3516"/><rect fill="#90EE90" height="534.7832" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="3654.6172"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1236.5" y="4646.7656"/><rect fill="#90EE90" height="4842.9277" style="stroke:#181818;stroke-width:1.0;" width="10" x="1477.5" y="93.6211"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1532" x="0" y="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="115.2666" y2="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="118.2666" y2="118.2666"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="209" x="661.5" y="103.6211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="191" x="667.5" y="121.6494">Card selection &amp; identification</text><path d="M273,143.9121 L273,170.9121 L499,170.9121 L499,153.9121 L489,143.9121 L273,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M489,143.9121 L489,153.9121 L499,153.9121 L489,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="279" y="162.9404">Only reads data inside the session.</text><polygon fill="#181818" points="369,230.0762,379,234.0762,369,238.0762,373,234.0762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="234.0762" y2="234.0762"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="194.2314">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="139" y="194.2314">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="117" y="211.5225">- filter by specific AID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="117" y="228.8135">- filter invalidated card status</text><polygon fill="#181818" points="89,244.0762,79,248.0762,89,252.0762,85,248.0762" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="248.0762" y2="248.0762"/><polygon fill="#181818" points="607,275.3672,617,279.3672,607,283.3672,611,279.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="613" y1="279.3672" y2="279.3672"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="274.1045">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="137" y="274.1045">explicit card selection scenario</text><polygon fill="#0000FF" points="794,341.2402,804,345.2402,794,349.2402,798,345.2402" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="629" x2="800" y1="345.2402" y2="345.2402"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="636" y="305.3955">Card #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="636" y="322.6865">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="668" y="339.9775">- card selector</text><polygon fill="#181818" points="1141,372.5313,1151,376.5313,1141,380.5313,1145,376.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="376.5313" y2="376.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="823" y="371.2686">open card channel</text><polygon fill="#181818" points="827,386.5313,817,390.5313,827,394.5313,823,390.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="390.5313" y2="390.5313"/><polygon fill="#181818" points="1141,417.8223,1151,421.8223,1141,425.8223,1145,421.8223" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="421.8223" y2="421.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="823" y="416.5596">select application (aid)</text><polygon fill="#181818" points="827,449.1133,817,453.1133,827,457.1133,823,453.1133" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="453.1133" y2="453.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="833" y="447.8506">[card FCI]</text><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="858" y1="484.4043" y2="484.4043"/><line style="stroke:#181818;stroke-width:1.0;" x1="858" x2="858" y1="484.4043" y2="497.4043"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="858" y1="497.4043" y2="497.4043"/><polygon fill="#181818" points="827,493.4043,817,497.4043,827,501.4043,823,497.4043" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="823" y="479.1416">checks invalidation status</text><polygon fill="#0000FF" points="640,524.6953,630,528.6953,640,532.6953,636,528.6953" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="810" y1="528.6953" y2="528.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="646" y="523.4326">receive selection response</text><polygon fill="#181818" points="89,555.9863,79,559.9863,89,563.9863,85,559.9863" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="623" y1="559.9863" y2="559.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="95" y="554.7236">selected active SmartCard image</text><polygon fill="#181818" points="369,587.2773,379,591.2773,369,595.2773,373,591.2773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="591.2773" y2="591.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="85" y="586.0146">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="114" y="586.0146">Calypso card</text><polygon fill="#181818" points="89,653.1504,79,657.1504,89,661.1504,85,657.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="657.1504" y2="657.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="617.3057">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="634.5967">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="127" y="651.8877">- invalidation status]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1532" x="0" y="686.7959"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="686.7959" y2="686.7959"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1532" y1="689.7959" y2="689.7959"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="168" x="682" y="675.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="688" y="693.1787">Card secure transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="768.3145" y2="768.3145"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="768.3145" y2="781.3145"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="781.3145" y2="781.3145"/><polygon fill="#181818" points="89,777.3145,79,781.3145,89,785.3145,85,781.3145" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="728.4697">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="728.4697">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="745.7607">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="763.0518">- Calypso SAM resource</text><polygon fill="#181818" points="369,843.1875,379,847.1875,369,851.1875,373,847.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="847.1875" y2="847.1875"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="807.3428">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="807.3428">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="117" y="824.6338">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="841.9248">- read environment file</text><polygon fill="#181818" points="89,857.1875,79,861.1875,89,865.1875,85,861.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="861.1875" y2="861.1875"/><polygon fill="#181818" points="369,888.4785,379,892.4785,369,896.4785,373,892.4785" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="892.4785" y2="892.4785"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="887.2158">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="887.2158">commands (keep channel open)</text><polygon fill="#00FF00" points="1224.5,954.3516,1234.5,958.3516,1224.5,962.3516,1228.5,958.3516" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1230.5" y1="958.3516" y2="958.3516"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="918.5068">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="935.7979">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="953.0889">- APDU list</text><polygon fill="#181818" points="1465.5,985.6426,1475.5,989.6426,1465.5,993.6426,1469.5,989.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="989.6426" y2="989.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1253.5" y="984.3799">get challenge</text><polygon fill="#181818" points="1257.5,1016.9336,1247.5,1020.9336,1257.5,1024.9336,1253.5,1020.9336" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="1020.9336" y2="1020.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1263.5" y="1015.6709">[SAM challenge]</text><polygon fill="#00FF00" points="402,1048.2246,392,1052.2246,402,1056.2246,398,1052.2246" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1240.5" y1="1052.2246" y2="1052.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="408" y="1046.9619">[SAM challenge]</text><polygon fill="#0000FF" points="794,1114.0977,804,1118.0977,794,1122.0977,798,1118.0977" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="1118.0977" y2="1118.0977"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1078.2529">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1095.5439">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1112.835">- APDU list</text><path d="M605,1133.0977 L885,1133.0977 L885,1142.3887 L875,1152.3887 L605,1152.3887 L605,1133.0977 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="153.7461" style="stroke:#000000;stroke-width:1.5;" width="587.5" x="605" y="1133.0977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="620" y="1148.126">Card APDU commands inside session</text><path d="M615,1157.3887 L615,1184.3887 L1006,1184.3887 L1006,1167.3887 L996,1157.3887 L615,1157.3887 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M996,1157.3887 L996,1167.3887 L1006,1167.3887 L996,1157.3887 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370" x="621" y="1176.417">Optimization: environment file read through the session opening.</text><polygon fill="#181818" points="1141,1243.5527,1151,1247.5527,1141,1251.5527,1145,1247.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="1247.5527" y2="1247.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="823" y="1207.708">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="855" y="1224.999">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="855" y="1242.29">SFI environment to read)</text><polygon fill="#181818" points="827,1274.8438,817,1278.8438,827,1282.8438,823,1278.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="1278.8438" y2="1278.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="833" y="1273.5811">[card challenge &amp; environment data]</text><polygon fill="#0000FF" points="402,1313.1348,392,1317.1348,402,1321.1348,398,1317.1348" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="1317.1348" y2="1317.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="1311.8721">[card challenge]</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="1348.4258" y2="1348.4258"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="1348.4258" y2="1361.4258"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="1361.4258" y2="1361.4258"/><polygon fill="#181818" points="402,1357.4258,392,1361.4258,402,1365.4258,398,1361.4258" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="398" y="1343.1631">checks ratification status</text><polygon fill="#181818" points="89,1457.8809,79,1461.8809,89,1465.8809,85,1461.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1461.8809" y2="1461.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1387.4541">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="1404.7451">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="1422.0361">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="1439.3271">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="1456.6182">- ratification status]</text><polygon fill="#181818" points="369,1506.4629,379,1510.4629,369,1514.4629,373,1510.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1510.4629" y2="1510.4629"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1487.9092">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="1487.9092">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="117" y="1505.2002">- read last event</text><polygon fill="#181818" points="89,1520.4629,79,1524.4629,89,1528.4629,85,1524.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1524.4629" y2="1524.4629"/><polygon fill="#181818" points="369,1551.7539,379,1555.7539,369,1559.7539,373,1555.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1555.7539" y2="1555.7539"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1550.4912">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1550.4912">commands (keep channel open)</text><polygon fill="#0000FF" points="794,1617.627,804,1621.627,794,1625.627,798,1621.627" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="1621.627" y2="1621.627"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1581.7822">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1599.0732">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1616.3643">- APDU list</text><path d="M751,1636.627 L1031,1636.627 L1031,1645.918 L1021,1655.918 L751,1655.918 L751,1636.627 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="1636.627"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="1651.6553">Card APDU commands inside session</text><polygon fill="#181818" points="1141,1675.209,1151,1679.209,1141,1683.209,1145,1679.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="1679.209" y2="1679.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="823" y="1673.9463">read record (last event)</text><polygon fill="#181818" points="827,1706.5,817,1710.5,827,1714.5,823,1710.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="1710.5" y2="1710.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="833" y="1705.2373">[last event data]</text><polygon fill="#0000FF" points="402,1744.791,392,1748.791,402,1752.791,398,1748.791" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="1748.791" y2="1748.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="1743.5283">[last event data]</text><polygon fill="#181818" points="89,1862.5371,79,1866.5371,89,1870.5371,85,1866.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1866.5371" y2="1866.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1774.8193">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="1792.1104">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="1809.4014">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="1826.6924">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="1843.9834">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="127" y="1861.2744">- last event data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="1897.8281" y2="1897.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="1897.8281" y2="1910.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="1910.8281" y2="1910.8281"/><polygon fill="#181818" points="89,1906.8281,79,1910.8281,89,1914.8281,85,1910.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="85" y="1892.5654">checks transaction recovery status</text><polygon fill="#181818" points="369,1955.4102,379,1959.4102,369,1963.4102,373,1959.4102" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1959.4102" y2="1959.4102"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1936.8564">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="1936.8564">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="117" y="1954.1475">- read contract list</text><polygon fill="#181818" points="89,1969.4102,79,1973.4102,89,1977.4102,85,1973.4102" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1973.4102" y2="1973.4102"/><polygon fill="#181818" points="369,2000.7012,379,2004.7012,369,2008.7012,373,2004.7012" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2004.7012" y2="2004.7012"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1999.4385">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1999.4385">commands (keep channel open)</text><polygon fill="#0000FF" points="794,2066.5742,804,2070.5742,794,2074.5742,798,2070.5742" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="2070.5742" y2="2070.5742"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2030.7295">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2048.0205">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2065.3115">- APDU list</text><path d="M751,2085.5742 L1031,2085.5742 L1031,2094.8652 L1021,2104.8652 L751,2104.8652 L751,2085.5742 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2085.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="2100.6025">Card APDU commands inside session</text><polygon fill="#181818" points="1141,2124.1563,1151,2128.1563,1141,2132.1563,1145,2128.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="2128.1563" y2="2128.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="823" y="2122.8936">read record (contract list)</text><polygon fill="#181818" points="827,2155.4473,817,2159.4473,827,2163.4473,823,2159.4473" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="2159.4473" y2="2159.4473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="833" y="2154.1846">[contract list data]</text><polygon fill="#0000FF" points="402,2193.7383,392,2197.7383,402,2201.7383,398,2197.7383" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="2197.7383" y2="2197.7383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="408" y="2192.4756">[contract list data]</text><polygon fill="#181818" points="89,2328.7754,79,2332.7754,89,2336.7754,85,2332.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2332.7754" y2="2332.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="2223.7666">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2241.0576">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="2258.3486">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="2275.6396">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="2292.9307">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="127" y="2310.2217">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2327.5127">- contract list data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="2364.0664" y2="2364.0664"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="2364.0664" y2="2377.0664"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="2377.0664" y2="2377.0664"/><polygon fill="#181818" points="89,2373.0664,79,2377.0664,89,2381.0664,85,2377.0664" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="85" y="2358.8037">identifies contract</text><polygon fill="#181818" points="369,2421.6484,379,2425.6484,369,2429.6484,373,2425.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2425.6484" y2="2425.6484"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2403.0947">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="2403.0947">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="2420.3857">- read contract #x</text><polygon fill="#181818" points="89,2435.6484,79,2439.6484,89,2443.6484,85,2439.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2439.6484" y2="2439.6484"/><polygon fill="#181818" points="369,2466.9395,379,2470.9395,369,2474.9395,373,2470.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2470.9395" y2="2470.9395"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2465.6768">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2465.6768">commands (keep channel open)</text><polygon fill="#0000FF" points="794,2532.8125,804,2536.8125,794,2540.8125,798,2536.8125" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="2536.8125" y2="2536.8125"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2496.9678">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2514.2588">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2531.5498">- APDU list</text><path d="M751,2551.8125 L1031,2551.8125 L1031,2561.1035 L1021,2571.1035 L751,2571.1035 L751,2551.8125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="2551.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="2566.8408">Card APDU commands inside session</text><polygon fill="#181818" points="1141,2590.3945,1151,2594.3945,1141,2598.3945,1145,2594.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="2594.3945" y2="2594.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="823" y="2589.1318">read record (contract #x)</text><polygon fill="#181818" points="827,2621.6855,817,2625.6855,827,2629.6855,823,2625.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="2625.6855" y2="2625.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="833" y="2620.4229">[contract #x data]</text><polygon fill="#0000FF" points="402,2659.9766,392,2663.9766,402,2667.9766,398,2663.9766" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="2663.9766" y2="2663.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="408" y="2658.7139">[contract #x data]</text><polygon fill="#181818" points="89,2812.3047,79,2816.3047,89,2820.3047,85,2816.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2816.3047" y2="2816.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="2690.0049">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="2707.2959">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="2724.5869">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="2741.8779">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="2759.1689">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="127" y="2776.46">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="2793.751">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="2811.042">- contract #x data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="2847.5957" y2="2847.5957"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="2847.5957" y2="2860.5957"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="2860.5957" y2="2860.5957"/><polygon fill="#181818" points="89,2856.5957,79,2860.5957,89,2864.5957,85,2860.5957" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="85" y="2842.333">identifies associated counter</text><polygon fill="#181818" points="369,2905.1777,379,2909.1777,369,2913.1777,373,2909.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2909.1777" y2="2909.1777"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2886.624">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="2886.624">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="117" y="2903.915">- reader counter #x</text><polygon fill="#181818" points="89,2919.1777,79,2923.1777,89,2927.1777,85,2923.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2923.1777" y2="2923.1777"/><polygon fill="#181818" points="369,2950.4688,379,2954.4688,369,2958.4688,373,2954.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2954.4688" y2="2954.4688"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2949.2061">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2949.2061">commands (keep channel open)</text><polygon fill="#0000FF" points="794,3016.3418,804,3020.3418,794,3024.3418,798,3020.3418" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="3020.3418" y2="3020.3418"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2980.4971">Card #6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2997.7881">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3015.0791">- APDU list</text><path d="M751,3035.3418 L1031,3035.3418 L1031,3044.6328 L1021,3054.6328 L751,3054.6328 L751,3035.3418 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="3035.3418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="3050.3701">Card APDU commands inside session</text><polygon fill="#181818" points="1141,3073.9238,1151,3077.9238,1141,3081.9238,1145,3077.9238" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="3077.9238" y2="3077.9238"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="823" y="3072.6611">read record (counter #x)</text><polygon fill="#181818" points="827,3105.2148,817,3109.2148,827,3113.2148,823,3109.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="3109.2148" y2="3109.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="833" y="3103.9521">[counter #1 data]</text><polygon fill="#0000FF" points="402,3143.5059,392,3147.5059,402,3151.5059,398,3147.5059" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="3147.5059" y2="3147.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="3142.2432">[card challenge]</text><polygon fill="#181818" points="89,3313.125,79,3317.125,89,3321.125,85,3317.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3317.125" y2="3317.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3173.5342">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3190.8252">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="3208.1162">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3225.4072">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="127" y="3242.6982">- ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="127" y="3259.9893">- last event data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="3277.2803">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3294.5713">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3311.8623">- counter #x data]</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="3348.416" y2="3348.416"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="3348.416" y2="3361.416"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="3361.416" y2="3361.416"/><polygon fill="#181818" points="89,3357.416,79,3361.416,89,3365.416,85,3361.416" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="85" y="3343.1533">defines data to update</text><polygon fill="#181818" points="369,3440.5801,379,3444.5801,369,3448.5801,373,3444.5801" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="3444.5801" y2="3444.5801"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="3387.4443">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="3387.4443">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="117" y="3404.7354">- decrease counter #x (new value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="117" y="3422.0264">- append event record (new event)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="117" y="3439.3174">- close secure session (not ratified)</text><polygon fill="#181818" points="89,3454.5801,79,3458.5801,89,3462.5801,85,3458.5801" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3458.5801" y2="3458.5801"/><polygon fill="#181818" points="369,3485.8711,379,3489.8711,369,3493.8711,373,3489.8711" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="3489.8711" y2="3489.8711"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="3484.6084">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="3484.6084">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="3521.1621" y2="3521.1621"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="3521.1621" y2="3534.1621"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="3534.1621" y2="3534.1621"/><polygon fill="#181818" points="402,3530.1621,392,3534.1621,402,3538.1621,398,3534.1621" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="398" y="3515.8994">anticipates the future card responses</text><path d="M55,3547.1621 L55,3591.1621 L716,3591.1621 L716,3557.1621 L706,3547.1621 L55,3547.1621 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M706,3547.1621 L706,3557.1621 L716,3557.1621 L706,3547.1621 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="61" y="3566.1904">If the current value of the counter #x were</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="58" x="302" y="3566.1904">unknown</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293" x="360" y="3566.1904">, then the transmission of an additional card APDU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640" x="61" y="3583.4814">message would be necessary to operate the decrease counter in a different message than the session closing.</text><polygon fill="#00FF00" points="1224.5,3650.6172,1234.5,3654.6172,1224.5,3658.6172,1228.5,3654.6172" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1230.5" y1="3654.6172" y2="3654.6172"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="3614.7725">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="3632.0635">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3649.3545">- APDU list</text><polygon fill="#181818" points="1465.5,3681.9082,1475.5,3685.9082,1465.5,3689.9082,1469.5,3685.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3685.9082" y2="3685.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1253.5" y="3680.6455">select diversifier (card serial)</text><polygon fill="#181818" points="1257.5,3695.9082,1247.5,3699.9082,1257.5,3703.9082,1253.5,3699.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3699.9082" y2="3699.9082"/><polygon fill="#181818" points="1465.5,3727.1992,1475.5,3731.1992,1465.5,3735.1992,1469.5,3731.1992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3731.1992" y2="3731.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1253.5" y="3725.9365">digest init (opening data)</text><polygon fill="#181818" points="1257.5,3741.1992,1247.5,3745.1992,1257.5,3749.1992,1253.5,3745.1992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3745.1992" y2="3745.1992"/><polygon fill="#181818" points="1465.5,3772.4902,1475.5,3776.4902,1465.5,3780.4902,1469.5,3776.4902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3776.4902" y2="3776.4902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="1253.5" y="3771.2275">digest update (read environment)</text><polygon fill="#181818" points="1257.5,3786.4902,1247.5,3790.4902,1257.5,3794.4902,1253.5,3790.4902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3790.4902" y2="3790.4902"/><polygon fill="#181818" points="1465.5,3817.7813,1475.5,3821.7813,1465.5,3825.7813,1469.5,3821.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3821.7813" y2="3821.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="1253.5" y="3816.5186">digest update (last event)</text><polygon fill="#181818" points="1257.5,3831.7813,1247.5,3835.7813,1257.5,3839.7813,1253.5,3835.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3835.7813" y2="3835.7813"/><polygon fill="#181818" points="1465.5,3863.0723,1475.5,3867.0723,1465.5,3871.0723,1469.5,3867.0723" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3867.0723" y2="3867.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="1253.5" y="3861.8096">digest update (read contract list)</text><polygon fill="#181818" points="1257.5,3877.0723,1247.5,3881.0723,1257.5,3885.0723,1253.5,3881.0723" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3881.0723" y2="3881.0723"/><polygon fill="#181818" points="1465.5,3908.3633,1475.5,3912.3633,1465.5,3916.3633,1469.5,3912.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3912.3633" y2="3912.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1253.5" y="3907.1006">digest update (read contract #x)</text><polygon fill="#181818" points="1257.5,3922.3633,1247.5,3926.3633,1257.5,3930.3633,1253.5,3926.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3926.3633" y2="3926.3633"/><polygon fill="#181818" points="1465.5,3953.6543,1475.5,3957.6543,1465.5,3961.6543,1469.5,3957.6543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="3957.6543" y2="3957.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1253.5" y="3952.3916">digest update (read counters)</text><polygon fill="#181818" points="1257.5,3967.6543,1247.5,3971.6543,1257.5,3975.6543,1253.5,3971.6543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="3971.6543" y2="3971.6543"/><path d="M1182.5,3986.6543 L1439.5,3986.6543 L1439.5,3995.9453 L1429.5,4005.9453 L1182.5,4005.9453 L1182.5,3986.6543 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="339.5" x="1182.5" y="3986.6543"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="1197.5" y="4001.6826">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1272.5" y="4001.6826">Card APDU responses</text><polygon fill="#181818" points="1465.5,4025.2363,1475.5,4029.2363,1465.5,4033.2363,1469.5,4029.2363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4029.2363" y2="4029.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="1253.5" y="4023.9736">digest update (decrease counter)</text><polygon fill="#181818" points="1257.5,4039.2363,1247.5,4043.2363,1257.5,4047.2363,1253.5,4043.2363" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4043.2363" y2="4043.2363"/><polygon fill="#181818" points="1465.5,4070.5273,1475.5,4074.5273,1465.5,4078.5273,1469.5,4074.5273" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4074.5273" y2="4074.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="1253.5" y="4069.2646">digest update (append event record)</text><polygon fill="#181818" points="1257.5,4084.5273,1247.5,4088.5273,1257.5,4092.5273,1253.5,4088.5273" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4088.5273" y2="4088.5273"/><polygon fill="#181818" points="1465.5,4122.8184,1475.5,4126.8184,1465.5,4130.8184,1469.5,4126.8184" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4126.8184" y2="4126.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1253.5" y="4121.5557">digest close</text><polygon fill="#181818" points="1257.5,4154.1094,1247.5,4158.1094,1257.5,4162.1094,1253.5,4158.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4158.1094" y2="4158.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1263.5" y="4152.8467">[SAM certificate]</text><polygon fill="#00FF00" points="402,4185.4004,392,4189.4004,402,4193.4004,398,4189.4004" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1240.5" y1="4189.4004" y2="4189.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="408" y="4184.1377">[SAM certificate]</text><polygon fill="#0000FF" points="794,4251.2734,804,4255.2734,794,4259.2734,798,4255.2734" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="800" y1="4255.2734" y2="4255.2734"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="4215.4287">Card #7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="4232.7197">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="4250.0107">- APDU list</text><path d="M751,4270.2734 L1031,4270.2734 L1031,4279.5645 L1021,4289.5645 L751,4289.5645 L751,4270.2734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="441.5" x="751" y="4270.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="766" y="4285.3018">Card APDU commands inside session</text><polygon fill="#181818" points="1141,4308.8555,1151,4312.8555,1141,4316.8555,1145,4312.8555" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4312.8555" y2="4312.8555"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="823" y="4307.5928">decrease counter (counter #1, value)</text><polygon fill="#181818" points="827,4340.1465,817,4344.1465,827,4348.1465,823,4344.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4344.1465" y2="4344.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="833" y="4338.8838">[new counter value]</text><polygon fill="#181818" points="1141,4371.4375,1151,4375.4375,1141,4379.4375,1145,4375.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4375.4375" y2="4375.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="823" y="4370.1748">append record (event, data)</text><polygon fill="#181818" points="827,4385.4375,817,4389.4375,827,4393.4375,823,4389.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4389.4375" y2="4389.4375"/><polygon fill="#181818" points="1141,4423.7285,1151,4427.7285,1141,4431.7285,1145,4427.7285" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4427.7285" y2="4427.7285"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313" x="823" y="4422.4658">close secure session (SAM certificate, as non ratified)</text><polygon fill="#181818" points="827,4455.0195,817,4459.0195,827,4463.0195,823,4459.0195" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4459.0195" y2="4459.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="833" y="4453.7568">[card certificate]</text><polygon fill="#181818" points="1141,4486.3105,1151,4490.3105,1141,4494.3105,1145,4490.3105" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4490.3105" y2="4490.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="823" y="4485.0479">ratification command</text><polygon fill="#181818" points="827,4500.3105,817,4504.3105,827,4508.3105,823,4504.3105" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1152" y1="4504.3105" y2="4504.3105"/><polygon fill="#181818" points="1141,4531.6016,1151,4535.6016,1141,4539.6016,1145,4535.6016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="816" x2="1147" y1="4535.6016" y2="4535.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="823" y="4530.3389">close card channel</text><polygon fill="#181818" points="827,4545.6016,817,4549.6016,827,4553.6016,823,4549.6016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="821" x2="1157" y1="4549.6016" y2="4549.6016"/><polygon fill="#0000FF" points="402,4576.8926,392,4580.8926,402,4584.8926,398,4580.8926" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="810" y1="4580.8926" y2="4580.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="408" y="4575.6299">[card certificate]</text><polygon fill="#00FF00" points="1224.5,4642.7656,1234.5,4646.7656,1224.5,4650.7656,1228.5,4646.7656" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="1230.5" y1="4646.7656" y2="4646.7656"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="4606.9209">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="4624.2119">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="4641.5029">- APDU list</text><polygon fill="#181818" points="1465.5,4674.0566,1475.5,4678.0566,1465.5,4682.0566,1469.5,4678.0566" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1246.5" x2="1471.5" y1="4678.0566" y2="4678.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="1253.5" y="4672.7939">digest authenticate (card certificate)</text><polygon fill="#181818" points="1257.5,4705.3477,1247.5,4709.3477,1257.5,4713.3477,1253.5,4709.3477" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1251.5" x2="1476.5" y1="4709.3477" y2="4709.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1263.5" y="4704.085">[authentication status]</text><polygon fill="#00FF00" points="402,4736.6387,392,4740.6387,402,4744.6387,398,4740.6387" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="1240.5" y1="4740.6387" y2="4740.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="408" y="4735.376">[authentification status]</text><polygon fill="#181818" points="89,4923.5488,79,4927.5488,89,4931.5488,85,4927.5488" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="4927.5488" y2="4927.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="4766.667">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="4783.958">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="4801.249">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="4818.54">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="127" y="4835.8311">-</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="line-through" textLength="99" x="135" y="4835.8311">ratification status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="127" y="4853.1221">- last event data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="4870.4131">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="4887.7041">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="127" y="4904.9951">- counter #x data (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="4922.2861">authentification status</text><!--SRC=[tLbBSzis4BxhLs2YcSRYcAqVSXnxRCz85DNnePDCafvY7M0IaZ2YG9Q4RAk_lei7IO0FINRLnh5FChXlxBUxNBxF5fGbECLBv4KuouPn6fBKYwCuHTtniTS_6dSsaOpw0-zeP91adAGavkk432p2mSN86uqR2Myjmc5_SEwVDH9wjiJHw7XuqaZeMuJ-yEBKLZt7OVn8sGnDSPIHZl7eAyUSRFPm473wGFcwYQhp7dqXOIrYE5ZCqdZ5GabzTPMIyEO6uZloHxwt8Ru5fN_Uzqwzpfo61EM7fRkWzVCgJIAoLN4YoQJklk-DppVgBea_-lt-O9IhByuj2-wZrNRzWaZwCnoVZOSRjUUaf_sBZwDXhbkVMff_JmbXMrNF19NKFHWFniSRTHUq9xxddH_dolDZGpke_vHYDjlkUYp9rBMFJ_oBZGQKnFw7S__a9BUWEBTDW0YiTmd0MldlUxw_pNz9UkAT-cT7XllhYceSSCZ-Tzzei21S06gG914DCASnUuTmXd2IeEuiZi8EwE8qe0bc7BtpSBHEiXWDFjzAiW0d57KJoXOstHU2mQg2B6qXoyLvE0tlc6BISjDGo-X6T3RdGv6bzo8gE5sZTuuZM1od83R96bLy7VnXQSZmqbAWah7Ka96819o0MOu3l5eLS5dq8f3q0KgF4R3Yg4PyVIqzHKesX1hzWk2A6ATJ7NjqVTtfi1YOumSmJOItW-3l4ulMA0LxCnHYZX5bcRXRFWSj9Ck0yzSEOI4Ih61KahWtWlSINKrZY48WqkDQb1_7IL820IAES_MRU7QZmbUQb0M4uPJ6btViZhjeIYF86tI_Hbb20c4e6joEh6UKFU28WbqarCAW6A-oCX0oI_JzYz-kUmCcTa9YKMYxqrQxum1SBUqcJo9bAMzpeDIV6lh5R_TxzmZ-nkF9JPbejavPhrIMeUvneVIESK1ojWIjfSAK_BKY6LSnCOo9KpC4JGdTAOzTQSebYXF2b91WZXaZaIt3v1R_kwxXGeCuPOd8pXpUw03Ji5TdlaJVfOAnTpkf2Sf9WZa95bbvupBUwhPD7YF0wZfJ4X3wGAoWPKdCe8bRML1uekv9vadk16INf2Jewn8GBg-6Bl7C4f6MYQG0u3W1phZZeBmG22NRKXDYOP8hDHeG5S0AEEe7zQ1CElKaBuj0i4e1mYAVS520NvekJN0SG3c78aQ1kUA0oQRjiXv3TEDL6X3x4TInuicBgaHTgqnNxOgkHEXWv0zlly5b2RoYY3oGgAUeHGL3X3tGD6PB2AEe8EI5TIBOjKu4yNA96LJEWmKXIGuhQNclMRTIBd9uF3uwcjmKlSBMfyOAsHvKZQZOOXGBVIb6dHXy7ls98ffngryqjAJYr1LsNA8PuSA7A29oUi5BrpKD_2wiAPvF3FR2dpnsLL8ZpWMN4Ojd5CoJfeAvKmnQwgGOY1A56ybKtAbkX3hrhDPPr1BPG1DEb_Hl2SxBMWggnEHpq3ARcrrLPWdCHsPt5U9QwdOL2DBbaDo3zmkoFXHUMp5N9-DRoo0UItDwXQB6Cbt8W1d2v1RrQ2AiRIl8-kvj8PEMCYmlNxFesfzYe_gLjN_VfLCzg7gcoqZTXCcpgyHkzKqc1ipP744PO_mrrwfduFFqH-6p6Jioo30YmAiCEYY3tOw0acRdVA-njCmTFpoJrOFDvXQ99StKm3Gd2H5Cg8Bh0g3x0qCGYvI1cRAQ63yn7lgl60zMl3Sq1PDizoxGmFLJ0KE_T6rpmmPCRYJ92ix_127TfpU2ZxEV0H_TfntGqNrwFZOAdZU1ZCfvitEjUC5P5WTKhNhY5UF2_xqXHupjIkZRWSw7LmsTFDYRaADfZlVyQl4cO9EVvd7SZgMGJ2aZUeqBhtghH2nEdmaY7PkG172V6J4DE63a4K5aLaJlN42mU7TL7kOtBuZKZAqzYEACr5vVuNrNnus46p6nPq0gQt94uYcurjjG3hGAiIaJMtyEqHMlyDCL5zxa-p2vRSoQbkktKqaFlgSYHZ9uADQ7PMGV2KXpd1LRiFYHESwX862IIWDRhmocO0h2OKX5hk58MI2mAhKjmMb8R_GOhw8GtHF4Y8Y3-EW0wG3b9nLE2gcrwwKW5eLqEYNIq5mIXq1PImiHlyhIuWKRhPSlSPeNMRLDbjvDXnHk8nD9bkgDIKPIYgDUTRbL4n3I6PW1OG733lIcHW9hPrQ5FdHGNKm-Mu3vrleItPKf_r-94ENyPG9accLrRjLpwXWk8HUME2vRKuawaVXRJAXcUozdiYpPGL13mMkM9JfPYonPWTgMgoJLhGHws_Rzgaczlmth-UiQAsgbgfmjZWzrEseTCKGpoiabwQH5YxxPl8d96pxKW6yKNXjMjA3cTbUvhaFnmPU9PKhH0jktiUOjDqnTvl2X8xlJvplT2StFWNMsodnbELoabMjFPorPMPlFdjSoJlVSCbhGYLUYyt9flcuPXaEz1jmQ7DRNkKtepNasRPghAFxVnbdNRHXeNRTnf4K7gZI6lJqCjwMmoHrh2L5r4lm7]--></g></svg>