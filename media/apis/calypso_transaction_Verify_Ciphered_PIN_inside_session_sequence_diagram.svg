<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3370px" preserveAspectRatio="none" style="width:1325px;height:3370px;background:#FFFFFF;" version="1.1" viewBox="0 0 1325 3370" width="1325px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="264.9492"/><rect fill="#FFC0CB" height="675.5664" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="310.2402"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1017.0977"/><rect fill="#FFC0CB" height="964.6035" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1062.3887"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2110.1563"/><rect fill="#FFC0CB" height="1076.7676" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2192.7383"/><rect fill="#ADD8E6" height="286.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="581.1504"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1128.2617"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1799.373"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="2631.8125"/><rect fill="#ADD8E6" height="2832.5195" style="stroke:#181818;stroke-width:1.0;" width="10" x="877" y="93.6211"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="376.1133"/><rect fill="#90EE90" height="412.2012" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="1321.2988"/><rect fill="#90EE90" height="263.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2302.9023"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="3023.3047"/><rect fill="#90EE90" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="1274.5" y="93.6211"/><rect fill="none" height="241.6191" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="596.1504"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1143.2617"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1814.373"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="407.5" x="911.5" y="2363.1934"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="2646.8125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="386" x2="386" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624" x2="624" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="881.5" x2="881.5" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="970.5" x2="970.5" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1279" x2="1279" y1="83.6211" y2="3287.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="3301.6133">Ticketing Application</text><ellipse cx="73" cy="3313.627" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,3321.627 L73,3348.627 M60,3329.627 L86,3329.627 M73,3348.627 L60,3363.627 M73,3348.627 L86,3363.627 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="3286.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="3308.6133">Calypso API</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="574" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="581" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="600.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="574" y="3286.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="581" y="3308.6133">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="600.5" y="3327.2344">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="852.5" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="862.5" y="80.1074">Card</text><path d="M861.5,18.3789 L861.5,42.3789 M861.5,30.3789 L878.5,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="890.5" cy="30.3789" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="852.5" y="3301.6133">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="862.5" y="3320.2344">Card</text><path d="M861.5,3327.748 L861.5,3351.748 M861.5,3339.748 L878.5,3339.748 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="890.5" cy="3339.748" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="921.5" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="928.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="947" y="72.1074">Reader</text><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="921.5" y="3286.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="928.5" y="3308.6133">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="947" y="3327.2344">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1250" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1261" y="80.1074">SAM</text><path d="M1259,18.3789 L1259,42.3789 M1259,30.3789 L1276,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1288" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1250" y="3301.6133">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1261" y="3320.2344">SAM</text><path d="M1259,3327.748 L1259,3351.748 M1259,3339.748 L1276,3339.748 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1288" cy="3339.748" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="264.9492"/><rect fill="#FFC0CB" height="675.5664" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="310.2402"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1017.0977"/><rect fill="#FFC0CB" height="964.6035" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1062.3887"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2110.1563"/><rect fill="#FFC0CB" height="1076.7676" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2192.7383"/><rect fill="#ADD8E6" height="286.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="581.1504"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1128.2617"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1799.373"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="2631.8125"/><rect fill="#ADD8E6" height="2832.5195" style="stroke:#181818;stroke-width:1.0;" width="10" x="877" y="93.6211"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="376.1133"/><rect fill="#90EE90" height="412.2012" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="1321.2988"/><rect fill="#90EE90" height="263.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2302.9023"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="3023.3047"/><rect fill="#90EE90" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="1274.5" y="93.6211"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="151.4941" y2="151.4941"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="151.4941" y2="164.4941"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="164.4941" y2="164.4941"/><polygon fill="#181818" points="89,160.4941,79,164.4941,89,168.4941,85,164.4941" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="111.6494">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="111.6494">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="128.9404">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="146.2314">- Calypso SAM resource</text><polygon fill="#181818" points="369,260.9492,379,264.9492,369,268.9492,373,264.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="264.9492" y2="264.9492"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="190.5225">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="190.5225">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="117" y="207.8135">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="225.1045">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="242.3955">- read contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="117" y="259.6865">- reader counter #1</text><polygon fill="#181818" points="89,274.9492,79,278.9492,89,282.9492,85,278.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="278.9492" y2="278.9492"/><polygon fill="#181818" points="369,306.2402,379,310.2402,369,314.2402,373,310.2402" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="310.2402" y2="310.2402"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="304.9775">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="304.9775">commands (keep channel open)</text><polygon fill="#00FF00" points="953.5,372.1133,963.5,376.1133,953.5,380.1133,957.5,376.1133" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="376.1133" y2="376.1133"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="336.2686">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="353.5596">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="370.8506">- APDU list</text><polygon fill="#181818" points="1262.5,403.4043,1272.5,407.4043,1262.5,411.4043,1266.5,407.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="407.4043" y2="407.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="982.5" y="402.1416">select diversifier (card serial)</text><polygon fill="#181818" points="986.5,417.4043,976.5,421.4043,986.5,425.4043,982.5,421.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="421.4043" y2="421.4043"/><polygon fill="#181818" points="1262.5,448.6953,1272.5,452.6953,1262.5,456.6953,1266.5,452.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="452.6953" y2="452.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="982.5" y="447.4326">get challenge</text><polygon fill="#181818" points="986.5,479.9863,976.5,483.9863,986.5,487.9863,982.5,483.9863" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="483.9863" y2="483.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="992.5" y="478.7236">[SAM challenge]</text><polygon fill="#00FF00" points="402,511.2773,392,515.2773,402,519.2773,398,515.2773" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="515.2773" y2="515.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="408" y="510.0146">[SAM challenge]</text><polygon fill="#0000FF" points="607,577.1504,617,581.1504,607,585.1504,611,581.1504" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="581.1504" y2="581.1504"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="541.3057">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="558.5967">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="575.8877">- APDU list</text><path d="M564,596.1504 L844,596.1504 L844,605.4414 L834,615.4414 L564,615.4414 L564,596.1504 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="241.6191" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="596.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="611.1787">Card APDU commands inside session</text><polygon fill="#181818" points="865,669.3145,875,673.3145,865,677.3145,869,673.3145" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="673.3145" y2="673.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="636" y="633.4697">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="668" y="650.7607">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="668" y="668.0518">SFI environment to read)</text><polygon fill="#181818" points="640,700.6055,630,704.6055,640,708.6055,636,704.6055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="704.6055" y2="704.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="646" y="699.3428">[card challenge &amp; environment data]</text><polygon fill="#181818" points="865,731.8965,875,735.8965,865,739.8965,869,735.8965" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="735.8965" y2="735.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="636" y="730.6338">read record (contract #1)</text><polygon fill="#181818" points="640,763.1875,630,767.1875,640,771.1875,636,767.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="767.1875" y2="767.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="646" y="761.9248">[contract #1 data]</text><polygon fill="#181818" points="865,794.4785,875,798.4785,865,802.4785,869,798.4785" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="798.4785" y2="798.4785"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="636" y="793.2158">read record (counter #1)</text><polygon fill="#181818" points="640,825.7695,630,829.7695,640,833.7695,636,829.7695" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="829.7695" y2="829.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="646" y="824.5068">[counter #1 data]</text><polygon fill="#0000FF" points="402,864.0605,392,868.0605,402,872.0605,398,868.0605" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="868.0605" y2="868.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="862.7979">[card challenge]</text><polygon fill="#181818" points="89,981.8066,79,985.8066,89,989.8066,85,985.8066" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="985.8066" y2="985.8066"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="894.0889">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="911.3799">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="127" y="928.6709">- environment data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="945.9619">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="963.2529">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="980.5439">- counter #1 data]</text><polygon fill="#181818" points="369,1013.0977,379,1017.0977,369,1021.0977,373,1017.0977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1017.0977" y2="1017.0977"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1011.835">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="139" y="1011.835">Verify PIN (plain PIN value)</text><polygon fill="#181818" points="89,1027.0977,79,1031.0977,89,1035.0977,85,1031.0977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="1031.0977" y2="1031.0977"/><polygon fill="#181818" points="369,1058.3887,379,1062.3887,369,1066.3887,373,1062.3887" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1062.3887" y2="1062.3887"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1057.126">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1057.126">commands (keep channel open)</text><polygon fill="#0000FF" points="607,1124.2617,617,1128.2617,607,1132.2617,611,1128.2617" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="1128.2617" y2="1128.2617"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1088.417">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1105.708">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1122.999">- APDU list</text><path d="M564,1143.2617 L844,1143.2617 L844,1152.5527 L834,1162.5527 L564,1162.5527 L564,1143.2617 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1143.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="1158.29">Card APDU commands inside session</text><polygon fill="#181818" points="865,1181.8438,875,1185.8438,865,1189.8438,869,1185.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="1185.8438" y2="1185.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="636" y="1180.5811">Get Challenge</text><polygon fill="#181818" points="640,1213.1348,630,1217.1348,640,1221.1348,636,1217.1348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="1217.1348" y2="1217.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="646" y="1211.8721">[PIN Card challenge]</text><polygon fill="#0000FF" points="402,1251.4258,392,1255.4258,402,1259.4258,398,1255.4258" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="1255.4258" y2="1255.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="408" y="1250.1631">[Card challenge]</text><polygon fill="#00FF00" points="953.5,1317.2988,963.5,1321.2988,953.5,1325.2988,957.5,1321.2988" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="1321.2988" y2="1321.2988"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="1281.4541">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1298.7451">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1316.0361">- APDU list</text><path d="M722,1334.2988 L722,1361.2988 L1219,1361.2988 L1219,1344.2988 L1209,1334.2988 L722,1334.2988 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1209,1334.2988 L1209,1344.2988 L1219,1344.2988 L1209,1334.2988 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476" x="728" y="1353.3271">When ciphered PIN verification requested, processes all pending SAM commands.</text><polygon fill="#181818" points="1262.5,1385.8809,1272.5,1389.8809,1262.5,1393.8809,1266.5,1389.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1389.8809" y2="1389.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="982.5" y="1384.6182">digest init (opening data)</text><polygon fill="#181818" points="986.5,1399.8809,976.5,1403.8809,986.5,1407.8809,982.5,1403.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1403.8809" y2="1403.8809"/><polygon fill="#181818" points="1262.5,1431.1719,1272.5,1435.1719,1262.5,1439.1719,1266.5,1435.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1435.1719" y2="1435.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="982.5" y="1429.9092">digest update (read environment)</text><polygon fill="#181818" points="986.5,1445.1719,976.5,1449.1719,986.5,1453.1719,982.5,1449.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1449.1719" y2="1449.1719"/><polygon fill="#181818" points="1262.5,1476.4629,1272.5,1480.4629,1262.5,1484.4629,1266.5,1480.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1480.4629" y2="1480.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="982.5" y="1475.2002">digest update (read contract)</text><polygon fill="#181818" points="986.5,1490.4629,976.5,1494.4629,986.5,1498.4629,982.5,1494.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1494.4629" y2="1494.4629"/><polygon fill="#181818" points="1262.5,1521.7539,1272.5,1525.7539,1262.5,1529.7539,1266.5,1525.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1525.7539" y2="1525.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="982.5" y="1520.4912">digest update (read counter)</text><polygon fill="#181818" points="986.5,1535.7539,976.5,1539.7539,986.5,1543.7539,982.5,1539.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1539.7539" y2="1539.7539"/><path d="M712,1552.7539 L712,1579.7539 L1229,1579.7539 L1229,1562.7539 L1219,1552.7539 L712,1552.7539 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1219,1552.7539 L1219,1562.7539 L1229,1562.7539 L1219,1552.7539 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="496" x="718" y="1571.7822">Diversification for the PIN ciphering is necessarily the same as for the secure session.</text><polygon fill="#181818" points="1262.5,1604.3359,1272.5,1608.3359,1262.5,1612.3359,1266.5,1608.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1608.3359" y2="1608.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="982.5" y="1603.0732">Give Random (PIN card challenge)</text><polygon fill="#181818" points="986.5,1635.627,976.5,1639.627,986.5,1643.627,982.5,1639.627" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1639.627" y2="1639.627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="992.5" y="1634.3643">ack</text><polygon fill="#181818" points="1262.5,1666.918,1272.5,1670.918,1262.5,1674.918,1266.5,1670.918" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1670.918" y2="1670.918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="982.5" y="1665.6553">Card Cipher PIN (plain PIN, debit key reference)</text><polygon fill="#181818" points="986.5,1698.209,976.5,1702.209,986.5,1706.209,982.5,1702.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1702.209" y2="1702.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="992.5" y="1696.9463">[ciphered PIN]</text><polygon fill="#00FF00" points="402,1729.5,392,1733.5,402,1737.5,398,1733.5" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="1733.5" y2="1733.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="408" y="1728.2373">[ciphered PIN]</text><polygon fill="#0000FF" points="607,1795.373,617,1799.373,607,1803.373,611,1799.373" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="1799.373" y2="1799.373"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1759.5283">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1776.8193">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1794.1104">- APDU list</text><path d="M564,1814.373 L844,1814.373 L844,1823.6641 L834,1833.6641 L564,1833.6641 L564,1814.373 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1814.373"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="1829.4014">Card APDU commands inside session</text><polygon fill="#181818" points="865,1852.9551,875,1856.9551,865,1860.9551,869,1856.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="1856.9551" y2="1856.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="636" y="1851.6924">Verify PIN (ciphered PIN)</text><polygon fill="#181818" points="640,1884.2461,630,1888.2461,640,1892.2461,636,1888.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="1888.2461" y2="1888.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="646" y="1882.9834">[PIN status]</text><polygon fill="#0000FF" points="402,1922.5371,392,1926.5371,402,1930.5371,398,1926.5371" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="1926.5371" y2="1926.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="408" y="1921.2744">[PIN status]</text><polygon fill="#181818" points="89,2022.9922,79,2026.9922,89,2030.9922,85,2026.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2026.9922" y2="2026.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1952.5654">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="127" y="1969.8564">- identification data with PIN support</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="127" y="1987.1475">- key #1 reference (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="127" y="2004.4385">- key #2 reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="127" y="2021.7295">- key #3 reference]</text><polygon fill="#181818" points="369,2106.1563,379,2110.1563,369,2114.1563,373,2110.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2110.1563" y2="2110.1563"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2053.0205">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="2053.0205">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="117" y="2070.3115">- decrease counter #1 (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="117" y="2087.6025">- append event record (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="117" y="2104.8936">- close secure session (not ratified)</text><polygon fill="#181818" points="89,2120.1563,79,2124.1563,89,2128.1563,85,2124.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2124.1563" y2="2124.1563"/><path d="M155,2137.1563 L155,2164.1563 L616,2164.1563 L616,2147.1563 L606,2137.1563 L155,2137.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M606,2137.1563 L606,2147.1563 L616,2147.1563 L606,2137.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440" x="161" y="2156.1846">At the session closure, any data secure processing should be unnecessary.</text><polygon fill="#181818" points="369,2188.7383,379,2192.7383,369,2196.7383,373,2192.7383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2192.7383" y2="2192.7383"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2187.4756">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2187.4756">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="2224.0293" y2="2224.0293"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="2224.0293" y2="2237.0293"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="2237.0293" y2="2237.0293"/><polygon fill="#181818" points="402,2233.0293,392,2237.0293,402,2241.0293,398,2237.0293" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="398" y="2218.7666">anticipates the future card responses</text><polygon fill="#00FF00" points="953.5,2298.9023,963.5,2302.9023,953.5,2306.9023,957.5,2302.9023" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="2302.9023" y2="2302.9023"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2263.0576">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2280.3486">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2297.6396">- APDU list</text><polygon fill="#181818" points="1262.5,2330.1934,1272.5,2334.1934,1262.5,2338.1934,1266.5,2334.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2334.1934" y2="2334.1934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="982.5" y="2328.9307">digest update (verify PIN)</text><polygon fill="#181818" points="986.5,2344.1934,976.5,2348.1934,986.5,2352.1934,982.5,2348.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2348.1934" y2="2348.1934"/><path d="M911.5,2363.1934 L1168.5,2363.1934 L1168.5,2372.4844 L1158.5,2382.4844 L911.5,2382.4844 L911.5,2363.1934 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="407.5" x="911.5" y="2363.1934"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="926.5" y="2378.2217">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1001.5" y="2378.2217">Card APDU responses</text><polygon fill="#181818" points="1262.5,2401.7754,1272.5,2405.7754,1262.5,2409.7754,1266.5,2405.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2405.7754" y2="2405.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="982.5" y="2400.5127">digest update (decrease counter)</text><polygon fill="#181818" points="986.5,2415.7754,976.5,2419.7754,986.5,2423.7754,982.5,2419.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2419.7754" y2="2419.7754"/><polygon fill="#181818" points="1262.5,2447.0664,1272.5,2451.0664,1262.5,2455.0664,1266.5,2451.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2451.0664" y2="2451.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="982.5" y="2445.8037">digest update (append event record)</text><polygon fill="#181818" points="986.5,2461.0664,976.5,2465.0664,986.5,2469.0664,982.5,2465.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2465.0664" y2="2465.0664"/><polygon fill="#181818" points="1262.5,2499.3574,1272.5,2503.3574,1262.5,2507.3574,1266.5,2503.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2503.3574" y2="2503.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="982.5" y="2498.0947">digest close</text><polygon fill="#181818" points="986.5,2530.6484,976.5,2534.6484,986.5,2538.6484,982.5,2534.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2534.6484" y2="2534.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="992.5" y="2529.3857">[SAM certificate]</text><polygon fill="#00FF00" points="402,2561.9395,392,2565.9395,402,2569.9395,398,2565.9395" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="2565.9395" y2="2565.9395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="408" y="2560.6768">[SAM certificate]</text><polygon fill="#0000FF" points="607,2627.8125,617,2631.8125,607,2635.8125,611,2631.8125" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="2631.8125" y2="2631.8125"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2591.9678">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2609.2588">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2626.5498">- APDU list</text><path d="M564,2646.8125 L844,2646.8125 L844,2656.1035 L834,2666.1035 L564,2666.1035 L564,2646.8125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="2646.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="2661.8408">Card APDU commands inside session</text><polygon fill="#181818" points="865,2685.3945,875,2689.3945,865,2693.3945,869,2689.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2689.3945" y2="2689.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="636" y="2684.1318">update record (event, data)</text><polygon fill="#181818" points="640,2699.3945,630,2703.3945,640,2707.3945,636,2703.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2703.3945" y2="2703.3945"/><polygon fill="#181818" points="865,2730.6855,875,2734.6855,865,2738.6855,869,2734.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2734.6855" y2="2734.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="636" y="2729.4229">decrease counter (counter #1, value)</text><polygon fill="#181818" points="640,2761.9766,630,2765.9766,640,2769.9766,636,2765.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2765.9766" y2="2765.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="646" y="2760.7139">[new counter value]</text><polygon fill="#181818" points="865,2800.2676,875,2804.2676,865,2808.2676,869,2804.2676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2804.2676" y2="2804.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="636" y="2799.0049">close secure session (SAM certificate)</text><polygon fill="#181818" points="640,2831.5586,630,2835.5586,640,2839.5586,636,2835.5586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2835.5586" y2="2835.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="646" y="2830.2959">[card certificate]</text><polygon fill="#181818" points="865,2862.8496,875,2866.8496,865,2870.8496,869,2866.8496" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2866.8496" y2="2866.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="636" y="2861.5869">ratification command</text><polygon fill="#181818" points="640,2876.8496,630,2880.8496,640,2884.8496,636,2880.8496" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2880.8496" y2="2880.8496"/><polygon fill="#181818" points="865,2908.1406,875,2912.1406,865,2916.1406,869,2912.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2912.1406" y2="2912.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="636" y="2906.8779">close card channel</text><polygon fill="#181818" points="640,2922.1406,630,2926.1406,640,2930.1406,636,2926.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="881" y1="2926.1406" y2="2926.1406"/><polygon fill="#0000FF" points="402,2953.4316,392,2957.4316,402,2961.4316,398,2957.4316" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="2957.4316" y2="2957.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="408" y="2952.1689">[card certificate]</text><polygon fill="#00FF00" points="953.5,3019.3047,963.5,3023.3047,953.5,3027.3047,957.5,3023.3047" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="3023.3047" y2="3023.3047"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2983.46">SAM #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="3000.751">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3018.042">- APDU list</text><polygon fill="#181818" points="1262.5,3050.5957,1272.5,3054.5957,1262.5,3058.5957,1266.5,3054.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="3054.5957" y2="3054.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="982.5" y="3049.333">digest authenticate (card certificate)</text><polygon fill="#181818" points="986.5,3081.8867,976.5,3085.8867,986.5,3089.8867,982.5,3085.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="3085.8867" y2="3085.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="992.5" y="3080.624">[authentication status]</text><polygon fill="#00FF00" points="402,3113.1777,392,3117.1777,402,3121.1777,398,3117.1777" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="3117.1777" y2="3117.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="408" y="3111.915">[authentification status]</text><polygon fill="#181818" points="89,3265.5059,79,3269.5059,89,3273.5059,85,3269.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3269.5059" y2="3269.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3143.2061">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3160.4971">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3177.7881">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="3195.0791">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3212.3701">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="127" y="3229.6611">- counter #1 data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="127" y="3246.9521">- event #1 (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="3264.2432">authentification status</text><!--SRC=[pLTBS-8u4BxxLwYIgXsWmYu1ifcaiga2Or8vx6vgPdRta71Gx0PKCRB75apnxxSbMxRb5qEAGt8W8FNpK_VNqgVuZV6GHdH3R9_6yJI8F8Zim0yYSZw_jCU3kTKcCXjFxC6i818BY20G-n0cXk3aPcRFvhM2ZuRWT3ovTgvg1MtJucnsEHtM2Zg6e3Ez6PckrzGBVZ2-8algns0LjhuAAg0zmuahs8w9VPsKzOby0Q-267NVLb6mvPwIlhkBmBk_HtndpionM_3D99thiJsohJNpWEZ5F5tq-hIDGXyEEWwLcF8zTkpvTQllNFYpCnvFPjfzjcv4yEfl3_kNGYgVwVngFctrhaL7uvlFiwdsdQuQdXyY07xGzKfAAT-J-MH-sUexanqwjdrzgPthvO9tTFztHFdgSEg14akEVJvqRbe3o8MTtw-TuL17aAsR8I02-vy1O9_axzYESoX_9JgqHyxLe93-lkIQkWAh_-mRSzz0o8QQXA7FN2fOmCy8ZGaDGtA-2dpFGb-2kIoaN90pc_hxC0x8vEbHYRaqPEGyPFojNiwcaVV2lm3565E5o4j-adEVhTPYAillLQPBepqvYy47Lm0gzNfIkTVBr8eAjSw-JluqVCLqOxXAwgtU5-gchb3Ba9TOiHsoIm6JRAaSLxPHjHA6_Nlyk2Mz7kEnmCWP2lPwH8UlR0aib5XQ2VZj2tyHVNCxWZZOHYwOMnXyjcEbhkJ9t9AxPO08kR8w_f3iq-k54I1uwFVkDxbtt-Gs286J6DnjXCb07ECEwSoSwUCtGbqN5uWFE_2xYNI4E1FWEnO5V0FeSibyA6ovw2f2- -JyCb_5Wt7nC8GyeCiYfbXJQL79xts5c-M18N4mpK06MKWps6mezsBIUGC8YRkcd8ElqkpM-qwSFvyF1lFvOB2upyh9z9UGYweWJ0CTbc9vuGhS3HFw2Bzl8HO939EdsJ_4Px4mAgUcQgrikIy3kIL9yHAFxI2AsPAXV4VPZo5YrEzAXNu_3xfYO0L2ek3xe5ZGbBubppAVR7zHKCyGqUYNHGidbRlFqPJQY_kS24murQ18UXzvB3k_Or6ivnbB4ckeM2bHoge2MrAIPLhf5i6_t4HVHNjRtnCg70zUCR8ts5_8Y0myafNvez4U8b0TqCqSzVi68i_AQcQ3_69eUrJGHKECgjqYS74iO6nvsxMuoeMEiQmRjysmbadj0lTa7MI6ZN9GbMIclJ2RNkjP1Lf07OCWsOQk8AKmF50asMKwrbGCoKOPIzBPXlWVl9JDCaHaJHNqoaZfrLAQ5QQoZYRbVx69btlozFWNwOG-PLnztL4iukv7PieZUdlqiNhx0UdGpkYmgQJbATYb6ZrSrVOHLNtSl7a_GJQC6Oi7k1dWK2bmjqJZlpLo7zwurdY9z99gb3Mgcojr1zu5IGiAy1Bf-mIhnfCNJCM9wOdyAZ4ZqbDrhdbiXNRmp32HZgmvgIpxwl14IrMJNYQTyftaVGPqpxzNMt53LRaHvvaUw2cmIxodYpKen1Fu9I0i9XmaoZHY_bu9e1cGzrUjOCwfDiWVq2NvWWSJR4X7-J7gjLkz7E0JfM955Rcj8YpnraK-7h5EbbX0tAsp-bmihuNLUkKmHKztunX_B5Ogpe5YojrMXiBNXTZ6LMRAiCXWB4gVUjQI7qoiLUZnDWo3A8LELW6EogmGoiDNxG_p_SBgA5-jcx97ZTWqRWzSRDGOYbEyaypPH02Doix1jmuQrBSVnKVfzFU362gNGcmq4b492EPr_C3EoK7zbcSz4MbN9nwaM_HuGIZV9sYd8QJiAqaYNWTRtoElGBPSiyM-I0JllHSaEUkB0LqgXcjECdKXNxpooIvmCiXKbbiX0zRlsZ3WcDoxfk3er5Fm0BNligwi8VQauQjuvkbxEQOvB-G8oDC-442vQhjQoGZb9mpLL7UzBKab3RPKDJGz825AMG4E47f5-dISVlMnE3t5NdE9mluYlUBKidg3dGfr5Hvb5_gjq3GcEFp8z9HeTLgaRke9hdHSNQlv4Liyr9fN9IsCZHJ8gh76kFHLHJ9HZLfffXsOXjLuJtTJ7v-OengQaMwHMYNJgFOk9rHtwIfeo2FGju7MPjKwox9MIzEUxhb-WaTw-TAH4A2S_NfzyS8RiYoFw_y1]--></g></svg>