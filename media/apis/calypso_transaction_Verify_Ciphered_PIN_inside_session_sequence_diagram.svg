<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3370px" preserveAspectRatio="none" style="width:1325px;height:3370px;background:#FFFFFF;" version="1.1" viewBox="0 0 1325 3370" width="1325px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="264.9492"/><rect fill="#FFC0CB" height="630.2754" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="310.2402"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="971.8066"/><rect fill="#FFC0CB" height="1009.8945" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1017.0977"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2110.1563"/><rect fill="#FFC0CB" height="1076.7676" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2192.7383"/><rect fill="#ADD8E6" height="286.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="535.8594"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1082.9707"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1799.373"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="2631.8125"/><rect fill="#ADD8E6" height="2832.5195" style="stroke:#181818;stroke-width:1.0;" width="10" x="877" y="93.6211"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="376.1133"/><rect fill="#90EE90" height="457.4922" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="1276.0078"/><rect fill="#90EE90" height="263.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2302.9023"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="3023.3047"/><rect fill="#90EE90" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="1274.5" y="93.6211"/><rect fill="none" height="241.6191" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="550.8594"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1097.9707"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1814.373"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="407.5" x="911.5" y="2363.1934"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="2646.8125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="386" x2="386" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624" x2="624" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="881.5" x2="881.5" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="970.5" x2="970.5" y1="83.6211" y2="3287.5059"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1279" x2="1279" y1="83.6211" y2="3287.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="3301.6133">Ticketing Application</text><ellipse cx="73" cy="3313.627" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,3321.627 L73,3348.627 M60,3329.627 L86,3329.627 M73,3348.627 L60,3363.627 M73,3348.627 L86,3363.627 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="341" y="3286.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="348" y="3308.6133">Calypso API</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="574" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="581" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="600.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="574" y="3286.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="581" y="3308.6133">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="600.5" y="3327.2344">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="852.5" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="862.5" y="80.1074">Card</text><path d="M861.5,18.3789 L861.5,42.3789 M861.5,30.3789 L878.5,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="890.5" cy="30.3789" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="852.5" y="3301.6133">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="862.5" y="3320.2344">Card</text><path d="M861.5,3327.748 L861.5,3351.748 M861.5,3339.748 L878.5,3339.748 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="890.5" cy="3339.748" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="921.5" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="928.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="947" y="72.1074">Reader</text><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="921.5" y="3286.5059"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="928.5" y="3308.6133">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="947" y="3327.2344">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1250" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1261" y="80.1074">SAM</text><path d="M1259,18.3789 L1259,42.3789 M1259,30.3789 L1276,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1288" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1250" y="3301.6133">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1261" y="3320.2344">SAM</text><path d="M1259,3327.748 L1259,3351.748 M1259,3339.748 L1276,3339.748 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1288" cy="3339.748" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="264.9492"/><rect fill="#FFC0CB" height="630.2754" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="310.2402"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="971.8066"/><rect fill="#FFC0CB" height="1009.8945" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="1017.0977"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2110.1563"/><rect fill="#FFC0CB" height="1076.7676" style="stroke:#181818;stroke-width:1.0;" width="10" x="381" y="2192.7383"/><rect fill="#ADD8E6" height="286.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="535.8594"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1082.9707"/><rect fill="#ADD8E6" height="127.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="1799.373"/><rect fill="#ADD8E6" height="325.6191" style="stroke:#181818;stroke-width:1.0;" width="10" x="619" y="2631.8125"/><rect fill="#ADD8E6" height="2832.5195" style="stroke:#181818;stroke-width:1.0;" width="10" x="877" y="93.6211"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="376.1133"/><rect fill="#90EE90" height="457.4922" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="1276.0078"/><rect fill="#90EE90" height="263.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="2302.9023"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="965.5" y="3023.3047"/><rect fill="#90EE90" height="3184.8848" style="stroke:#181818;stroke-width:1.0;" width="10" x="1274.5" y="93.6211"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="151.4941" y2="151.4941"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="151.4941" y2="164.4941"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="164.4941" y2="164.4941"/><polygon fill="#181818" points="89,160.4941,79,164.4941,89,168.4941,85,164.4941" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="111.6494">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="111.6494">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="128.9404">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="146.2314">- Calypso SAM resource</text><polygon fill="#181818" points="369,260.9492,379,264.9492,369,268.9492,373,264.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="264.9492" y2="264.9492"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="190.5225">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="190.5225">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="117" y="207.8135">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="225.1045">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="242.3955">- read contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="117" y="259.6865">- reader counter #1</text><polygon fill="#181818" points="89,274.9492,79,278.9492,89,282.9492,85,278.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="278.9492" y2="278.9492"/><polygon fill="#181818" points="369,306.2402,379,310.2402,369,314.2402,373,310.2402" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="310.2402" y2="310.2402"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="304.9775">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="304.9775">commands (keep channel open)</text><polygon fill="#00FF00" points="953.5,372.1133,963.5,376.1133,953.5,380.1133,957.5,376.1133" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="376.1133" y2="376.1133"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="336.2686">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="353.5596">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="370.8506">- APDU list</text><polygon fill="#181818" points="1262.5,403.4043,1272.5,407.4043,1262.5,411.4043,1266.5,407.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="407.4043" y2="407.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="982.5" y="402.1416">get challenge</text><polygon fill="#181818" points="986.5,434.6953,976.5,438.6953,986.5,442.6953,982.5,438.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="438.6953" y2="438.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="992.5" y="433.4326">[SAM challenge]</text><polygon fill="#00FF00" points="402,465.9863,392,469.9863,402,473.9863,398,469.9863" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="469.9863" y2="469.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="408" y="464.7236">[SAM challenge]</text><polygon fill="#0000FF" points="607,531.8594,617,535.8594,607,539.8594,611,535.8594" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="535.8594" y2="535.8594"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="496.0146">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="513.3057">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="530.5967">- APDU list</text><path d="M564,550.8594 L844,550.8594 L844,560.1504 L834,570.1504 L564,570.1504 L564,550.8594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="241.6191" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="550.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="565.8877">Card APDU commands inside session</text><polygon fill="#181818" points="865,624.0234,875,628.0234,865,632.0234,869,628.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="628.0234" y2="628.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="636" y="588.1787">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="668" y="605.4697">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="668" y="622.7607">SFI environment to read)</text><polygon fill="#181818" points="640,655.3145,630,659.3145,640,663.3145,636,659.3145" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="659.3145" y2="659.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="646" y="654.0518">[card challenge &amp; environment data]</text><polygon fill="#181818" points="865,686.6055,875,690.6055,865,694.6055,869,690.6055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="690.6055" y2="690.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="636" y="685.3428">read record (contract #1)</text><polygon fill="#181818" points="640,717.8965,630,721.8965,640,725.8965,636,721.8965" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="721.8965" y2="721.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="646" y="716.6338">[contract #1 data]</text><polygon fill="#181818" points="865,749.1875,875,753.1875,865,757.1875,869,753.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="753.1875" y2="753.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="636" y="747.9248">read record (counter #1)</text><polygon fill="#181818" points="640,780.4785,630,784.4785,640,788.4785,636,784.4785" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="784.4785" y2="784.4785"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="646" y="779.2158">[counter #1 data]</text><polygon fill="#0000FF" points="402,818.7695,392,822.7695,402,826.7695,398,822.7695" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="822.7695" y2="822.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="408" y="817.5068">[card challenge]</text><polygon fill="#181818" points="89,936.5156,79,940.5156,89,944.5156,85,940.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="940.5156" y2="940.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="848.7979">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="866.0889">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="127" y="883.3799">- environment data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="900.6709">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="917.9619">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="935.2529">- counter #1 data]</text><polygon fill="#181818" points="369,967.8066,379,971.8066,369,975.8066,373,971.8066" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="971.8066" y2="971.8066"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="966.5439">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="139" y="966.5439">Verify PIN (plain PIN value)</text><polygon fill="#181818" points="89,981.8066,79,985.8066,89,989.8066,85,985.8066" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="985.8066" y2="985.8066"/><polygon fill="#181818" points="369,1013.0977,379,1017.0977,369,1021.0977,373,1017.0977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="1017.0977" y2="1017.0977"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1011.835">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1011.835">commands (keep channel open)</text><polygon fill="#0000FF" points="607,1078.9707,617,1082.9707,607,1086.9707,611,1082.9707" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="1082.9707" y2="1082.9707"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1043.126">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1060.417">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1077.708">- APDU list</text><path d="M564,1097.9707 L844,1097.9707 L844,1107.2617 L834,1117.2617 L564,1117.2617 L564,1097.9707 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1097.9707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="1112.999">Card APDU commands inside session</text><polygon fill="#181818" points="865,1136.5527,875,1140.5527,865,1144.5527,869,1140.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="1140.5527" y2="1140.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="636" y="1135.29">Get Challenge</text><polygon fill="#181818" points="640,1167.8438,630,1171.8438,640,1175.8438,636,1171.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="1171.8438" y2="1171.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="646" y="1166.5811">[PIN Card challenge]</text><polygon fill="#0000FF" points="402,1206.1348,392,1210.1348,402,1214.1348,398,1210.1348" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="1210.1348" y2="1210.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="408" y="1204.8721">[Card challenge]</text><polygon fill="#00FF00" points="953.5,1272.0078,963.5,1276.0078,953.5,1280.0078,957.5,1276.0078" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="1276.0078" y2="1276.0078"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="1236.1631">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1253.4541">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1270.7451">- APDU list</text><path d="M722,1289.0078 L722,1316.0078 L1219,1316.0078 L1219,1299.0078 L1209,1289.0078 L722,1289.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1209,1289.0078 L1209,1299.0078 L1219,1299.0078 L1209,1289.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476" x="728" y="1308.0361">When ciphered PIN verification requested, processes all pending SAM commands.</text><polygon fill="#181818" points="1262.5,1340.5898,1272.5,1344.5898,1262.5,1348.5898,1266.5,1344.5898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1344.5898" y2="1344.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="982.5" y="1339.3271">select diversifier (card serial)</text><polygon fill="#181818" points="986.5,1354.5898,976.5,1358.5898,986.5,1362.5898,982.5,1358.5898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1358.5898" y2="1358.5898"/><polygon fill="#181818" points="1262.5,1385.8809,1272.5,1389.8809,1262.5,1393.8809,1266.5,1389.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1389.8809" y2="1389.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="982.5" y="1384.6182">digest init (opening data)</text><polygon fill="#181818" points="986.5,1399.8809,976.5,1403.8809,986.5,1407.8809,982.5,1403.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1403.8809" y2="1403.8809"/><polygon fill="#181818" points="1262.5,1431.1719,1272.5,1435.1719,1262.5,1439.1719,1266.5,1435.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1435.1719" y2="1435.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="982.5" y="1429.9092">digest update (read environment)</text><polygon fill="#181818" points="986.5,1445.1719,976.5,1449.1719,986.5,1453.1719,982.5,1449.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1449.1719" y2="1449.1719"/><polygon fill="#181818" points="1262.5,1476.4629,1272.5,1480.4629,1262.5,1484.4629,1266.5,1480.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1480.4629" y2="1480.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="982.5" y="1475.2002">digest update (read contract)</text><polygon fill="#181818" points="986.5,1490.4629,976.5,1494.4629,986.5,1498.4629,982.5,1494.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1494.4629" y2="1494.4629"/><polygon fill="#181818" points="1262.5,1521.7539,1272.5,1525.7539,1262.5,1529.7539,1266.5,1525.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1525.7539" y2="1525.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="982.5" y="1520.4912">digest update (read counter)</text><polygon fill="#181818" points="986.5,1535.7539,976.5,1539.7539,986.5,1543.7539,982.5,1539.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1539.7539" y2="1539.7539"/><path d="M712,1552.7539 L712,1579.7539 L1229,1579.7539 L1229,1562.7539 L1219,1552.7539 L712,1552.7539 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1219,1552.7539 L1219,1562.7539 L1229,1562.7539 L1219,1552.7539 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="496" x="718" y="1571.7822">Diversification for the PIN ciphering is necessarily the same as for the secure session.</text><polygon fill="#181818" points="1262.5,1604.3359,1272.5,1608.3359,1262.5,1612.3359,1266.5,1608.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1608.3359" y2="1608.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="982.5" y="1603.0732">Give Random (PIN card challenge)</text><polygon fill="#181818" points="986.5,1635.627,976.5,1639.627,986.5,1643.627,982.5,1639.627" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1639.627" y2="1639.627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="992.5" y="1634.3643">ack</text><polygon fill="#181818" points="1262.5,1666.918,1272.5,1670.918,1262.5,1674.918,1266.5,1670.918" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="1670.918" y2="1670.918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="982.5" y="1665.6553">Card Cipher PIN (plain PIN, debit key reference)</text><polygon fill="#181818" points="986.5,1698.209,976.5,1702.209,986.5,1706.209,982.5,1702.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="1702.209" y2="1702.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="992.5" y="1696.9463">[ciphered PIN]</text><polygon fill="#00FF00" points="402,1729.5,392,1733.5,402,1737.5,398,1733.5" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="1733.5" y2="1733.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="408" y="1728.2373">[ciphered PIN]</text><polygon fill="#0000FF" points="607,1795.373,617,1799.373,607,1803.373,611,1799.373" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="1799.373" y2="1799.373"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="1759.5283">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="1776.8193">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="1794.1104">- APDU list</text><path d="M564,1814.373 L844,1814.373 L844,1823.6641 L834,1833.6641 L564,1833.6641 L564,1814.373 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="81.873" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="1814.373"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="1829.4014">Card APDU commands inside session</text><polygon fill="#181818" points="865,1852.9551,875,1856.9551,865,1860.9551,869,1856.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="1856.9551" y2="1856.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="636" y="1851.6924">Verify PIN (ciphered PIN)</text><polygon fill="#181818" points="640,1884.2461,630,1888.2461,640,1892.2461,636,1888.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="1888.2461" y2="1888.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="646" y="1882.9834">[PIN status]</text><polygon fill="#0000FF" points="402,1922.5371,392,1926.5371,402,1930.5371,398,1926.5371" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="1926.5371" y2="1926.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="408" y="1921.2744">[PIN status]</text><polygon fill="#181818" points="89,2022.9922,79,2026.9922,89,2030.9922,85,2026.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2026.9922" y2="2026.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1952.5654">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="127" y="1969.8564">- identification data with PIN support</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="127" y="1987.1475">- key #1 reference (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="127" y="2004.4385">- key #2 reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="127" y="2021.7295">- key #3 reference]</text><polygon fill="#181818" points="369,2106.1563,379,2110.1563,369,2114.1563,373,2110.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2110.1563" y2="2110.1563"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2053.0205">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="2053.0205">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="117" y="2070.3115">- decrease counter #1 (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="117" y="2087.6025">- append event record (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="117" y="2104.8936">- close secure session (not ratified)</text><polygon fill="#181818" points="89,2120.1563,79,2124.1563,89,2128.1563,85,2124.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="2124.1563" y2="2124.1563"/><path d="M155,2137.1563 L155,2164.1563 L616,2164.1563 L616,2147.1563 L606,2137.1563 L155,2137.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M606,2137.1563 L606,2147.1563 L616,2147.1563 L606,2137.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="440" x="161" y="2156.1846">At the session closure, any data secure processing should be unnecessary.</text><polygon fill="#181818" points="369,2188.7383,379,2192.7383,369,2196.7383,373,2192.7383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="375" y1="2192.7383" y2="2192.7383"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2187.4756">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2187.4756">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="391" x2="433" y1="2224.0293" y2="2224.0293"/><line style="stroke:#181818;stroke-width:1.0;" x1="433" x2="433" y1="2224.0293" y2="2237.0293"/><line style="stroke:#181818;stroke-width:1.0;" x1="392" x2="433" y1="2237.0293" y2="2237.0293"/><polygon fill="#181818" points="402,2233.0293,392,2237.0293,402,2241.0293,398,2237.0293" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="398" y="2218.7666">anticipates the future card responses</text><polygon fill="#00FF00" points="953.5,2298.9023,963.5,2302.9023,953.5,2306.9023,957.5,2302.9023" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="2302.9023" y2="2302.9023"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2263.0576">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2280.3486">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2297.6396">- APDU list</text><polygon fill="#181818" points="1262.5,2330.1934,1272.5,2334.1934,1262.5,2338.1934,1266.5,2334.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2334.1934" y2="2334.1934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="982.5" y="2328.9307">digest update (verify PIN)</text><polygon fill="#181818" points="986.5,2344.1934,976.5,2348.1934,986.5,2352.1934,982.5,2348.1934" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2348.1934" y2="2348.1934"/><path d="M911.5,2363.1934 L1168.5,2363.1934 L1168.5,2372.4844 L1158.5,2382.4844 L911.5,2382.4844 L911.5,2363.1934 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="109.873" style="stroke:#000000;stroke-width:1.5;" width="407.5" x="911.5" y="2363.1934"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="926.5" y="2378.2217">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1001.5" y="2378.2217">Card APDU responses</text><polygon fill="#181818" points="1262.5,2401.7754,1272.5,2405.7754,1262.5,2409.7754,1266.5,2405.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2405.7754" y2="2405.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="982.5" y="2400.5127">digest update (decrease counter)</text><polygon fill="#181818" points="986.5,2415.7754,976.5,2419.7754,986.5,2423.7754,982.5,2419.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2419.7754" y2="2419.7754"/><polygon fill="#181818" points="1262.5,2447.0664,1272.5,2451.0664,1262.5,2455.0664,1266.5,2451.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2451.0664" y2="2451.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="982.5" y="2445.8037">digest update (append event record)</text><polygon fill="#181818" points="986.5,2461.0664,976.5,2465.0664,986.5,2469.0664,982.5,2465.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2465.0664" y2="2465.0664"/><polygon fill="#181818" points="1262.5,2499.3574,1272.5,2503.3574,1262.5,2507.3574,1266.5,2503.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="2503.3574" y2="2503.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="982.5" y="2498.0947">digest close</text><polygon fill="#181818" points="986.5,2530.6484,976.5,2534.6484,986.5,2538.6484,982.5,2534.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="2534.6484" y2="2534.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="992.5" y="2529.3857">[SAM certificate]</text><polygon fill="#00FF00" points="402,2561.9395,392,2565.9395,402,2569.9395,398,2565.9395" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="2565.9395" y2="2565.9395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="408" y="2560.6768">[SAM certificate]</text><polygon fill="#0000FF" points="607,2627.8125,617,2631.8125,607,2635.8125,611,2631.8125" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="391" x2="613" y1="2631.8125" y2="2631.8125"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="398" y="2591.9678">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="2609.2588">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="2626.5498">- APDU list</text><path d="M564,2646.8125 L844,2646.8125 L844,2656.1035 L834,2666.1035 L564,2666.1035 L564,2646.8125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="127.1641" style="stroke:#000000;stroke-width:1.5;" width="357.5" x="564" y="2646.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="579" y="2661.8408">Card APDU commands inside session</text><polygon fill="#181818" points="865,2685.3945,875,2689.3945,865,2693.3945,869,2689.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2689.3945" y2="2689.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="636" y="2684.1318">update record (event, data)</text><polygon fill="#181818" points="640,2699.3945,630,2703.3945,640,2707.3945,636,2703.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2703.3945" y2="2703.3945"/><polygon fill="#181818" points="865,2730.6855,875,2734.6855,865,2738.6855,869,2734.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2734.6855" y2="2734.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="636" y="2729.4229">decrease counter (counter #1, value)</text><polygon fill="#181818" points="640,2761.9766,630,2765.9766,640,2769.9766,636,2765.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2765.9766" y2="2765.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="646" y="2760.7139">[new counter value]</text><polygon fill="#181818" points="865,2800.2676,875,2804.2676,865,2808.2676,869,2804.2676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2804.2676" y2="2804.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="636" y="2799.0049">close secure session (SAM certificate)</text><polygon fill="#181818" points="640,2831.5586,630,2835.5586,640,2839.5586,636,2835.5586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2835.5586" y2="2835.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="646" y="2830.2959">[card certificate]</text><polygon fill="#181818" points="865,2862.8496,875,2866.8496,865,2870.8496,869,2866.8496" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2866.8496" y2="2866.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="636" y="2861.5869">ratification command</text><polygon fill="#181818" points="640,2876.8496,630,2880.8496,640,2884.8496,636,2880.8496" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="876" y1="2880.8496" y2="2880.8496"/><polygon fill="#181818" points="865,2908.1406,875,2912.1406,865,2916.1406,869,2912.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="629" x2="871" y1="2912.1406" y2="2912.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="636" y="2906.8779">close card channel</text><polygon fill="#181818" points="640,2922.1406,630,2926.1406,640,2930.1406,636,2926.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="634" x2="881" y1="2926.1406" y2="2926.1406"/><polygon fill="#0000FF" points="402,2953.4316,392,2957.4316,402,2961.4316,398,2957.4316" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="623" y1="2957.4316" y2="2957.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="408" y="2952.1689">[card certificate]</text><polygon fill="#00FF00" points="953.5,3019.3047,963.5,3023.3047,953.5,3027.3047,957.5,3023.3047" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="391" x2="959.5" y1="3023.3047" y2="3023.3047"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="398" y="2983.46">SAM #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="398" y="3000.751">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="430" y="3018.042">- APDU list</text><polygon fill="#181818" points="1262.5,3050.5957,1272.5,3054.5957,1262.5,3058.5957,1266.5,3054.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="975.5" x2="1268.5" y1="3054.5957" y2="3054.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="982.5" y="3049.333">digest authenticate (card certificate)</text><polygon fill="#181818" points="986.5,3081.8867,976.5,3085.8867,986.5,3089.8867,982.5,3085.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="980.5" x2="1273.5" y1="3085.8867" y2="3085.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="992.5" y="3080.624">[authentication status]</text><polygon fill="#00FF00" points="402,3113.1777,392,3117.1777,402,3121.1777,398,3117.1777" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="396" x2="969.5" y1="3117.1777" y2="3117.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="408" y="3111.915">[authentification status]</text><polygon fill="#181818" points="89,3265.5059,79,3269.5059,89,3273.5059,85,3269.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="385" y1="3269.5059" y2="3269.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3143.2061">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3160.4971">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3177.7881">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="127" y="3195.0791">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3212.3701">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="127" y="3229.6611">- counter #1 data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="127" y="3246.9521">- event #1 (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="3264.2432">authentification status</text><!--SRC=[pLVVR-Cs37xtNo6qm2u9cYrDqlLQT0KInodwiAsuksqFRHvKcqc4EhBFLdB8VpzAjcpBlt8fyj1xwBKooO-ao8_Kf_YDyP16T4DidyRnD8WyYEp03o9oFh-qnuEvrIOo6q_imQmW4Wk8813x42Q6uEHcPi_cjOAFXk1qFBbshce5RTFYR7Ov7TOAEeQWCxqPcT1hwWK_65-H9VLZi0gVlWege3t2YIlOZebzdPJrYNm1hv8nwhwjec3BFILzTnU1Tt-F-PqvCyTkoMycwLoFxP5jhPa7H1_cuIBgqpOAVJW872enXJrsxFbrAtOk_DaPZoSp3P-T6nwy-jl3-598nJETNysdhUXQT3I- -JoRQkpqr41-Y03uGUYLb5BOa_baVjcAdSaE7Tk-ljJW-hY0Zl1_HvIl3eSUAB7askT3vwRLWLpO-VtQ6Gwr1zcvwG9cOFyp2TWdyJksunoANuaExP5pDIY4loz1KrTWzPzzO-uR2DbGap3qcKi52_WPeJ6XOKZELu7lMOWbcCj2oWKviwc_3-E0J9uUbPXBGqREGyRVwkLi6dal_0jGz35LYBpaJtBkizLQJ6NvlSfmQRGdPp7uu0f0fLvFAlTwcLfHeHRiw-HF0okc6mCggRTwBDHDeL3Ba9UvOZjabq9EigEoNzc7gfKmxD_ZZrlIwp4U2_ISeM2lHxJxofR0GecbbO3Vll0NqJS_Hn07syW5ynCwdtsnKYXvCxVaRXbWXbnP7Nz8zkdrmWWmUOXxzvlyTjy46uJ0IGpkDi9W88xn2-dCdEdZDq9T5m-83plmkubqX7acm7Si2lW647B9V2XySX4gGlla_38_nOjnyJA4lA3BOawnfjAYah_tLTui3mo9Ws46qib2cC5cGxaNayuRG4ZSDUKSV1Lcjnux0Ny-7mpcyy5WSP-LaucNa8kg80m30Kk-l72Lt0qJ-Wg_Ro4MIHecJxD_YCzYOLHEJTLQsN5VEd9BLY1a4BuFYiJefjylUlWitSc-BmhgMK0wUMNHGg8phK8ofFRYFkzZCnkAvvFMHHhAqdzi4kffmfAy62fIIPIoIyMEaboN5gf5y5zkeg-ylQqlQUME1w_esHliBwH7HZwIa_cZKTqYK0NSpO3wVICZpyfgPeFyOcXxLD15Wu-gMo9maTNHjxnhMg1oeMCiwxvhCwnbKhl0FLa7cM6Z75GbcM4lp9xLUbQXgr77u3UseIj86GWl53bocKubvKFoePnBqjc6-3zuAHbb6P4rLT0hPqgVbiAi48rrDAV-2n5RxidJur-a4_gKSVNhZc8HTpyoqHtHswEFrTiFI8TsHeTD9IrlmIxLwE6gje-ewkF6nVi9ic5AM3p0Zy4EptFkbjduRutSXmlJ6dT0Bwb6MQEwkL8uy2v8Mb20Ew3l4wmQJ-w7YXFJ6_bLven8fEfOIdOguZ4q7wDzT2IXs1ZXgDyjJwgA0O-jq16yTCn4HnQjH9UD-TEg2HcGJdadUPy1JHhlrLRaKbLklAYPpbnwCqlSqyKQr9KbzoSJmcB2GLuJZPY_Lm9e1kJ-gXNCGTTsPmy8IRxWpGORqb4uHi5tgzi5Fb4gLbINsCh34l5TvFCL2ss95SZTEglFnVfSMAqxYobwkfLb_B5ehJX8YY5tMoaENnTY6rUfBSj5biQYzAc7DVd1n5gv7c_3C8ZIrCagm5cR5K9vUgllm_nxuNIKdzQDwQDcTEgt1ousQWp5DQ2J3Ef408tApi6t3XhKwvFYetHzy8COAbibDXg9g4m8ndNynC_9GVqjxteYqgvE42Gi8buGolT9jbCNKlgM916lWwtlaLSWMwxPObyaWlSk5adCUhEWIyLmpK6c4FB5Av_i0aUB36Mv5T9X_QuD0ux1lMkCZauzHWzG-oxhoXfYJng-ciyyV2_FQSuBUGRaRHzme5orNQrakF8JXcggkzwMf986MweQcbwW4AMi00S8lI9zEaw_-bYSdkPUSudA_KMwujIoUeET2dKLNdKN-h7HD2Ou_CZqb6XrMgGmzGHNkgwkrVmABbvgpREK5iP6ciYgiKQ_zAeYcQX6hJJJ3ap3gh-dM_N79-QeXcQaMwHMoJIglSi1rIrT1Grv1NeRQ6rMhRCiQxKqxUdU-oTuvPUNZeG0vUpNvuiNtX1bULp_3m00]--></g></svg>