<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3957px" preserveAspectRatio="none" style="width:1308px;height:3957px;background:#FFFFFF;" version="1.1" viewBox="0 0 1308 3957" width="1308px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="3771.9961" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="65.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="334" y="116.9121"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="334" y="617.6055"/><rect fill="#FFC0CB" height="3193.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="334" y="662.8965"/><rect fill="#ADD8E6" height="582.5293" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="978.0977"/><rect fill="#ADD8E6" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="2140.5742"/><rect fill="#ADD8E6" height="369.4922" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="2559.9395"/><rect fill="#ADD8E6" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="3336.2148"/><rect fill="#ADD8E6" height="3350.4668" style="stroke:#181818;stroke-width:1.0;" width="10" x="926" y="93.6211"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="728.7695"/><rect fill="#90EE90" height="448.2012" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="1626.5"/><rect fill="#90EE90" height="193.7461" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="2300.3203"/><rect fill="#90EE90" height="275.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="2995.3047"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="3541.252"/><rect fill="#90EE90" height="3771.9961" style="stroke:#181818;stroke-width:1.0;" width="10" x="1261.5" y="93.6211"/><rect fill="none" height="537.2383" style="stroke:#000000;stroke-width:1.5;" width="363.5" x="602" y="993.0977"/><rect fill="none" height="286.9102" style="stroke:#000000;stroke-width:1.5;" width="363.5" x="602" y="2612.2305"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="3874.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="339" x2="339" y1="83.6211" y2="3874.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="559" x2="559" y1="83.6211" y2="3874.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="662" x2="662" y1="83.6211" y2="3874.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="930.5" x2="930.5" y1="83.6211" y2="3874.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1014.5" x2="1014.5" y1="83.6211" y2="3874.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1266" x2="1266" y1="83.6211" y2="3874.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="3888.7246">Ticketing Application</text><ellipse cx="73" cy="3900.7383" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,3908.7383 L73,3935.7383 M60,3916.7383 L86,3916.7383 M73,3935.7383 L60,3950.7383 M73,3935.7383 L86,3950.7383 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="294" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="301" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="294" y="3873.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="301" y="3895.7246">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="516" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="523" y="72.1074">Reader API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="516" y="3873.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="523" y="3895.7246">Reader API</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="612" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="619" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="638.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="612" y="3873.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="619" y="3895.7246">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="638.5" y="3914.3457">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="911.5" y="80.1074">Card</text><path d="M910.5,37 L910.5,61 M910.5,49 L927.5,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="939.5" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="911.5" y="3888.7246">Card</text><path d="M910.5,3896.2383 L910.5,3920.2383 M910.5,3908.2383 L927.5,3908.2383 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="939.5" cy="3908.2383" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="965.5" y="31.3789"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="972.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="991" y="72.1074">Reader</text><rect fill="#90EE90" height="51.2422" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="965.5" y="3873.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="972.5" y="3895.7246">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="991" y="3914.3457">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1237" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1248" y="80.1074">SAM</text><path d="M1246,18.3789 L1246,42.3789 M1246,30.3789 L1263,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1275" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1237" y="3888.7246">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1248" y="3907.3457">SAM</text><path d="M1246,3914.8594 L1246,3938.8594 M1246,3926.8594 L1263,3926.8594 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1275" cy="3926.8594" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="3771.9961" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="65.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="334" y="116.9121"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="334" y="617.6055"/><rect fill="#FFC0CB" height="3193.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="334" y="662.8965"/><rect fill="#ADD8E6" height="582.5293" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="978.0977"/><rect fill="#ADD8E6" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="2140.5742"/><rect fill="#ADD8E6" height="369.4922" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="2559.9395"/><rect fill="#ADD8E6" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="657" y="3336.2148"/><rect fill="#ADD8E6" height="3350.4668" style="stroke:#181818;stroke-width:1.0;" width="10" x="926" y="93.6211"/><rect fill="#90EE90" height="139.1641" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="728.7695"/><rect fill="#90EE90" height="448.2012" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="1626.5"/><rect fill="#90EE90" height="193.7461" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="2300.3203"/><rect fill="#90EE90" height="275.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="2995.3047"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1009.5" y="3541.252"/><rect fill="#90EE90" height="3771.9961" style="stroke:#181818;stroke-width:1.0;" width="10" x="1261.5" y="93.6211"/><polygon fill="#181818" points="322,112.9121,332,116.9121,322,120.9121,326,116.9121" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="328" y1="116.9121" y2="116.9121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="85" y="111.6494">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="114" y="111.6494">Calypso card</text><polygon fill="#181818" points="89,178.7852,79,182.7852,89,186.7852,85,182.7852" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="338" y1="182.7852" y2="182.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="142.9404">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="160.2314">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="127" y="177.5225">- session buffer size]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1301" x="0" y="212.4307"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1301" y1="212.4307" y2="212.4307"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1301" y1="215.4307" y2="215.4307"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="168" x="566.5" y="200.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="572.5" y="218.8135">Card secure transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="293.9492" y2="293.9492"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="293.9492" y2="306.9492"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="306.9492" y2="306.9492"/><polygon fill="#181818" points="89,302.9492,79,306.9492,89,310.9492,85,306.9492" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="254.1045">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="254.1045">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="271.3955">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="288.6865">- Calypso SAM resource</text><path d="M112,319.9492 L112,346.9492 L565,346.9492 L565,329.9492 L555,319.9492 L112,319.9492 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M555,319.9492 L555,329.9492 L565,329.9492 L555,319.9492 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="432" x="118" y="338.9775">Reads again the environment data inside the session to authenticate them.</text><polygon fill="#181818" points="322,613.6055,332,617.6055,322,621.6055,326,617.6055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="328" y1="617.6055" y2="617.6055"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="370.2686">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="139" y="370.2686">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="117" y="387.5596">- open secure session (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="149" y="404.8506">LOAD access level,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="149" y="422.1416">MULTIPLE mode)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="117" y="439.4326">- update environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="117" y="456.7236">- update contract list</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="117" y="474.0146">- update contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="117" y="491.3057">- update contract #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="117" y="508.5967">- update contract #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="117" y="525.8877">- update contract #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="117" y="543.1787">- update all counters</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="117" y="560.4697">- update event log #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="117" y="577.7607">- update event log #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="117" y="595.0518">- update event log #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="117" y="612.3428">- close secure session (as ratified)</text><polygon fill="#181818" points="89,627.6055,79,631.6055,89,635.6055,85,631.6055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="338" y1="631.6055" y2="631.6055"/><polygon fill="#181818" points="322,658.8965,332,662.8965,322,666.8965,326,662.8965" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="328" y1="662.8965" y2="662.8965"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="657.6338">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="657.6338">commands (close channel after)</text><polygon fill="#00FF00" points="997.5,724.7695,1007.5,728.7695,997.5,732.7695,1001.5,728.7695" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="344" x2="1003.5" y1="728.7695" y2="728.7695"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="351" y="688.9248">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="706.2158">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="723.5068">- APDU list</text><polygon fill="#181818" points="1249.5,756.0605,1259.5,760.0605,1249.5,764.0605,1253.5,760.0605" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="760.0605" y2="760.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1026.5" y="754.7979">select diversifier (card serial)</text><polygon fill="#181818" points="1030.5,770.0605,1020.5,774.0605,1030.5,778.0605,1026.5,774.0605" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="774.0605" y2="774.0605"/><polygon fill="#181818" points="1249.5,801.3516,1259.5,805.3516,1249.5,809.3516,1253.5,805.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="805.3516" y2="805.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1026.5" y="800.0889">get challenge</text><polygon fill="#181818" points="1030.5,832.6426,1020.5,836.6426,1030.5,840.6426,1026.5,836.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="836.6426" y2="836.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="1036.5" y="831.3799">[SAM challenge 1]</text><polygon fill="#00FF00" points="355,863.9336,345,867.9336,355,871.9336,351,867.9336" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="1013.5" y1="867.9336" y2="867.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="361" y="862.6709">[SAM challenge 1]</text><line style="stroke:#181818;stroke-width:1.0;" x1="344" x2="386" y1="899.2246" y2="899.2246"/><line style="stroke:#181818;stroke-width:1.0;" x1="386" x2="386" y1="899.2246" y2="912.2246"/><line style="stroke:#181818;stroke-width:1.0;" x1="345" x2="386" y1="912.2246" y2="912.2246"/><polygon fill="#181818" points="355,908.2246,345,912.2246,355,916.2246,351,912.2246" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="351" y="893.9619">anticipates session buffer overflow</text><polygon fill="#0000FF" points="645,974.0977,655,978.0977,645,982.0977,649,978.0977" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="344" x2="651" y1="978.0977" y2="978.0977"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="351" y="938.2529">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="955.5439">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="972.835">- APDU list</text><path d="M602,993.0977 L893,993.0977 L893,1002.3887 L883,1012.3887 L602,1012.3887 L602,993.0977 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="537.2383" style="stroke:#000000;stroke-width:1.5;" width="363.5" x="602" y="993.0977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="617" y="1008.126">Card APDU commands inside session</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="856" y="1008.126">1</text><polygon fill="#181818" points="914,1048.9707,924,1052.9707,914,1056.9707,918,1052.9707" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1052.9707" y2="1052.9707"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="674" y="1030.417">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="706" y="1047.708">SAM challenge 1)</text><polygon fill="#181818" points="678,1080.2617,668,1084.2617,678,1088.2617,674,1084.2617" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1084.2617" y2="1084.2617"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="684" y="1078.999">[card challenge 1]</text><polygon fill="#181818" points="914,1111.5527,924,1115.5527,914,1119.5527,918,1115.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1115.5527" y2="1115.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="674" y="1110.29">update record (environment)</text><polygon fill="#181818" points="678,1142.8438,668,1146.8438,678,1150.8438,674,1146.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1146.8438" y2="1146.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1141.5811">ack</text><polygon fill="#181818" points="914,1174.1348,924,1178.1348,914,1182.1348,918,1178.1348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1178.1348" y2="1178.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="674" y="1172.8721">update record (contract list)</text><polygon fill="#181818" points="678,1205.4258,668,1209.4258,678,1213.4258,674,1209.4258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1209.4258" y2="1209.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1204.1631">ack</text><polygon fill="#181818" points="914,1236.7168,924,1240.7168,914,1244.7168,918,1240.7168" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1240.7168" y2="1240.7168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="674" y="1235.4541">update record (contract #1)</text><polygon fill="#181818" points="678,1268.0078,668,1272.0078,678,1276.0078,674,1272.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1272.0078" y2="1272.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1266.7451">ack</text><polygon fill="#181818" points="914,1299.2988,924,1303.2988,914,1307.2988,918,1303.2988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1303.2988" y2="1303.2988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="674" y="1298.0361">update record (contract #2)</text><polygon fill="#181818" points="678,1330.5898,668,1334.5898,678,1338.5898,674,1334.5898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1334.5898" y2="1334.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1329.3271">ack</text><polygon fill="#181818" points="914,1361.8809,924,1365.8809,914,1369.8809,918,1365.8809" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1365.8809" y2="1365.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="674" y="1360.6182">update record (contract #3)</text><polygon fill="#181818" points="678,1393.1719,668,1397.1719,678,1401.1719,674,1397.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1397.1719" y2="1397.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1391.9092">ack</text><polygon fill="#181818" points="914,1424.4629,924,1428.4629,914,1432.4629,918,1428.4629" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1428.4629" y2="1428.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="674" y="1423.2002">update record (contract #4)</text><polygon fill="#181818" points="678,1455.7539,668,1459.7539,678,1463.7539,674,1459.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1459.7539" y2="1459.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1454.4912">ack</text><polygon fill="#181818" points="914,1487.0449,924,1491.0449,914,1495.0449,918,1491.0449" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="1491.0449" y2="1491.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="674" y="1485.7822">update record (all counters)</text><polygon fill="#181818" points="678,1518.3359,668,1522.3359,678,1526.3359,674,1522.3359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="1522.3359" y2="1522.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="1517.0732">ack</text><polygon fill="#0000FF" points="355,1556.627,345,1560.627,355,1564.627,351,1560.627" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="661" y1="1560.627" y2="1560.627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="361" y="1555.3643">[card challenge]</text><polygon fill="#00FF00" points="997.5,1622.5,1007.5,1626.5,997.5,1630.5,1001.5,1626.5" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="344" x2="1003.5" y1="1626.5" y2="1626.5"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="351" y="1586.6553">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="1603.9463">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="1621.2373">- APDU list</text><polygon fill="#181818" points="1249.5,1653.791,1259.5,1657.791,1249.5,1661.791,1253.5,1657.791" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1657.791" y2="1657.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1026.5" y="1652.5283">digest init (opening data)</text><polygon fill="#181818" points="1030.5,1667.791,1020.5,1671.791,1030.5,1675.791,1026.5,1671.791" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1671.791" y2="1671.791"/><polygon fill="#181818" points="1249.5,1699.082,1259.5,1703.082,1249.5,1707.082,1253.5,1703.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1703.082" y2="1703.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="1026.5" y="1697.8193">digest update (update environment)</text><polygon fill="#181818" points="1030.5,1713.082,1020.5,1717.082,1030.5,1721.082,1026.5,1717.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1717.082" y2="1717.082"/><polygon fill="#181818" points="1249.5,1744.373,1259.5,1748.373,1249.5,1752.373,1253.5,1748.373" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1748.373" y2="1748.373"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="1026.5" y="1743.1104">digest update (update contract list)</text><polygon fill="#181818" points="1030.5,1758.373,1020.5,1762.373,1030.5,1766.373,1026.5,1762.373" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1762.373" y2="1762.373"/><polygon fill="#181818" points="1249.5,1789.6641,1259.5,1793.6641,1249.5,1797.6641,1253.5,1793.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1793.6641" y2="1793.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1026.5" y="1788.4014">digest update (update contract #1)</text><polygon fill="#181818" points="1030.5,1803.6641,1020.5,1807.6641,1030.5,1811.6641,1026.5,1807.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1807.6641" y2="1807.6641"/><polygon fill="#181818" points="1249.5,1834.9551,1259.5,1838.9551,1249.5,1842.9551,1253.5,1838.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1838.9551" y2="1838.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1026.5" y="1833.6924">digest update (update contract #2)</text><polygon fill="#181818" points="1030.5,1848.9551,1020.5,1852.9551,1030.5,1856.9551,1026.5,1852.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1852.9551" y2="1852.9551"/><polygon fill="#181818" points="1249.5,1880.2461,1259.5,1884.2461,1249.5,1888.2461,1253.5,1884.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1884.2461" y2="1884.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1026.5" y="1878.9834">digest update (update contract #3)</text><polygon fill="#181818" points="1030.5,1894.2461,1020.5,1898.2461,1030.5,1902.2461,1026.5,1898.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1898.2461" y2="1898.2461"/><polygon fill="#181818" points="1249.5,1925.5371,1259.5,1929.5371,1249.5,1933.5371,1253.5,1929.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="1929.5371" y2="1929.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1026.5" y="1924.2744">digest update (update contract #4)</text><polygon fill="#181818" points="1030.5,1939.5371,1020.5,1943.5371,1030.5,1947.5371,1026.5,1943.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="1943.5371" y2="1943.5371"/><path d="M860,1956.5371 L860,1983.5371 L1168,1983.5371 L1168,1966.5371 L1158,1956.5371 L860,1956.5371 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1158,1956.5371 L1158,1966.5371 L1168,1966.5371 L1158,1956.5371 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="866" y="1975.5654">Close card session before session buffer overflow.</text><polygon fill="#181818" points="1249.5,2008.1191,1259.5,2012.1191,1249.5,2016.1191,1253.5,2012.1191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="2012.1191" y2="2012.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1026.5" y="2006.8564">digest close</text><polygon fill="#181818" points="1030.5,2039.4102,1020.5,2043.4102,1030.5,2047.4102,1026.5,2043.4102" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="2043.4102" y2="2043.4102"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="1036.5" y="2038.1475">[SAM certificate 1]</text><polygon fill="#00FF00" points="355,2070.7012,345,2074.7012,355,2078.7012,351,2074.7012" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="1013.5" y1="2074.7012" y2="2074.7012"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="361" y="2069.4385">[SAM challenge 1]</text><polygon fill="#0000FF" points="645,2136.5742,655,2140.5742,645,2144.5742,649,2140.5742" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="344" x2="651" y1="2140.5742" y2="2140.5742"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="351" y="2100.7295">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="2118.0205">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="2135.3115">- APDU list</text><polygon fill="#181818" points="914,2167.8652,924,2171.8652,914,2175.8652,918,2171.8652" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="2171.8652" y2="2171.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="674" y="2166.6025">close secure session (SAM certificate 1)</text><polygon fill="#181818" points="678,2199.1563,668,2203.1563,678,2207.1563,674,2203.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="2203.1563" y2="2203.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="684" y="2197.8936">[card certificate 1]</text><polygon fill="#0000FF" points="355,2230.4473,345,2234.4473,355,2238.4473,351,2234.4473" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="661" y1="2234.4473" y2="2234.4473"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="361" y="2229.1846">[card certificate 1]</text><polygon fill="#00FF00" points="997.5,2296.3203,1007.5,2300.3203,997.5,2304.3203,1001.5,2300.3203" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="344" x2="1003.5" y1="2300.3203" y2="2300.3203"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="351" y="2260.4756">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="2277.7666">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="2295.0576">- APDU list</text><polygon fill="#181818" points="1249.5,2327.6113,1259.5,2331.6113,1249.5,2335.6113,1253.5,2331.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="2331.6113" y2="2331.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="1026.5" y="2326.3486">digest authenticate (card certificate 1)</text><polygon fill="#181818" points="1030.5,2358.9023,1020.5,2362.9023,1030.5,2366.9023,1026.5,2362.9023" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="2362.9023" y2="2362.9023"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1036.5" y="2357.6396">[authentication status 1]</text><path d="M854,2375.9023 L854,2402.9023 L1174,2402.9023 L1174,2385.9023 L1164,2375.9023 L854,2375.9023 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1164,2375.9023 L1164,2385.9023 L1174,2385.9023 L1164,2375.9023 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299" x="860" y="2394.9307">Anticipate second session with the same diversifier.</text><polygon fill="#181818" points="1249.5,2427.4844,1259.5,2431.4844,1249.5,2435.4844,1253.5,2431.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="2431.4844" y2="2431.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1026.5" y="2426.2217">get challenge</text><polygon fill="#181818" points="1030.5,2458.7754,1020.5,2462.7754,1030.5,2466.7754,1026.5,2462.7754" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="2462.7754" y2="2462.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="1036.5" y="2457.5127">[SAM challenge 2]</text><polygon fill="#00FF00" points="355,2490.0664,345,2494.0664,355,2498.0664,351,2494.0664" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="1013.5" y1="2494.0664" y2="2494.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="361" y="2488.8037">[authentication status 1, SAM challenge 2]</text><polygon fill="#0000FF" points="645,2555.9395,655,2559.9395,645,2563.9395,649,2559.9395" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="344" x2="651" y1="2559.9395" y2="2559.9395"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="351" y="2520.0947">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="2537.3857">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="2554.6768">- APDU list</text><path d="M398,2572.9395 L398,2599.9395 L926,2599.9395 L926,2582.9395 L916,2572.9395 L398,2572.9395 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M916,2572.9395 L916,2582.9395 L926,2582.9395 L916,2572.9395 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="507" x="404" y="2591.9678">The card modifications aren't managed in an atomic way (split between sessions 1 &amp; 2).</text><path d="M602,2612.2305 L893,2612.2305 L893,2621.5215 L883,2631.5215 L602,2631.5215 L602,2612.2305 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="286.9102" style="stroke:#000000;stroke-width:1.5;" width="363.5" x="602" y="2612.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="617" y="2627.2588">Card APDU commands inside session</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="856" y="2627.2588">2</text><polygon fill="#181818" points="914,2668.1035,924,2672.1035,914,2676.1035,918,2672.1035" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="2672.1035" y2="2672.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="674" y="2649.5498">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="706" y="2666.8408">SAM challenge 2)</text><polygon fill="#181818" points="678,2699.3945,668,2703.3945,678,2707.3945,674,2703.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="2703.3945" y2="2703.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="684" y="2698.1318">[card challenge 2]</text><polygon fill="#181818" points="914,2730.6855,924,2734.6855,914,2738.6855,918,2734.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="2734.6855" y2="2734.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="674" y="2729.4229">update record (event log #1)</text><polygon fill="#181818" points="678,2761.9766,668,2765.9766,678,2769.9766,674,2765.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="2765.9766" y2="2765.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="2760.7139">ack</text><polygon fill="#181818" points="914,2793.2676,924,2797.2676,914,2801.2676,918,2797.2676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="2797.2676" y2="2797.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="674" y="2792.0049">update record (event log #2)</text><polygon fill="#181818" points="678,2824.5586,668,2828.5586,678,2832.5586,674,2828.5586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="2828.5586" y2="2828.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="2823.2959">ack</text><polygon fill="#181818" points="914,2855.8496,924,2859.8496,914,2863.8496,918,2859.8496" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="2859.8496" y2="2859.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="674" y="2854.5869">update record (event log #3)</text><polygon fill="#181818" points="678,2887.1406,668,2891.1406,678,2895.1406,674,2891.1406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="2891.1406" y2="2891.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="684" y="2885.8779">ack</text><polygon fill="#0000FF" points="355,2925.4316,345,2929.4316,355,2933.4316,351,2929.4316" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="661" y1="2929.4316" y2="2929.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="361" y="2924.1689">[card certificate 1]</text><polygon fill="#00FF00" points="997.5,2991.3047,1007.5,2995.3047,997.5,2999.3047,1001.5,2995.3047" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="344" x2="1003.5" y1="2995.3047" y2="2995.3047"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="351" y="2955.46">SAM #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="2972.751">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="2990.042">- APDU list</text><polygon fill="#181818" points="1249.5,3022.5957,1259.5,3026.5957,1249.5,3030.5957,1253.5,3026.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="3026.5957" y2="3026.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1026.5" y="3021.333">digest init (opening data)</text><polygon fill="#181818" points="1030.5,3036.5957,1020.5,3040.5957,1030.5,3044.5957,1026.5,3040.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="3040.5957" y2="3040.5957"/><polygon fill="#181818" points="1249.5,3067.8867,1259.5,3071.8867,1249.5,3075.8867,1253.5,3071.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="3071.8867" y2="3071.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="1026.5" y="3066.624">digest update (update event log #1)</text><polygon fill="#181818" points="1030.5,3081.8867,1020.5,3085.8867,1030.5,3089.8867,1026.5,3085.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="3085.8867" y2="3085.8867"/><polygon fill="#181818" points="1249.5,3113.1777,1259.5,3117.1777,1249.5,3121.1777,1253.5,3117.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="3117.1777" y2="3117.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="1026.5" y="3111.915">digest update (update event log #2)</text><polygon fill="#181818" points="1030.5,3127.1777,1020.5,3131.1777,1030.5,3135.1777,1026.5,3131.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="3131.1777" y2="3131.1777"/><polygon fill="#181818" points="1249.5,3158.4688,1259.5,3162.4688,1249.5,3166.4688,1253.5,3162.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="3162.4688" y2="3162.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="1026.5" y="3157.2061">digest update (update event log #3)</text><polygon fill="#181818" points="1030.5,3172.4688,1020.5,3176.4688,1030.5,3180.4688,1026.5,3176.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="3176.4688" y2="3176.4688"/><polygon fill="#181818" points="1249.5,3203.7598,1259.5,3207.7598,1249.5,3211.7598,1253.5,3207.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="3207.7598" y2="3207.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1026.5" y="3202.4971">digest close</text><polygon fill="#181818" points="1030.5,3235.0508,1020.5,3239.0508,1030.5,3243.0508,1026.5,3239.0508" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="3239.0508" y2="3239.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="1036.5" y="3233.7881">[SAM certificate 2]</text><polygon fill="#00FF00" points="355,3266.3418,345,3270.3418,355,3274.3418,351,3270.3418" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="1013.5" y1="3270.3418" y2="3270.3418"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="361" y="3265.0791">[SAM certificate 2]</text><polygon fill="#0000FF" points="645,3332.2148,655,3336.2148,645,3340.2148,649,3336.2148" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="344" x2="651" y1="3336.2148" y2="3336.2148"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="351" y="3296.3701">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="3313.6611">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="3330.9521">- APDU list</text><polygon fill="#181818" points="914,3363.5059,924,3367.5059,914,3371.5059,918,3367.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="3367.5059" y2="3367.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="674" y="3362.2432">close secure session (SAM certificate 2)</text><polygon fill="#181818" points="678,3394.7969,668,3398.7969,678,3402.7969,674,3398.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="925" y1="3398.7969" y2="3398.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="684" y="3393.5342">[card certificate 2]</text><polygon fill="#181818" points="914,3426.0879,924,3430.0879,914,3434.0879,918,3430.0879" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="667" x2="920" y1="3430.0879" y2="3430.0879"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="674" y="3424.8252">close card channel</text><polygon fill="#181818" points="678,3440.0879,668,3444.0879,678,3448.0879,674,3444.0879" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="672" x2="930" y1="3444.0879" y2="3444.0879"/><polygon fill="#0000FF" points="355,3471.3789,345,3475.3789,355,3479.3789,351,3475.3789" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="661" y1="3475.3789" y2="3475.3789"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="361" y="3470.1162">[card certificate]</text><polygon fill="#00FF00" points="997.5,3537.252,1007.5,3541.252,997.5,3545.252,1001.5,3541.252" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="344" x2="1003.5" y1="3541.252" y2="3541.252"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="351" y="3501.4072">SAM #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="3518.6982">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="383" y="3535.9893">- APDU list</text><polygon fill="#181818" points="1249.5,3568.543,1259.5,3572.543,1249.5,3576.543,1253.5,3572.543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1019.5" x2="1255.5" y1="3572.543" y2="3572.543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="1026.5" y="3567.2803">digest authenticate (card certificate 2)</text><polygon fill="#181818" points="1030.5,3599.834,1020.5,3603.834,1030.5,3607.834,1026.5,3603.834" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1024.5" x2="1260.5" y1="3603.834" y2="3603.834"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1036.5" y="3598.5713">[authentication status]</text><polygon fill="#00FF00" points="355,3631.125,345,3635.125,355,3639.125,351,3635.125" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="349" x2="1013.5" y1="3635.125" y2="3635.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="361" y="3629.8623">[authentification status]</text><polygon fill="#181818" points="89,3852.6172,79,3856.6172,89,3860.6172,85,3856.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="338" y1="3856.6172" y2="3856.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3661.1533">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="127" y="3678.4443">- environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="127" y="3695.7354">- contract list</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="127" y="3713.0264">- contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="127" y="3730.3174">- contract #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="127" y="3747.6084">- contract #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="127" y="3764.8994">- contract #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="127" y="3782.1904">- all counters</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="127" y="3799.4814">- event log #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="127" y="3816.7725">- event log #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="127" y="3834.0635">- event log #3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="3851.3545">authentification status</text><!--SRC=[pLXRR-8u57xFhx2Aj8Les8MGRgTLYnH268qqewbcEazj7zp4WDMGP1FJYltrU-nSiCa52jdPvGdPvtxvpedFanSQH3Z6AsJxE4acOUoHs0xzC4QTsT0s1pEjYMHgMlPWAf4aZCGaP9k8M0gXTJMrfxDAmiyAuSIqBfsBIa9RbJYT3YT69Q6Z43gJgv6gUeczy8q62pJ7Va8qwUe7mumqUsYvZBvIjgcYqixHT-AL8eRTbqKShWDFKD_SnCGRZo6-KsVgs0tnBIYTIzCUsTgIUWJbXrjtGUlTEevyibTn9CY4RjEnPvUDkhV47ntJjAQv-k9SiU3PN-_Npuc4FvFPnMpIg3qd7PbN7wUJN7TsgcZ-51CIx5Mzu5H2jpMpPiD6tGMjuTZsvJ1NdXzBsa7zjnW7Y_skXu8iJVlCSAuQ3TWIEtzUEeQHMr2SgoP013Q7162J-k_OZhFFVq5gs2FdOY2vlzbHZLq6rNzsJzqNmdX3ML7aKnSp6WPd22S8Hn7gB4BVqq0NeowDSC3GcOtzJPI4oBhxBCXS757KYMZmej9z9nYiAiZY6h9Sd8rZxp58cJAviPV9wFXqiMGJNgNFF2eutg0pNUSikbuGosILAdvONnKD2Luf2j9Yt6f8Y4zSHi0iNGVUJ1LmAVGyaFGLe4SAM75KJxnhiGRS_J4FvZNITHSdJDTHRZadbbaXb5ai-Vz-VmpCr-X19aTqXHVa-Z5uP7q4HH0mEi-oYppCS7gHa2JX9y_h-HpYaD2_oPEcUKJHfMctjo8_GEwkOu8Ob7B2IO3pzZOpNPYWwpH864IT0lEE0p9RPfTo7PCaNCSkKQyWyCMDfWKXs1I-Wgd2C0G_da8erWMc0M9BWaZmIkCmM877mb445l4cu7Uvkon4U0q7OAVBlOI_gzyr4dY8Ar1oSJCFGP3Bc-kMWxUkHp61yWBlRlxWT-CwvyA817d4SiLTVlN8ldopfWYxBfmYdxmI_qDw_lNdb_lFTrySj0ezqal5h2EFcoYxDQS-KIvTi2C6vSYd2Qk-wGnhpesQyr7DkQcSOz-7ktK0m9AezhvoI_rmiQjPkZ3gBZBThXycf1H20IQycedNszSKvLBUazgGvqHARRXQuG3ggvlQuYvn410VuJauNACzLV_G6Gnciy7WQLp0ZAendKW2MI14e7B7ciT0bDIAihmz_bgJFBlMtVIdIBO2DHLeLfpskHtNACKqv57eeOJ7C0RNqjQEAVPxdA7VtzfS4h0WZ4V1zucOd2erO11tfxX7moT9G16IF05bOYbTMnFIW6Oy75iui3EIxA8NnuMv7xv96U0AdyRRKQAcG6mawHo1OYoo_jx8LqygZK_mACLDmLJKKWP8kVNbCXmMfWY4syhl2rUkgw55sEgHPp3xXMm4ekp4jrU8w_ULe3m8NYKJDPgpNes92qi7wageL2iSbfd3X2aergAuph1DOKQRmaPj2ZDF5oR3UQCqc9MypGfnIhU9tbPBwab5ufplAB0ylbEhCRA4SHvTW1JeKv3RvRt6rsE-I-o7numr2sktFBoF5R7J72SAuIrngWZZT16ZqqMOPH7IbhWzvBLifpCy7NVPw23pK0BHdKaYxuGrXecze6uEaZZRkjkQX4TDjb7RawqC8zMRMYa6FQr- -AYnEWHRL8uQV3a6O4Q_262KRv1ksQbUHLr9F3p6yB75rWdt_xofl2gvWAUooiwF29dvtf2TxujPNHDRnGB8woqCjhtyHjao_Sp3AoAlk4rj_BvzrcZkufhaV40bAIssjzbsUyiVsKKZyT3VBpFqXC_JuZK1lhrZ4fmp1CijNX0FnYOiwGYpS4LTz8Otg9j4FfZqJDWR4NkhI1V41Vs6Z9wSdEDNPkFVMPcDWrTcoEbX6xFqNNpwlYP_JBSgRTJAzdSGGlyAjFdlDq0bxIVBC5gGSVZoTUYE0psmVybHwHi- -Dy9WnV_bot7E73B0U_hLEJOmj-Qoi9s6qanjOXQlwuLssp4YvORyRX5oJXuKTfJe3dFV9UheKptFhvNlznMFDcMtcfBZxIbrzdIispvFRRy45j-WPLHuUang0d3xcFgFm00]--></g></svg>