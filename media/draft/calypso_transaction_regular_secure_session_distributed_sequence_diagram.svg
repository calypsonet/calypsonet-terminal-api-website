<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3677px" preserveAspectRatio="none" style="width:1462px;height:3677px;background:#FFFFFF;" version="1.1" viewBox="0 0 1462 3677" width="1462px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="268.6582"/><rect fill="#FFC0CB" height="100.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="801.6055"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="1198.5527"/><rect fill="#FFC0CB" height="810.0215" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="1243.8438"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="2154.3203"/><rect fill="#FFC0CB" height="1376.5137" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="2199.6113"/><rect fill="#FFC0CB" height="456.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="617" y="313.9492"/><rect fill="#ADD8E6" height="341.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="804" y="397.1133"/><rect fill="#ADD8E6" height="449.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="804" y="1469.4629"/><rect fill="#ADD8E6" height="308.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="804" y="2955.7227"/><rect fill="#ADD8E6" height="2804.3555" style="stroke:#181818;stroke-width:1.0;" width="10" x="1062" y="428.4043"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1145.5" y="1309.7168"/><rect fill="#90EE90" height="580.0742" style="stroke:#181818;stroke-width:1.0;" width="10" x="1145.5" y="2309.7754"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1145.5" y="3329.9238"/><rect fill="#90EE90" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="1400.5" y="93.6211"/><rect fill="none" height="144.4551" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="749" y="564.2773"/><rect fill="none" height="404.0742" style="stroke:#000000;stroke-width:1.5;" width="498.5" x="603" y="1484.4629"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="353.5" x="1091.5" y="2641.8125"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="749" y="2970.7227"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="384" x2="384" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="622" x2="622" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="809" x2="809" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1066.5" x2="1066.5" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1150.5" x2="1150.5" y1="83.6211" y2="3594.125"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1405" x2="1405" y1="83.6211" y2="3594.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="80.1074">Ticketing Application</text><ellipse cx="73" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,21.5 L73,48.5 M60,29.5 L86,29.5 M73,48.5 L60,63.5 M73,48.5 L86,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="5" y="3608.2324">Ticketing Application</text><ellipse cx="73" cy="3620.2461" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M73,3628.2461 L73,3655.2461 M60,3636.2461 L86,3636.2461 M73,3655.2461 L60,3670.2461 M73,3655.2461 L86,3670.2461 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="339" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="346" y="72.1074">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="339" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="346" y="3615.2324">Calypso API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="579" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="586" y="72.1074">Reader API</text><rect fill="#FFC0CB" height="32.6211" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="579" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="586" y="3615.2324">Reader API</text><rect fill="#ADD8E6" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="759" y="12.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="782" y="34.8652">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="766" y="53.4863">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="785.5" y="72.1074">Reader</text><rect fill="#ADD8E6" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="759" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="782" y="3615.2324">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="766" y="3633.8535">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="785.5" y="3652.4746">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1047.5" y="80.1074">Card</text><path d="M1046.5,37 L1046.5,61 M1046.5,49 L1063.5,49 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1075.5" cy="49" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1047.5" y="3608.2324">Card</text><path d="M1046.5,3615.7461 L1046.5,3639.7461 M1046.5,3627.7461 L1063.5,3627.7461 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1075.5" cy="3627.7461" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1101.5" y="12.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1123.5" y="34.8652">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1108.5" y="53.4863">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1127" y="72.1074">Reader</text><rect fill="#90EE90" height="69.8633" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1101.5" y="3593.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1123.5" y="3615.2324">(remote)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1108.5" y="3633.8535">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="1127" y="3652.4746">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1376" y="61.4863">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1387" y="80.1074">SAM</text><path d="M1385,18.3789 L1385,42.3789 M1385,30.3789 L1402,30.3789 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1414" cy="30.3789" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1376" y="3608.2324">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31" x="1387" y="3626.8535">SAM</text><path d="M1385,3634.3672 L1385,3658.3672 M1385,3646.3672 L1402,3646.3672 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1414" cy="3646.3672" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="68" y="93.6211"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="268.6582"/><rect fill="#FFC0CB" height="100.4551" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="801.6055"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="1198.5527"/><rect fill="#FFC0CB" height="810.0215" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="1243.8438"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="2154.3203"/><rect fill="#FFC0CB" height="1376.5137" style="stroke:#181818;stroke-width:1.0;" width="10" x="379" y="2199.6113"/><rect fill="#FFC0CB" height="456.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="617" y="313.9492"/><rect fill="#ADD8E6" height="341.9102" style="stroke:#181818;stroke-width:1.0;" width="10" x="804" y="397.1133"/><rect fill="#ADD8E6" height="449.3652" style="stroke:#181818;stroke-width:1.0;" width="10" x="804" y="1469.4629"/><rect fill="#ADD8E6" height="308.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="804" y="2955.7227"/><rect fill="#ADD8E6" height="2804.3555" style="stroke:#181818;stroke-width:1.0;" width="10" x="1062" y="428.4043"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1145.5" y="1309.7168"/><rect fill="#90EE90" height="580.0742" style="stroke:#181818;stroke-width:1.0;" width="10" x="1145.5" y="2309.7754"/><rect fill="#90EE90" height="93.873" style="stroke:#181818;stroke-width:1.0;" width="10" x="1145.5" y="3329.9238"/><rect fill="#90EE90" height="3491.5039" style="stroke:#181818;stroke-width:1.0;" width="10" x="1400.5" y="93.6211"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1455" x="0" y="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1455" y1="115.2666" y2="115.2666"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1455" y1="118.2666" y2="118.2666"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="209" x="623" y="103.6211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="191" x="629" y="121.6494">Card selection &amp; identification</text><path d="M186,143.9121 L186,170.9121 L582,170.9121 L582,153.9121 L572,143.9121 L186,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M572,143.9121 L572,153.9121 L582,153.9121 L572,143.9121 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375" x="192" y="162.9404">Reads the data present in all the cards targeted for the selection.</text><polygon fill="#181818" points="367,264.6582,377,268.6582,367,272.6582,371,268.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="373" y1="268.6582" y2="268.6582"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="194.2314">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="139" y="194.2314">card selection scenario:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="117" y="211.5225">- filter by specific AID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="117" y="228.8135">- filter invalidated card status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="246.1045">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="117" y="263.3955">- read contract list</text><polygon fill="#181818" points="89,278.6582,79,282.6582,89,286.6582,85,282.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="383" y1="282.6582" y2="282.6582"/><polygon fill="#181818" points="605,309.9492,615,313.9492,605,317.9492,609,313.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="611" y1="313.9492" y2="313.9492"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="308.6865">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="137" y="308.6865">explicit card selection scenario</text><polygon fill="#0000FF" points="792,393.1133,802,397.1133,792,401.1133,796,397.1133" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="627" x2="798" y1="397.1133" y2="397.1133"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="634" y="339.9775">Card #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="634" y="357.2686">transmit selection request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="666" y="374.5596">- card selector</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="666" y="391.8506">- APDU list</text><polygon fill="#181818" points="1050,424.4043,1060,428.4043,1050,432.4043,1054,428.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="428.4043" y2="428.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="821" y="423.1416">open card channel</text><polygon fill="#181818" points="825,438.4043,815,442.4043,825,446.4043,821,442.4043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="442.4043" y2="442.4043"/><polygon fill="#181818" points="1050,469.6953,1060,473.6953,1050,477.6953,1054,473.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="473.6953" y2="473.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="821" y="468.4326">select application (aid)</text><polygon fill="#181818" points="825,500.9863,815,504.9863,825,508.9863,821,504.9863" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="504.9863" y2="504.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="831" y="499.7236">[card FCI]</text><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="856" y1="536.2773" y2="536.2773"/><line style="stroke:#181818;stroke-width:1.0;" x1="856" x2="856" y1="536.2773" y2="549.2773"/><line style="stroke:#181818;stroke-width:1.0;" x1="815" x2="856" y1="549.2773" y2="549.2773"/><polygon fill="#181818" points="825,545.2773,815,549.2773,825,553.2773,821,549.2773" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="821" y="531.0146">checks invalidation status</text><path d="M749,564.2773 L1083,564.2773 L1083,573.5684 L1073,583.5684 L749,583.5684 L749,564.2773 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="144.4551" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="749" y="564.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="289" x="764" y="579.3057">Card APDU commands outside secure session</text><polygon fill="#181818" points="1050,602.8594,1060,606.8594,1050,610.8594,1054,606.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="606.8594" y2="606.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="821" y="601.5967">read record (environment)</text><polygon fill="#181818" points="825,634.1504,815,638.1504,825,642.1504,821,638.1504" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="638.1504" y2="638.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="831" y="632.8877">[environment data]</text><polygon fill="#181818" points="1050,665.4414,1060,669.4414,1050,673.4414,1054,669.4414" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="669.4414" y2="669.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="821" y="664.1787">read record (contract list)</text><polygon fill="#181818" points="825,696.7324,815,700.7324,825,704.7324,821,700.7324" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="700.7324" y2="700.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="831" y="695.4697">[contract list data]</text><polygon fill="#0000FF" points="638,735.0234,628,739.0234,638,743.0234,634,739.0234" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="632" x2="808" y1="739.0234" y2="739.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="644" y="733.7607">receive selection response</text><polygon fill="#181818" points="89,766.3145,79,770.3145,89,774.3145,85,770.3145" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="621" y1="770.3145" y2="770.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="95" y="765.0518">selected active SmartCard image</text><polygon fill="#181818" points="367,797.6055,377,801.6055,367,805.6055,371,801.6055" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="373" y1="801.6055" y2="801.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="85" y="796.3428">cast</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="114" y="796.3428">Calypso card</text><polygon fill="#181818" points="89,898.0605,79,902.0605,89,906.0605,85,902.0605" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="383" y1="902.0605" y2="902.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="827.6338">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="844.9248">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="127" y="862.2158">- invalidation status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="879.5068">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="896.7979">- contract list data]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1455" x="0" y="931.7061"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1455" y1="931.7061" y2="931.7061"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1455" y1="934.7061" y2="934.7061"/><rect fill="#EEEEEE" height="25.291" style="stroke:#000000;stroke-width:2.0;" width="168" x="643.5" y="920.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="649.5" y="938.0889">Card secure transaction</text><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="120" y1="1013.2246" y2="1013.2246"/><line style="stroke:#181818;stroke-width:1.0;" x1="120" x2="120" y1="1013.2246" y2="1026.2246"/><line style="stroke:#181818;stroke-width:1.0;" x1="79" x2="120" y1="1026.2246" y2="1026.2246"/><polygon fill="#181818" points="89,1022.2246,79,1026.2246,89,1030.2246,85,1026.2246" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66" x="85" y="973.3799">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="155" y="973.3799">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="117" y="990.6709">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="1007.9619">- Calypso SAM resource</text><path d="M108,1039.2246 L108,1066.2246 L659,1066.2246 L659,1049.2246 L649,1039.2246 L108,1039.2246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M649,1039.2246 L649,1049.2246 L659,1049.2246 L649,1039.2246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="530" x="114" y="1058.2529">Reads again the environment file &amp; the contract list inside the session to authenticate them.</text><polygon fill="#181818" points="367,1194.5527,377,1198.5527,367,1202.5527,371,1198.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="373" y1="1198.5527" y2="1198.5527"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="1089.5439">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="117" y="1106.835">- open secure session (LOAD access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="117" y="1124.126">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="117" y="1141.417">- read contract list</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="1158.708">- read contract #x</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="117" y="1175.999">- read contract #y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="117" y="1193.29">- read counters</text><polygon fill="#181818" points="89,1208.5527,79,1212.5527,89,1216.5527,85,1212.5527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="383" y1="1212.5527" y2="1212.5527"/><polygon fill="#181818" points="367,1239.8438,377,1243.8438,367,1247.8438,371,1243.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="373" y1="1243.8438" y2="1243.8438"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="1238.5811">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="1238.5811">commands (keep channel open)</text><polygon fill="#00FF00" points="1133.5,1305.7168,1143.5,1309.7168,1133.5,1313.7168,1137.5,1309.7168" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="389" x2="1139.5" y1="1309.7168" y2="1309.7168"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="396" y="1269.8721">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="396" y="1287.1631">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="428" y="1304.4541">- APDU list</text><polygon fill="#181818" points="1388.5,1337.0078,1398.5,1341.0078,1388.5,1345.0078,1392.5,1341.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="1341.0078" y2="1341.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1162.5" y="1335.7451">get challenge</text><polygon fill="#181818" points="1166.5,1368.2988,1156.5,1372.2988,1166.5,1376.2988,1162.5,1372.2988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="1372.2988" y2="1372.2988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1172.5" y="1367.0361">[SAM challenge]</text><polygon fill="#00FF00" points="400,1399.5898,390,1403.5898,400,1407.5898,396,1403.5898" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394" x2="1149.5" y1="1403.5898" y2="1403.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="406" y="1398.3271">[SAM challenge]</text><polygon fill="#0000FF" points="792,1465.4629,802,1469.4629,792,1473.4629,796,1469.4629" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="389" x2="798" y1="1469.4629" y2="1469.4629"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="396" y="1429.6182">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="396" y="1446.9092">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="428" y="1464.2002">- APDU list</text><path d="M603,1484.4629 L883,1484.4629 L883,1493.7539 L873,1503.7539 L603,1503.7539 L603,1484.4629 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="404.0742" style="stroke:#000000;stroke-width:1.5;" width="498.5" x="603" y="1484.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="618" y="1499.4912">Card APDU commands inside session</text><path d="M613,1508.7539 L613,1535.7539 L1004,1535.7539 L1004,1518.7539 L994,1508.7539 L613,1508.7539 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M994,1508.7539 L994,1518.7539 L1004,1518.7539 L994,1508.7539 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="370" x="619" y="1527.7822">Optimization: environment file read through the session opening.</text><polygon fill="#181818" points="1050,1594.918,1060,1598.918,1050,1602.918,1054,1598.918" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="1598.918" y2="1598.918"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="821" y="1559.0732">open secure session (card load key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="853" y="1576.3643">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="853" y="1593.6553">SFI environment to read)</text><polygon fill="#181818" points="825,1626.209,815,1630.209,825,1634.209,821,1630.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="1630.209" y2="1630.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="831" y="1624.9463">[card challenge &amp; environment data]</text><polygon fill="#181818" points="1050,1657.5,1060,1661.5,1050,1665.5,1054,1661.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="1661.5" y2="1661.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="821" y="1656.2373">read record (contract list)</text><polygon fill="#181818" points="825,1688.791,815,1692.791,825,1696.791,821,1692.791" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="1692.791" y2="1692.791"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="831" y="1687.5283">[contract list data]</text><polygon fill="#181818" points="1050,1720.082,1060,1724.082,1050,1728.082,1054,1724.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="1724.082" y2="1724.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="821" y="1718.8193">read record (contract #x)</text><polygon fill="#181818" points="825,1751.373,815,1755.373,825,1759.373,821,1755.373" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="1755.373" y2="1755.373"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="831" y="1750.1104">[contract #x data]</text><polygon fill="#181818" points="1050,1782.6641,1060,1786.6641,1050,1790.6641,1054,1786.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="1786.6641" y2="1786.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="821" y="1781.4014">read record (contract #y)</text><polygon fill="#181818" points="825,1813.9551,815,1817.9551,825,1821.9551,821,1817.9551" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="1817.9551" y2="1817.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="831" y="1812.6924">[contract #y data]</text><polygon fill="#181818" points="1050,1845.2461,1060,1849.2461,1050,1853.2461,1054,1849.2461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="1849.2461" y2="1849.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="821" y="1843.9834">read record (counters)</text><polygon fill="#181818" points="825,1876.5371,815,1880.5371,825,1884.5371,821,1880.5371" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="1880.5371" y2="1880.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="831" y="1875.2744">[counters data]</text><polygon fill="#0000FF" points="400,1914.8281,390,1918.8281,400,1922.8281,396,1918.8281" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394" x2="808" y1="1918.8281" y2="1918.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="406" y="1913.5654">[card challenge]</text><polygon fill="#181818" points="89,2049.8652,79,2053.8652,89,2057.8652,85,2053.8652" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="383" y1="2053.8652" y2="2053.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="1944.8564">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="1962.1475">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="127" y="1979.4385">- environment data (verified)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="127" y="1996.7295">- contract list data (verified)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="2014.0205">- contract #x data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="2031.3115">- contract #y data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="127" y="2048.6025">- counters data]</text><polygon fill="#181818" points="367,2150.3203,377,2154.3203,367,2158.3203,371,2154.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="373" y1="2154.3203" y2="2154.3203"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="85" y="2079.8936">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="135" y="2079.8936">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="117" y="2097.1846">- update contract list (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="117" y="2114.4756">- update contract #x (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="117" y="2131.7666">- update counters (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="117" y="2149.0576">- close secure session (as ratified)</text><polygon fill="#181818" points="89,2164.3203,79,2168.3203,89,2172.3203,85,2168.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="383" y1="2168.3203" y2="2168.3203"/><polygon fill="#181818" points="367,2195.6113,377,2199.6113,367,2203.6113,371,2199.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="78" x2="373" y1="2199.6113" y2="2199.6113"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="85" y="2194.3486">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="137" y="2194.3486">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="389" x2="431" y1="2230.9023" y2="2230.9023"/><line style="stroke:#181818;stroke-width:1.0;" x1="431" x2="431" y1="2230.9023" y2="2243.9023"/><line style="stroke:#181818;stroke-width:1.0;" x1="390" x2="431" y1="2243.9023" y2="2243.9023"/><polygon fill="#181818" points="400,2239.9023,390,2243.9023,400,2247.9023,396,2243.9023" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="396" y="2225.6396">anticipates the future card responses</text><polygon fill="#00FF00" points="1133.5,2305.7754,1143.5,2309.7754,1133.5,2313.7754,1137.5,2309.7754" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="389" x2="1139.5" y1="2309.7754" y2="2309.7754"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="396" y="2269.9307">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="396" y="2287.2217">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="428" y="2304.5127">- APDU list</text><polygon fill="#181818" points="1388.5,2337.0664,1398.5,2341.0664,1388.5,2345.0664,1392.5,2341.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2341.0664" y2="2341.0664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1162.5" y="2335.8037">select diversifier (card serial)</text><polygon fill="#181818" points="1166.5,2351.0664,1156.5,2355.0664,1166.5,2359.0664,1162.5,2355.0664" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2355.0664" y2="2355.0664"/><polygon fill="#181818" points="1388.5,2382.3574,1398.5,2386.3574,1388.5,2390.3574,1392.5,2386.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2386.3574" y2="2386.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="1162.5" y="2381.0947">digest init (opening data)</text><polygon fill="#181818" points="1166.5,2396.3574,1156.5,2400.3574,1166.5,2404.3574,1162.5,2400.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2400.3574" y2="2400.3574"/><polygon fill="#181818" points="1388.5,2427.6484,1398.5,2431.6484,1388.5,2435.6484,1392.5,2431.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2431.6484" y2="2431.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="1162.5" y="2426.3857">digest update (read environment) * 2</text><polygon fill="#181818" points="1166.5,2441.6484,1156.5,2445.6484,1166.5,2449.6484,1162.5,2445.6484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2445.6484" y2="2445.6484"/><polygon fill="#181818" points="1388.5,2472.9395,1398.5,2476.9395,1388.5,2480.9395,1392.5,2476.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2476.9395" y2="2476.9395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="1162.5" y="2471.6768">digest update (read contract list) * 2</text><polygon fill="#181818" points="1166.5,2486.9395,1156.5,2490.9395,1166.5,2494.9395,1162.5,2490.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2490.9395" y2="2490.9395"/><polygon fill="#181818" points="1388.5,2518.2305,1398.5,2522.2305,1388.5,2526.2305,1392.5,2522.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2522.2305" y2="2522.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="1162.5" y="2516.9678">digest update (read contract #x) * 2</text><polygon fill="#181818" points="1166.5,2532.2305,1156.5,2536.2305,1166.5,2540.2305,1162.5,2536.2305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2536.2305" y2="2536.2305"/><polygon fill="#181818" points="1388.5,2563.5215,1398.5,2567.5215,1388.5,2571.5215,1392.5,2567.5215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2567.5215" y2="2567.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="1162.5" y="2562.2588">digest update (read contract #y) * 2</text><polygon fill="#181818" points="1166.5,2577.5215,1156.5,2581.5215,1166.5,2585.5215,1162.5,2581.5215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2581.5215" y2="2581.5215"/><polygon fill="#181818" points="1388.5,2608.8125,1398.5,2612.8125,1388.5,2616.8125,1392.5,2612.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2612.8125" y2="2612.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="1162.5" y="2607.5498">digest update (read counters) * 2</text><polygon fill="#181818" points="1166.5,2622.8125,1156.5,2626.8125,1166.5,2630.8125,1162.5,2626.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2626.8125" y2="2626.8125"/><path d="M1091.5,2641.8125 L1348.5,2641.8125 L1348.5,2651.1035 L1338.5,2661.1035 L1091.5,2661.1035 L1091.5,2641.8125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="353.5" x="1091.5" y="2641.8125"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71" x="1106.5" y="2656.8408">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="1181.5" y="2656.8408">Card APDU responses</text><polygon fill="#181818" points="1388.5,2680.3945,1398.5,2684.3945,1388.5,2688.3945,1392.5,2684.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2684.3945" y2="2684.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="1162.5" y="2679.1318">digest update (update contract list) * 2</text><polygon fill="#181818" points="1166.5,2694.3945,1156.5,2698.3945,1166.5,2702.3945,1162.5,2698.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2698.3945" y2="2698.3945"/><polygon fill="#181818" points="1388.5,2725.6855,1398.5,2729.6855,1388.5,2733.6855,1392.5,2729.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2729.6855" y2="2729.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="1162.5" y="2724.4229">digest update (update contract #x) * 2</text><polygon fill="#181818" points="1166.5,2739.6855,1156.5,2743.6855,1166.5,2747.6855,1162.5,2743.6855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2743.6855" y2="2743.6855"/><polygon fill="#181818" points="1388.5,2770.9766,1398.5,2774.9766,1388.5,2778.9766,1392.5,2774.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2774.9766" y2="2774.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="1162.5" y="2769.7139">digest update (update counters) * 2</text><polygon fill="#181818" points="1166.5,2784.9766,1156.5,2788.9766,1166.5,2792.9766,1162.5,2788.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2788.9766" y2="2788.9766"/><polygon fill="#181818" points="1388.5,2823.2676,1398.5,2827.2676,1388.5,2831.2676,1392.5,2827.2676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="2827.2676" y2="2827.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1162.5" y="2822.0049">digest close</text><polygon fill="#181818" points="1166.5,2854.5586,1156.5,2858.5586,1166.5,2862.5586,1162.5,2858.5586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="2858.5586" y2="2858.5586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1172.5" y="2853.2959">[SAM certificate]</text><polygon fill="#00FF00" points="400,2885.8496,390,2889.8496,400,2893.8496,396,2889.8496" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394" x2="1149.5" y1="2889.8496" y2="2889.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="406" y="2884.5869">[SAM certificate]</text><polygon fill="#0000FF" points="792,2951.7227,802,2955.7227,792,2959.7227,796,2955.7227" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="389" x2="798" y1="2955.7227" y2="2955.7227"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48" x="396" y="2915.8779">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="396" y="2933.1689">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="428" y="2950.46">- APDU list</text><path d="M749,2970.7227 L1029,2970.7227 L1029,2980.0137 L1019,2990.0137 L749,2990.0137 L749,2970.7227 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.1641" style="stroke:#000000;stroke-width:1.5;" width="352.5" x="749" y="2970.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="235" x="764" y="2985.751">Card APDU commands inside session</text><polygon fill="#181818" points="1050,3009.3047,1060,3013.3047,1050,3017.3047,1054,3013.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="3013.3047" y2="3013.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="821" y="3008.042">update contract list (data)</text><polygon fill="#181818" points="825,3023.3047,815,3027.3047,825,3031.3047,821,3027.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="3027.3047" y2="3027.3047"/><polygon fill="#181818" points="1050,3054.5957,1060,3058.5957,1050,3062.5957,1054,3058.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="3058.5957" y2="3058.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="821" y="3053.333">update contract #x (data)</text><polygon fill="#181818" points="825,3068.5957,815,3072.5957,825,3076.5957,821,3072.5957" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="3072.5957" y2="3072.5957"/><polygon fill="#181818" points="1050,3099.8867,1060,3103.8867,1050,3107.8867,1054,3103.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="3103.8867" y2="3103.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="821" y="3098.624">update counters (data)</text><polygon fill="#181818" points="825,3113.8867,815,3117.8867,825,3121.8867,821,3117.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="3117.8867" y2="3117.8867"/><polygon fill="#181818" points="1050,3152.1777,1060,3156.1777,1050,3160.1777,1054,3156.1777" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="3156.1777" y2="3156.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="821" y="3150.915">close secure session (SAM certificate)</text><polygon fill="#181818" points="825,3183.4688,815,3187.4688,825,3191.4688,821,3187.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1061" y1="3187.4688" y2="3187.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="831" y="3182.2061">[card certificate]</text><polygon fill="#181818" points="1050,3214.7598,1060,3218.7598,1050,3222.7598,1054,3218.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="814" x2="1056" y1="3218.7598" y2="3218.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="821" y="3213.4971">close card channel</text><polygon fill="#181818" points="825,3228.7598,815,3232.7598,825,3236.7598,821,3232.7598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="819" x2="1066" y1="3232.7598" y2="3232.7598"/><polygon fill="#0000FF" points="400,3260.0508,390,3264.0508,400,3268.0508,396,3264.0508" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394" x2="808" y1="3264.0508" y2="3264.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="406" y="3258.7881">[card certificate]</text><polygon fill="#00FF00" points="1133.5,3325.9238,1143.5,3329.9238,1133.5,3333.9238,1137.5,3329.9238" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="389" x2="1139.5" y1="3329.9238" y2="3329.9238"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47" x="396" y="3290.0791">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="396" y="3307.3701">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="428" y="3324.6611">- APDU list</text><polygon fill="#181818" points="1388.5,3357.2148,1398.5,3361.2148,1388.5,3365.2148,1392.5,3361.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1155.5" x2="1394.5" y1="3361.2148" y2="3361.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="1162.5" y="3355.9521">digest authenticate (card certificate)</text><polygon fill="#181818" points="1166.5,3388.5059,1156.5,3392.5059,1166.5,3396.5059,1162.5,3392.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1160.5" x2="1399.5" y1="3392.5059" y2="3392.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1172.5" y="3387.2432">[authentication status]</text><polygon fill="#00FF00" points="400,3419.7969,390,3423.7969,400,3427.7969,396,3423.7969" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394" x2="1149.5" y1="3423.7969" y2="3423.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="406" y="3418.5342">[authentification status]</text><polygon fill="#181818" points="89,3572.125,79,3576.125,89,3580.125,85,3576.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="383" y1="3576.125" y2="3576.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="95" y="3449.8252">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="127" y="3467.1162">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="127" y="3484.4072">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="127" y="3501.6982">- contract list data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="127" y="3518.9893">- contract #x data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="127" y="3536.2803">- contract #y data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="127" y="3553.5713">- counters data (#x updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="95" y="3570.8623">authentification status</text><!--SRC=[nLXjRo8t4FxEhx22r8DLQHF2DPSeGO9bjuhKAgUxzjE53xvT0nRBxjOsDDjVtx6zRzut28dQV3dEdfbdPZpppC07lgLXZ1dU8Jl0dCyZvXDcHq74KD-ziYUNRgzBP36PsPUBaWWNX958936P6OApsuMzS1i57mt1-MHsutni5BHDYul5rNpSAEWOWixyzjg4tc0_-fk6QxJ20IUzqjLNWGNfZd3c2NgW8ccIwdr0NuXVonZsjciMxKDVIT_VC-9Ffv3VXRDmx8xyvfBEpSI-jdiRwXEK7HRX0khdFOi3SXGuLc8AU-BOxaqdTY7yoPbCPeiCFZytFFWUx8_ZIo4LpzpzwCuxqJFHwydjfyKymqvF3UHV6I7XKUYrb5BOCtVcNdLYvx9ZnxPlhZBmxBY43l1F38Vhuw57Iam_kpjsRZiTA8ITNswSyJZp83ytNO0C9ASa8D7nExRZ78jVYOxjQ-VZPIdyf0ADFG7LV_47zRP4o8QQnN50FIne55uWp16EOzHVHu7V0on1FHhZKA0B6mT9p2Cq-_oen3mSKzIFQRWrvRuG35xbOgn5RC38BX9a-1ncXctC_ETGgwS8p4-jzGEwteYvhDVlCZ-O9UZ2igIAPUN2PR4ZO5zdlnjO7EyCA5sW1HOd0V440GSj2tHJKD0ov6LowG7eg9J4_AWc_F2WOaRQDgGV_O3WsK91L-bxe8U7NYy4pr5q0DTaodi8_gIh78aDGJuM6CMCS513D4Gu2DIvJ0T8OBOcu3LQmPFBunpgfnu9VIHDWzDnF9fAstVeVXM17K-Mr8EaBCi2sv1AObdtFykxgKvquJBtI8WPZUwUmsSnGYiQGAsXxmdYCV5a86Zsk33kQ7Z00GN7mIzj30XypxKCWyWG2G-KHU5EnWHAf7JbWGyCKee2oaMHMrMCQPd9pwFH5ABg-SIGI4DbhQ567k6y29MyoCwWeYtc0f-LyENdqRV-9Vovxd9QLB69gMXHbp3gN-MWppA-aEy0jG1avAyzuKBdeUHCnFJHxFFYprf6cfgdLnoFb6TtA8f9g6rw6no6931jbBNb_qUZKaGDvhHZilupKa43JFrXNVaEVLC0hlsuh1dAHBmDyRQyg1cLVbKllPwaobYta4g05-rsE8IoZ_Q2I_xZnDip-G_deASwf-wmAYj6F21JD2XLtZ2NhtfTBa_PVyjJB1k5ssxR44kjGwSQ3rSgBbtAW47eWHW5m-CeX3t9w83ysNIDgXx9NWoQKKaIz7K7rAcoIdTuRPXWHHDflh0i3tDXMIZZLGboh2qXpBAuXadvey9_CW7fHRq2z4NrDT8cQSXZdGuA1bQ5eZeFUpdpga2LmvP5Gm05rq2v4cvPBOt2k8QtYFRC8-OL397yfeFZyHe3gqlghf8Y30j5z4QWuAKiV4trgkgHY13Umm7uxid8uUFkRFRNCIZAC9iB3NvxcYsWX2I3ee0SI30yWz6RplilZQU9SReFORJmCmU2T-f0o1bci2KapWXJvMFOZAt1PSEwxkNbSfhl6IQUNbFLQg67GSMNqbH8Qweq41hOltcToKz7qeyx1Bk1Z248YDg6yMuqAZluJNgJtozBwdayMUwgegKyvrgbNBnYCewR9kD9EMYPWArJ8-sTR5gKMp8dJjcOJx6WE_gFOgAxUbkgWXGRG5blZ4QKLGBxThdtckT6Otkfa8C8R6z9ygCCsaYvFd4V3N-WzQKt7TCc7VlQ1Z3AVptQNcEz_tA2xVxBEPQJKomdhx6i-QZBh9OuFkBJ1ZEVQjassDyuPQllZmRG0218_67RN6qNIT-YUfeOfqOQNalFvd1AWzl7lZ9WU3gG0CDc0V2pyJfrRG2BnvvamGKH9xNcLDzpXKv2rnnuvo6adScc45w1kyEE4PX2o2r6VZ4MH7-5NEs532RRLTJUoCyQNETpTVEygWsizCk53sigupBTB2L63YM8Ws5rXjKC-7HDr9e4ZWrIGbQrTx9gMXs3wbepH1OQdsN4fC-tcm6UV0SZoLkCfEpNQ47FttgT5sNf5xLUZEcYCYMb7d6ZYGAqDwcouT4P1hCSlzLSEL5DjkHSQB6bchzjQICifNUO5CVtjhBq-srkr__NvjOye3l6GlEKFj5EFZtEiv8DcIuJrUqWjT4yYoelsl73Y_7kRUQDNuRghbNM4CFDl5v6vXBJKcwrDUPrm-VwdOTFIziPtwK7rO263GrPqYX-kpZIbfdEgghLqPxlj_MrhtgwRDislVRxrfqF3K0tqre-Xos1LtUcVm40]--></g></svg>