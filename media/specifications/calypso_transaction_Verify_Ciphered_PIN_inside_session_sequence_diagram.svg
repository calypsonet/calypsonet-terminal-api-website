<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="3142px" preserveAspectRatio="none" style="width:1415px;height:3142px;background:#FFFFFF;" version="1.1" viewBox="0 0 1415 3142" width="1415px" zoomAndPan="magnify"><defs/><g><rect fill="#FFD700" height="2961.0918" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.0166" y="91.4883"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="246.9727"/><rect fill="#FFC0CB" height="580.7637" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="290.2832"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="900.3574"/><rect fill="#FFC0CB" height="942.5586" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="943.668"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1961.4688"/><rect fill="#FFC0CB" height="1003.4902" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="2040.0898"/><rect fill="#ADD8E6" height="267.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="498.0781"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="1003.5996"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="1676.4316"/><rect fill="#ADD8E6" height="307.7949" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="2451.4375"/><rect fill="#ADD8E6" height="2638.4336" style="stroke:#181818;stroke-width:1.0;" width="10" x="940.4639" y="91.4883"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="350.2148"/><rect fill="#90EE90" height="433.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="1182.7734"/><rect fill="#90EE90" height="249.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2142.332"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2819.1641"/><rect fill="#90EE90" height="2961.0918" style="stroke:#181818;stroke-width:1.0;" width="10" x="1363.4629" y="91.4883"/><rect fill="none" height="223.7949" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="513.0781"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="1018.5996"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="1691.4316"/><rect fill="none" height="103.9316" style="stroke:#000000;stroke-width:1.5;" width="432.999" x="976.3647" y="2200.6426"/><rect fill="none" height="119.2422" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="2466.4375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="80" x2="80" y1="81.4883" y2="3061.5801"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="407.1899" x2="407.1899" y1="81.4883" y2="3061.5801"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="675.8447" x2="675.8447" y1="81.4883" y2="3061.5801"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="944.563" x2="944.563" y1="81.4883" y2="3061.5801"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1036.3647" x2="1036.3647" y1="81.4883" y2="3061.5801"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1367.562" x2="1367.562" y1="81.4883" y2="3061.5801"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="78.5352">Ticketing Application</text><ellipse cx="80.0166" cy="13.5" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,21.5 L80.0166,48.5 M67.0166,29.5 L93.0166,29.5 M80.0166,48.5 L67.0166,63.5 M80.0166,48.5 L93.0166,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144.0332" x="5" y="3074.1152">Ticketing Application</text><ellipse cx="80.0166" cy="3085.5684" fill="#FFD700" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.0166,3093.5684 L80.0166,3120.5684 M67.0166,3101.5684 L93.0166,3101.5684 M80.0166,3120.5684 L67.0166,3135.5684 M80.0166,3120.5684 L93.0166,3135.5684 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFC0CB" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="372.1899" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="381.4355" y="54.0469">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="379.1899" y="70.5352">Card API</text><rect fill="#FFC0CB" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.8184" x="372.1899" y="3060.5801"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.3271" x="381.4355" y="3081.1152">Calypso</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.8184" x="379.1899" y="3097.6035">Card API</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.7148" x="624.8447" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.7148" x="631.8447" y="54.0469">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="653.3403" y="70.5352">Reader</text><rect fill="#ADD8E6" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.7148" x="624.8447" y="3060.5801"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.7148" x="631.8447" y="3081.1152">Calypso Card</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="653.3403" y="3097.6035">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="914.563" y="62.0469">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="925.5415" y="78.5352">Card</text><path d="M924.9639,20.5117 L924.9639,44.5117 M924.9639,32.5117 L941.9639,32.5117 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="953.9639" cy="32.5117" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="914.563" y="3074.1152">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33.8447" x="925.5415" y="3090.6035">Card</text><path d="M924.9639,3097.5566 L924.9639,3121.5566 M924.9639,3109.5566 L941.9639,3109.5566 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="953.9639" cy="3109.5566" fill="#ADD8E6" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="986.3647" y="33.5117"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="993.3647" y="54.0469">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="1013.5103" y="70.5352">Reader</text><rect fill="#90EE90" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.0146" x="986.3647" y="3060.5801"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.0146" x="993.3647" y="3081.1152">Calypso SAM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7236" x="1013.5103" y="3097.6035">Reader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="1337.562" y="62.0469">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1349.9556" y="78.5352">SAM</text><path d="M1347.9629,20.5117 L1347.9629,44.5117 M1347.9629,32.5117 L1364.9629,32.5117 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1376.9629" cy="32.5117" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.8018" x="1337.562" y="3074.1152">selected</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="31.0146" x="1349.9556" y="3090.6035">SAM</text><path d="M1347.9629,3097.5566 L1347.9629,3121.5566 M1347.9629,3109.5566 L1364.9629,3109.5566 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1376.9629" cy="3109.5566" fill="#90EE90" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#FFD700" height="2961.0918" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.0166" y="91.4883"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="246.9727"/><rect fill="#FFC0CB" height="580.7637" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="290.2832"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="900.3574"/><rect fill="#FFC0CB" height="942.5586" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="943.668"/><rect fill="#FFC0CB" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="1961.4688"/><rect fill="#FFC0CB" height="1003.4902" style="stroke:#181818;stroke-width:1.0;" width="10" x="403.0991" y="2040.0898"/><rect fill="#ADD8E6" height="267.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="498.0781"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="1003.5996"/><rect fill="#ADD8E6" height="119.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="1676.4316"/><rect fill="#ADD8E6" height="307.7949" style="stroke:#181818;stroke-width:1.0;" width="10" x="671.7021" y="2451.4375"/><rect fill="#ADD8E6" height="2638.4336" style="stroke:#181818;stroke-width:1.0;" width="10" x="940.4639" y="91.4883"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="350.2148"/><rect fill="#90EE90" height="433.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="1182.7734"/><rect fill="#90EE90" height="249.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2142.332"/><rect fill="#90EE90" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1031.8721" y="2819.1641"/><rect fill="#90EE90" height="2961.0918" style="stroke:#181818;stroke-width:1.0;" width="10" x="1363.4629" y="91.4883"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="127.0166" y1="143.4199" y2="143.4199"/><line style="stroke:#181818;stroke-width:1.0;" x1="127.0166" x2="127.0166" y1="143.4199" y2="156.4199"/><line style="stroke:#181818;stroke-width:1.0;" x1="86.0166" x2="127.0166" y1="156.4199" y2="156.4199"/><polygon fill="#181818" points="96.0166,152.4199,86.0166,156.4199,96.0166,160.4199,92.0166,156.4199" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="71.5889" x="92.0166" y="108.0566">instantiate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.7642" x="167.7188" y="108.0566">Calypso card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1821" x="124.9229" y="123.3672">- Calypso card resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.0107" x="124.9229" y="138.6777">- Calypso SAM resource</text><polygon fill="#181818" points="391.0991,242.9727,401.0991,246.9727,391.0991,250.9727,395.0991,246.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="246.9727" y2="246.9727"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="180.9883">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1328" x="148.0537" y="180.9883">card transaction:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.1763" x="124.9229" y="196.2988">- open secure session (DEBIT access level)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8022" x="124.9229" y="211.6094">- read environment file</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.8193" x="124.9229" y="226.9199">- read contract #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.9917" x="124.9229" y="242.2305">- reader counter #1</text><polygon fill="#181818" points="96.0166,256.9727,86.0166,260.9727,96.0166,264.9727,92.0166,260.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="260.9727" y2="260.9727"/><polygon fill="#181818" points="391.0991,286.2832,401.0991,290.2832,391.0991,294.2832,395.0991,290.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="290.2832" y2="290.2832"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="285.541">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.5542" x="148.1934" y="285.541">commands (keep channel open)</text><polygon fill="#00FF00" points="1019.8721,346.2148,1029.8721,350.2148,1019.8721,354.2148,1023.8721,350.2148" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="350.2148" y2="350.2148"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="314.8516">SAM #1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="330.1621">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="345.4727">- APDU list</text><polygon fill="#181818" points="1351.4629,375.5254,1361.4629,379.5254,1351.4629,383.5254,1355.4629,379.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="379.5254" y2="379.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4048" x="1048.8721" y="374.7832">get challenge</text><polygon fill="#181818" points="1052.8721,404.8359,1042.8721,408.8359,1052.8721,412.8359,1048.8721,408.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="408.8359" y2="408.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="1058.8721" y="404.0938">[SAM challenge]</text><polygon fill="#00FF00" points="424.0991,434.1465,414.0991,438.1465,424.0991,442.1465,420.0991,438.1465" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="438.1465" y2="438.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.8169" x="430.0991" y="433.4043">[SAM challenge]</text><polygon fill="#0000FF" points="659.7021,494.0781,669.7021,498.0781,659.7021,502.0781,663.7021,498.0781" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.0991" x2="665.7021" y1="498.0781" y2="498.0781"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.0991" y="462.7148">Card #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="478.0254">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="493.3359">- APDU list</text><path d="M614.8447,513.0781 L909.7266,513.0781 L909.7266,520.3887 L899.7266,530.3887 L614.8447,530.3887 L614.8447,513.0781 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="223.7949" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="513.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="629.8447" y="526.6465">Card APDU commands inside session</text><polygon fill="#181818" points="928.4639,578.3203,938.4639,582.3203,928.4639,586.3203,932.4639,582.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="582.3203" y2="582.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.6772" x="688.7021" y="546.957">open secure session (card debit key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.4751" x="721.6084" y="562.2676">SAM challenge,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.5337" x="721.6084" y="577.5781">SFI environment to read)</text><polygon fill="#181818" points="692.7021,607.6309,682.7021,611.6309,692.7021,615.6309,688.7021,611.6309" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="611.6309" y2="611.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.2744" x="698.7021" y="606.8887">[card challenge &amp; environment data]</text><polygon fill="#181818" points="928.4639,636.9414,938.4639,640.9414,928.4639,644.9414,932.4639,640.9414" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="640.9414" y2="640.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.46" x="688.7021" y="636.1992">read record (contract #1)</text><polygon fill="#181818" points="692.7021,666.252,682.7021,670.252,692.7021,674.252,688.7021,670.252" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="670.252" y2="670.252"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.1187" x="698.7021" y="665.5098">[contract #1 data]</text><polygon fill="#181818" points="928.4639,695.5625,938.4639,699.5625,928.4639,703.5625,932.4639,699.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="699.5625" y2="699.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.0703" x="688.7021" y="694.8203">read record (counter #1)</text><polygon fill="#181818" points="692.7021,724.873,682.7021,728.873,692.7021,732.873,688.7021,728.873" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="728.873" y2="728.873"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.729" x="698.7021" y="724.1309">[counter #1 data]</text><polygon fill="#0000FF" points="424.0991,761.1836,414.0991,765.1836,424.0991,769.1836,420.0991,765.1836" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="675.7021" y1="765.1836" y2="765.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9883" x="430.0991" y="760.4414">[card challenge]</text><polygon fill="#181818" points="96.0166,867.0469,86.0166,871.0469,96.0166,875.0469,92.0166,871.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="871.0469" y2="871.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="789.752">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="805.0625">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.0972" x="134.9229" y="820.373">- environment data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="835.6836">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.2988" x="134.9229" y="850.9941">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.1367" x="134.9229" y="866.3047">- counter #1 data]</text><polygon fill="#181818" points="391.0991,896.3574,401.0991,900.3574,391.0991,904.3574,395.0991,900.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="900.3574" y2="900.3574"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="895.6152">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.2896" x="148.0537" y="895.6152">Verify PIN (plain PIN value)</text><polygon fill="#181818" points="96.0166,910.3574,86.0166,914.3574,96.0166,918.3574,92.0166,914.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="914.3574" y2="914.3574"/><polygon fill="#181818" points="391.0991,939.668,401.0991,943.668,391.0991,947.668,395.0991,943.668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="943.668" y2="943.668"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="938.9258">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.5542" x="148.1934" y="938.9258">commands (keep channel open)</text><polygon fill="#0000FF" points="659.7021,999.5996,669.7021,1003.5996,659.7021,1007.5996,663.7021,1003.5996" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.0991" x2="665.7021" y1="1003.5996" y2="1003.5996"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.0991" y="968.2363">Card #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="983.5469">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="998.8574">- APDU list</text><path d="M614.8447,1018.5996 L909.7266,1018.5996 L909.7266,1025.9102 L899.7266,1035.9102 L614.8447,1035.9102 L614.8447,1018.5996 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="1018.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="629.8447" y="1032.168">Card APDU commands inside session</text><polygon fill="#181818" points="928.4639,1053.2207,938.4639,1057.2207,928.4639,1061.2207,932.4639,1057.2207" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="1057.2207" y2="1057.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.0293" x="688.7021" y="1052.4785">Get Challenge</text><polygon fill="#181818" points="692.7021,1082.5313,682.7021,1086.5313,692.7021,1090.5313,688.7021,1086.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="1086.5313" y2="1086.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.9722" x="698.7021" y="1081.7891">[PIN Card challenge]</text><polygon fill="#0000FF" points="424.0991,1118.8418,414.0991,1122.8418,424.0991,1126.8418,420.0991,1122.8418" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="675.7021" y1="1122.8418" y2="1122.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.3242" x="430.0991" y="1118.0996">[Card challenge]</text><polygon fill="#00FF00" points="1019.8721,1178.7734,1029.8721,1182.7734,1019.8721,1186.7734,1023.8721,1182.7734" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="1182.7734" y2="1182.7734"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="1147.4102">SAM #2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="1162.7207">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="1178.0313">- APDU list</text><path d="M769,1195.7734 L769,1220.7734 L1302,1220.7734 L1302,1205.7734 L1292,1195.7734 L769,1195.7734 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1292,1195.7734 L1292,1205.7734 L1302,1205.7734 L1292,1195.7734 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="512.9541" x="775" y="1213.3418">When ciphered PIN verification requested, processes all pending SAM commands.</text><polygon fill="#181818" points="1351.4629,1243.3945,1361.4629,1247.3945,1351.4629,1251.3945,1355.4629,1247.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1247.3945" y2="1247.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.124" x="1048.8721" y="1242.6523">select diversifier (card serial)</text><polygon fill="#181818" points="1052.8721,1257.3945,1042.8721,1261.3945,1052.8721,1265.3945,1048.8721,1261.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1261.3945" y2="1261.3945"/><polygon fill="#181818" points="1351.4629,1286.7051,1361.4629,1290.7051,1351.4629,1294.7051,1355.4629,1290.7051" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1290.7051" y2="1290.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="1048.8721" y="1285.9629">digest init (opening data)</text><polygon fill="#181818" points="1052.8721,1300.7051,1042.8721,1304.7051,1052.8721,1308.7051,1048.8721,1304.7051" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1304.7051" y2="1304.7051"/><polygon fill="#181818" points="1351.4629,1330.0156,1361.4629,1334.0156,1351.4629,1338.0156,1355.4629,1334.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1334.0156" y2="1334.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.6914" x="1048.8721" y="1329.2734">digest update (read environment)</text><polygon fill="#181818" points="1052.8721,1344.0156,1042.8721,1348.0156,1052.8721,1352.0156,1048.8721,1348.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1348.0156" y2="1348.0156"/><polygon fill="#181818" points="1351.4629,1373.3262,1361.4629,1377.3262,1351.4629,1381.3262,1355.4629,1377.3262" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1377.3262" y2="1377.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.8062" x="1048.8721" y="1372.584">digest update (read contract)</text><polygon fill="#181818" points="1052.8721,1387.3262,1042.8721,1391.3262,1052.8721,1395.3262,1048.8721,1391.3262" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1391.3262" y2="1391.3262"/><polygon fill="#181818" points="1351.4629,1416.6367,1361.4629,1420.6367,1351.4629,1424.6367,1355.4629,1420.6367" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1420.6367" y2="1420.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.4165" x="1048.8721" y="1415.8945">digest update (read counter)</text><polygon fill="#181818" points="1052.8721,1430.6367,1042.8721,1434.6367,1052.8721,1438.6367,1048.8721,1434.6367" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1434.6367" y2="1434.6367"/><path d="M756,1447.6367 L756,1472.6367 L1315,1472.6367 L1315,1457.6367 L1305,1447.6367 L756,1447.6367 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1305,1447.6367 L1305,1457.6367 L1315,1457.6367 L1305,1447.6367 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="538.9287" x="762" y="1465.2051">Diversification for the PIN ciphering is necessarily the same as for the secure session.</text><polygon fill="#181818" points="1351.4629,1495.2578,1361.4629,1499.2578,1351.4629,1503.2578,1355.4629,1499.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1499.2578" y2="1499.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.7578" x="1048.8721" y="1494.5156">Give Random (PIN card challenge)</text><polygon fill="#181818" points="1052.8721,1524.5684,1042.8721,1528.5684,1052.8721,1532.5684,1048.8721,1528.5684" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1528.5684" y2="1528.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21.436" x="1058.8721" y="1523.8262">ack</text><polygon fill="#181818" points="1351.4629,1553.8789,1361.4629,1557.8789,1351.4629,1561.8789,1355.4629,1557.8789" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="1557.8789" y2="1557.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.5908" x="1048.8721" y="1553.1367">Card Cipher PIN (plain PIN, debit key reference)</text><polygon fill="#181818" points="1052.8721,1583.1895,1042.8721,1587.1895,1052.8721,1591.1895,1048.8721,1587.1895" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="1587.1895" y2="1587.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.7563" x="1058.8721" y="1582.4473">[ciphered PIN]</text><polygon fill="#00FF00" points="424.0991,1612.5,414.0991,1616.5,424.0991,1620.5,420.0991,1616.5" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="1616.5" y2="1616.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.7563" x="430.0991" y="1611.7578">[ciphered PIN]</text><polygon fill="#0000FF" points="659.7021,1672.4316,669.7021,1676.4316,659.7021,1680.4316,663.7021,1676.4316" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.0991" x2="665.7021" y1="1676.4316" y2="1676.4316"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.0991" y="1641.0684">Card #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="1656.3789">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="1671.6895">- APDU list</text><path d="M614.8447,1691.4316 L909.7266,1691.4316 L909.7266,1698.7422 L899.7266,1708.7422 L614.8447,1708.7422 L614.8447,1691.4316 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="75.9316" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="1691.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="629.8447" y="1705">Card APDU commands inside session</text><polygon fill="#181818" points="928.4639,1726.0527,938.4639,1730.0527,928.4639,1734.0527,932.4639,1730.0527" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="1730.0527" y2="1730.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.9087" x="688.7021" y="1725.3105">Verify PIN (ciphered PIN)</text><polygon fill="#181818" points="692.7021,1755.3633,682.7021,1759.3633,692.7021,1763.3633,688.7021,1759.3633" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="1759.3633" y2="1759.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.3286" x="698.7021" y="1754.6211">[PIN status]</text><polygon fill="#0000FF" points="424.0991,1791.6738,414.0991,1795.6738,424.0991,1799.6738,420.0991,1795.6738" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="675.7021" y1="1795.6738" y2="1795.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.3286" x="430.0991" y="1790.9316">[PIN status]</text><polygon fill="#181818" points="96.0166,1882.2266,86.0166,1886.2266,96.0166,1890.2266,92.0166,1886.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="1886.2266" y2="1886.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="1820.2422">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.876" x="134.9229" y="1835.5527">- identification data with PIN support</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.5176" x="134.9229" y="1850.8633">- key #1 reference (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.0508" x="134.9229" y="1866.1738">- key #2 reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.2783" x="134.9229" y="1881.4844">- key #3 reference]</text><polygon fill="#181818" points="391.0991,1957.4688,401.0991,1961.4688,391.0991,1965.4688,395.0991,1961.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="1961.4688" y2="1961.4688"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="51.9238" x="92.0166" y="1910.7949">prepare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="143.9404" y="1910.7949">:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.7451" x="124.9229" y="1926.1055">- decrease counter #1 (value)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.7207" x="124.9229" y="1941.416">- append event record (data)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.9043" x="124.9229" y="1956.7266">- close secure session (not ratified)</text><polygon fill="#181818" points="96.0166,1971.4688,86.0166,1975.4688,96.0166,1979.4688,92.0166,1975.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="1975.4688" y2="1975.4688"/><path d="M162,1988.4688 L162,2013.4688 L654,2013.4688 L654,1998.4688 L644,1988.4688 L162,1988.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M644,1988.4688 L644,1998.4688 L654,1998.4688 L644,1988.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="471.1357" x="168" y="2006.0371">At the session closure, any data secure processing should be unnecessary.</text><polygon fill="#181818" points="391.0991,2036.0898,401.0991,2040.0898,391.0991,2044.0898,395.0991,2040.0898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.0166" x2="397.0991" y1="2040.0898" y2="2040.0898"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.0635" x="92.0166" y="2035.3477">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.4653" x="148.1934" y="2035.3477">commands (close channel after)</text><line style="stroke:#181818;stroke-width:1.0;" x1="413.0991" x2="455.0991" y1="2069.4004" y2="2069.4004"/><line style="stroke:#181818;stroke-width:1.0;" x1="455.0991" x2="455.0991" y1="2069.4004" y2="2082.4004"/><line style="stroke:#181818;stroke-width:1.0;" x1="414.0991" x2="455.0991" y1="2082.4004" y2="2082.4004"/><polygon fill="#181818" points="424.0991,2078.4004,414.0991,2082.4004,424.0991,2086.4004,420.0991,2082.4004" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.603" x="420.0991" y="2064.6582">anticipates the future card responses</text><polygon fill="#00FF00" points="1019.8721,2138.332,1029.8721,2142.332,1019.8721,2146.332,1023.8721,2142.332" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="2142.332" y2="2142.332"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="2106.9688">SAM #3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="2122.2793">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="2137.5898">- APDU list</text><polygon fill="#181818" points="1351.4629,2167.6426,1361.4629,2171.6426,1351.4629,2175.6426,1355.4629,2171.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="2171.6426" y2="2171.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.4438" x="1048.8721" y="2166.9004">digest update (verify PIN)</text><polygon fill="#181818" points="1052.8721,2181.6426,1042.8721,2185.6426,1052.8721,2189.6426,1048.8721,2185.6426" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="2185.6426" y2="2185.6426"/><path d="M976.3647,2200.6426 L1246.3003,2200.6426 L1246.3003,2207.9531 L1236.3003,2217.9531 L976.3647,2217.9531 L976.3647,2200.6426 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="103.9316" style="stroke:#000000;stroke-width:1.5;" width="432.999" x="976.3647" y="2200.6426"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="74.5786" x="991.3647" y="2214.2109">anticipated</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.0723" x="1070.228" y="2214.2109">Card APDU responses</text><polygon fill="#181818" points="1351.4629,2235.2637,1361.4629,2239.2637,1351.4629,2243.2637,1355.4629,2239.2637" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="2239.2637" y2="2239.2637"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.1875" x="1048.8721" y="2234.5215">digest update (decrease counter)</text><polygon fill="#181818" points="1052.8721,2249.2637,1042.8721,2253.2637,1052.8721,2257.2637,1048.8721,2253.2637" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="2253.2637" y2="2253.2637"/><polygon fill="#181818" points="1351.4629,2278.5742,1361.4629,2282.5742,1351.4629,2286.5742,1355.4629,2282.5742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="2282.5742" y2="2282.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.29" x="1048.8721" y="2277.832">digest update (append event record)</text><polygon fill="#181818" points="1052.8721,2292.5742,1042.8721,2296.5742,1052.8721,2300.5742,1048.8721,2296.5742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="2296.5742" y2="2296.5742"/><polygon fill="#181818" points="1351.4629,2328.8848,1361.4629,2332.8848,1351.4629,2336.8848,1355.4629,2332.8848" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="2332.8848" y2="2332.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1626" x="1048.8721" y="2328.1426">digest close</text><polygon fill="#181818" points="1052.8721,2358.1953,1042.8721,2362.1953,1052.8721,2366.1953,1048.8721,2362.1953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="2362.1953" y2="2362.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="1058.8721" y="2357.4531">[SAM certificate]</text><polygon fill="#00FF00" points="424.0991,2387.5059,414.0991,2391.5059,424.0991,2395.5059,420.0991,2391.5059" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="2391.5059" y2="2391.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.0576" x="430.0991" y="2386.7637">[SAM certificate]</text><polygon fill="#0000FF" points="659.7021,2447.4375,669.7021,2451.4375,659.7021,2455.4375,663.7021,2451.4375" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="413.0991" x2="665.7021" y1="2451.4375" y2="2451.4375"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.8633" x="420.0991" y="2416.0742">Card #5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="2431.3848">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="2446.6953">- APDU list</text><path d="M614.8447,2466.4375 L909.7266,2466.4375 L909.7266,2473.748 L899.7266,2483.748 L614.8447,2483.748 L614.8447,2466.4375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="119.2422" style="stroke:#000000;stroke-width:1.5;" width="371.52" x="614.8447" y="2466.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="249.8818" x="629.8447" y="2480.0059">Card APDU commands inside session</text><polygon fill="#181818" points="928.4639,2501.0586,938.4639,2505.0586,928.4639,2509.0586,932.4639,2505.0586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2505.0586" y2="2505.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.8789" x="688.7021" y="2500.3164">update record (event, data)</text><polygon fill="#181818" points="692.7021,2515.0586,682.7021,2519.0586,692.7021,2523.0586,688.7021,2519.0586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2519.0586" y2="2519.0586"/><polygon fill="#181818" points="928.4639,2544.3691,938.4639,2548.3691,928.4639,2552.3691,932.4639,2548.3691" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2548.3691" y2="2548.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.5405" x="688.7021" y="2543.627">decrease counter (counter #1, value)</text><polygon fill="#181818" points="692.7021,2573.6797,682.7021,2577.6797,692.7021,2581.6797,688.7021,2577.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2577.6797" y2="2577.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.189" x="698.7021" y="2572.9375">[new counter value]</text><polygon fill="#181818" points="928.4639,2609.9902,938.4639,2613.9902,928.4639,2617.9902,932.4639,2613.9902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2613.9902" y2="2613.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.7617" x="688.7021" y="2609.248">close secure session (SAM certificate)</text><polygon fill="#181818" points="692.7021,2639.3008,682.7021,2643.3008,692.7021,2647.3008,688.7021,2643.3008" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2643.3008" y2="2643.3008"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="698.7021" y="2638.5586">[card certificate]</text><polygon fill="#181818" points="928.4639,2668.6113,938.4639,2672.6113,928.4639,2676.6113,932.4639,2672.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2672.6113" y2="2672.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.6274" x="688.7021" y="2667.8691">ratification command</text><polygon fill="#181818" points="692.7021,2682.6113,682.7021,2686.6113,692.7021,2690.6113,688.7021,2686.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="939.4639" y1="2686.6113" y2="2686.6113"/><polygon fill="#181818" points="928.4639,2711.9219,938.4639,2715.9219,928.4639,2719.9219,932.4639,2715.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="681.7021" x2="934.4639" y1="2715.9219" y2="2715.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.8794" x="688.7021" y="2711.1797">close card channel</text><polygon fill="#181818" points="692.7021,2725.9219,682.7021,2729.9219,692.7021,2733.9219,688.7021,2729.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="686.7021" x2="944.4639" y1="2729.9219" y2="2729.9219"/><polygon fill="#0000FF" points="424.0991,2755.2324,414.0991,2759.2324,424.0991,2763.2324,420.0991,2759.2324" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="675.7021" y1="2759.2324" y2="2759.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.229" x="430.0991" y="2754.4902">[card certificate]</text><polygon fill="#00FF00" points="1019.8721,2815.1641,1029.8721,2819.1641,1019.8721,2823.1641,1023.8721,2819.1641" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;" x1="413.0991" x2="1025.8721" y1="2819.1641" y2="2819.1641"/><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.2354" x="420.0991" y="2783.8008">SAM #4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9224" x="420.0991" y="2799.1113">transmit card request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6528" x="453.0054" y="2814.4219">- APDU list</text><polygon fill="#181818" points="1351.4629,2844.4746,1361.4629,2848.4746,1351.4629,2852.4746,1355.4629,2848.4746" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1041.8721" x2="1357.4629" y1="2848.4746" y2="2848.4746"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.2842" x="1048.8721" y="2843.7324">digest authenticate (card certificate)</text><polygon fill="#181818" points="1052.8721,2873.7852,1042.8721,2877.7852,1052.8721,2881.7852,1048.8721,2877.7852" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1046.8721" x2="1362.4629" y1="2877.7852" y2="2877.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4131" x="1058.8721" y="2873.043">[authentication status]</text><polygon fill="#00FF00" points="424.0991,2903.0957,414.0991,2907.0957,424.0991,2911.0957,420.0991,2907.0957" style="stroke:#00FF00;stroke-width:1.0;"/><line style="stroke:#00FF00;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="418.0991" x2="1035.8721" y1="2907.0957" y2="2907.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9507" x="430.0991" y="2902.3535">[authentification status]</text><polygon fill="#181818" points="96.0166,3039.5801,86.0166,3043.5801,96.0166,3047.5801,92.0166,3043.5801" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.0166" x2="407.0991" y1="3043.5801" y2="3043.5801"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8472" x="102.0166" y="2931.6641">[Calypso card image:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0708" x="134.9229" y="2946.9746">- identification data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6304" x="134.9229" y="2962.2852">- environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.8633" x="134.9229" y="2977.5957">- contract list data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.2988" x="134.9229" y="2992.9063">- contract #1 data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.376" x="134.9229" y="3008.2168">- counter #1 data (updated)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.0273" x="134.9229" y="3023.5273">- event #1 (updated)]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.4956" x="102.0166" y="3038.8379">authentification status</text><!--SRC=[pLVVR-Cs37xtNo6qm2u9cYrDqlLQT0KInodwiAsuksqFRHvKcqc4EhBFLdB8VpzAjcpBlt8fyj1xwBKooO-ao8_Kf_YDyP16T4DidyRnD8WyYEp03o9oFh-qnuEvrIOo6q_imQmW4Wk8813x42Q6uEHcPi_cjOAFXk1qFBbshce5RTFYR7Ov7TOAEeQWCxqPcT1hwWK_65-H9VLZi0gVlWege3t2YIlOZebzdPJrYNm1hv8nwhwjec3BFILzTnU1Tt-F-PqvCyTkoMycwLoFxP5jhPa7H1_cuIBgqpOAVJW872enXJrsxFbrAtOk_DaPZoSp3P-T6nwy-jl3-598nJETNysdhUXQT3I- -JoRQkpqr41-Y03uGUYLb5BOa_baVjcAdSaE7Tk-ljJW-hY0Zl1_HvIl3eSUAB7askT3vwRLWLpO-VtQ6Gwr1zcvwG9cOFyp2TWdyJksunoANuaExP5pDIY4loz1KrTWzPzzO-uR2DbGap3qcKi52_WPeJ6XOKZELu7lMOWbcCj2oWKviwc_3-FWXTiqyiZawL49kpHav3na_ArMcaZX5_u5A7gQAaHUyYSvzzbgBQQo25zbq3JQaxCOV705e5Al9vLxlKojg50BzdNofu4Lquq1bLHTFHRgfb2ePSZBZB4TSamXCzbHsQ_iGzLA6FRlySSjwVKOZmLwpb2mroFQVMLBOBd4qah0Rr_uY-YRdoE8WstaWla9dS- -M2cKl9bRShSCC4Ekh94_90VrUc44c3p4lVjDVhjlWWr2u2G6TnjXC137-8LqPixqyHkXhei7n8ST-Dr4Ei8y4-0x5WLy0mYvP3uKFha85Q5zSdwPd-B5k7WPGbxGPJ6dM5DfKSdV-oflbWU6nC4m0-ba8SnWiw7SYqdd3I0axffo3huAirkFdO0_dmy6y_bWiBZFoid4IoX6LH26WO0bNrwuIkw62Ns5txSGYoGDawVPFyHdiJ0gfwPghUouBnsv9IiGCWZV1qLbTDFl5prybkvatnS5zImWdRooQ27HcLOX6L9xSP_tiPaDnVP9wo8PPUa_DWdrD659TWn9oa2eb5qgTfHalBHGBOB_SXDzvUrjVKahTpnuHS_UO7yXFJBoaPpC7utg5e4gu6u6rEyR6NbMLZCRv1T3swE2BXfyLDqIWOlSZhxbNTC2bGiTOrdtNPjXBPFQ1Ux9EiWC6-MWAiaCUs7shDQp2bsDEWQ_iGrTGSf0UA78aSjqDYaVaW_bN9BEDiJ_mKl9ACk8hAc2NZbJ-hGKPeLehACvzL-8s79FdXx_8ftGfuohNtSKYxZxaOdkYDuUVQpUVa0wj3CwR2ffUGjsgKOFLxLzH5KVDoxUJv0DKyBY0NuCTdYUSxVCndzhv3vScDQu2Nf9DSeQrSsLme5tGTA20jm4VPzWrNXoIrIScDx8hp9dH29LnrAoKn6FeVaOxQCZ2SN624VzRdbILGnuR8MEuALZ9ZgoQ2MwRCoVLat8W7JAEydx36ZIUA-s8fUgSkD5pNJcqfjPuhOkrg2kBBa_cH0M4mxoccZ4_BqIG3CWzrUjO0wwjZjxG4Zo1Myss92EmZ4AlblTBl2XKh6YkiHM7fQ8xoAVhrXeIwn0xjPPVIxMvy9gtLbCqTEjBEEFHMl5GL8CkTjASVYw4DkuIcrPBh8q5gLFFQp93oRMolLu6uP1bAPELW7EsgmGojDRVH_ctmkde_oqRamVDQDJlprmiL5ZAAu1dMHG9m9eL7OEldNGe5wV51-bwuCVn53PAh7HI4HbGZ2kuoT-JWxgRtdN4v5sTO8WOH7nWb2-JxATkf3IjoI9U1riVO-y0jbopHRx8X6yTx58OjQR1LqgXciECeMGBrxvP1SuMcGeowsG3kjtRHXm3EvTOtHqwZ5wWDftMLVM47lIyDLyvk5xUKvpNiWp86_xW0Fbgkrg9SELdp1KKztrjYILDDXIrT3q0eKePGKuGEWLwTDn-jN7ulGqzvfBLEulqXMdbjKRx5Ieg_2gkz2FZQOnmU57fgT4gzCYXQadkD9rTQtcLt3nKckUfRGmDj94Leqr-gLN5Sb4DMgbcNPW6bRzFTsgFpunHpKq8zqYjKgcKUrT3gXkwIfeo2lGsq1hisgTPLchfMbFzzu_mIk_l7Ga12XdlpvVlF26AClZ-dy0]--></g></svg>